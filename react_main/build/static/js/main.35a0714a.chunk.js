/*! For license information please see main.35a0714a.chunk.js.LICENSE.txt */
(this.webpackJsonpreact_main=this.webpackJsonpreact_main||[]).push([[0],{153:function(e,t,a){},154:function(e,t,a){},165:function(e,t,a){e.exports=a(449)},186:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},218:function(e,t,a){},430:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},433:function(e,t,a){},434:function(e,t,a){},435:function(e,t,a){},436:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){},440:function(e,t,a){},441:function(e,t,a){},442:function(e,t,a){},443:function(e,t,a){},444:function(e,t,a){},445:function(e,t,a){},446:function(e,t,a){},447:function(e,t,a){},448:function(e,t,a){},449:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(155),o=a.n(c),s=a(12),i=a(2),l=a(3),u=a(35),m=a(4),d=a.n(m),f=a(11),p=a.n(f),h=a(13),v=a(1),g=["Mafia","Split Decision","Resistance","One Night"],b=["Main","Sandbox","Competitive","Games"],y={Mafia:["Village","Mafia","Monsters","Independent"],"Split Decision":["Blue","Red","Independent"],Resistance:["Resistance","Spies"],"One Night":["Village","Werewolves","Independent"]},E={Mafia:["Day","Night"],"Split Decision":["Initial Round","Hostage Swap"],Resistance:["Team Selection","Team Approval","Mission"],"One Night":["Day","Night"]},w={reads:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5},survival:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5},participation:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5}},O=r.a.createContext(),N=r.a.createContext(),j=r.a.createContext(),k=r.a.createContext();function S(e){var t=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"setProp":e[t.prop]!=t.value&&(a=p()(e,Object(v.a)({},t.prop,{$set:t.value})));break;case"showAlert":"function"==typeof t.text&&(t.text=t.text(e.alerts.length)),a=p()(e,{alerts:{$push:[{text:t.text,type:t.alertType||"",id:t.id}]}});break;case"hideAlert":a=p()(e,{alerts:{$splice:[[t.index,1]]}});break;case"hideAlertById":for(var n=0;n<e.alerts.length;n++)if(e.alerts[n].id==t.id){a=p()(e,{alerts:{$splice:[[n,1]]}});break}break;case"hideAllAlerts":a=p()(e,{alerts:{$set:[]}})}return a||e}),e),a=Object(i.a)(t,2),r=a[0],c=a[1];function o(e,t){c({type:"setProp",prop:e,value:t})}return Object(h.a)(Object(h.a)({},r),{},{update:o,showAlert:function(e,t,a){var n=Math.random();c({type:"showAlert",text:e,alertType:t,id:n}),a||setTimeout((function(){return function(e){var t=document.getElementById("alert-id-".concat(e));if(!t)return;t.style.opacity=0,setTimeout((function(){c({type:"hideAlertById",id:e})}),500)}(n)}),3e3)},hideAlert:function(e){c({type:"hideAlert",index:e})},hideAllAlerts:function(){c({type:"hideAllAlerts"})},clearCache:function(){var e=Date.now();o("cacheVal",e),window.localStorage.setItem("cacheVal",e)}})}a(186);function C(e){var t=Object(n.useContext)(N),a=t.alerts.map((function(e,a){return r.a.createElement(x,{id:e.id,index:a,text:e.text,type:e.type,onHide:t.hideAlert,key:e.id})}));return r.a.createElement("div",{className:"alert-list"},a)}function x(e){return r.a.createElement("div",{id:"alert-id-".concat(e.id),className:"alert alert-".concat(e.type)},r.a.createElement("i",{className:"hide-alert fa-times-circle fas",onClick:function(){return e.onHide(e.index)}}),e.text)}function I(e){var t=Object(n.useContext)(N);return e=e||t,function(t){var a;(a=t&&t.response?t.response.data:t&&t.message?t.message:"string"==typeof t?t:"Error loading data").length>200&&(a="Connection error"),e.showAlert(a,"error")}}var T=a(10);a(187);function L(e){var t=e.emote.toLowerCase(),a=A[t];return r.a.createElement("div",{className:"emote",title:a.name,style:{backgroundImage:"url('/images/emotes/".concat(t,".").concat(a.type,"')")}})}var A={ez:{name:"EZ",type:"png"},feelsdankman:{name:"FeelsDankMan",type:"png"},feelsokayman:{name:"FeelsOkayMan",type:"png"},kapp:{name:"Kapp",type:"png"},monkagun:{name:"MonkaGun",type:"png"},monkahmm:{name:"MonkaHmm",type:"png"},monkas:{name:"MonkaS",type:"png"},nodders:{name:"Nodders",type:"gif"},nopers:{name:"Nopers",type:"gif"},omegalul:{name:"Omegalul",type:"png"},peepohappy:{name:"PeepoHappy",type:"png"},peeposad:{name:"PeepoSad",type:"png"},peepowtf:{name:"PeepoWtf",type:"png"},pepega:{name:"Pepega",type:"png"},pepegaaim:{name:"PepegaAim",type:"gif"},pepehands:{name:"PepeHands",type:"png"},pepelaugh:{name:"PepeLaugh",type:"png"},pepemeltdown:{name:"PepeMeltdown",type:"gif"},pepepains:{name:"PepePains",type:"png"},pepog:{name:"PepoG",type:"png"},sadge:{name:"Sadge",type:"png"},pepepls:{name:"PepePls",type:"gif"}},M=Object.keys(A),R=["fuck","shit","bitch"],P=["chink","faggot","fag","nazi","nigga","nigger","retard","wetback"];function F(e){var t=e.items.map(e.map);return r.a.createElement("div",{className:"item-list ".concat(e.className||"")},t)}function D(e){var t=e.panels.map((function(e,t){return r.a.createElement("div",{className:"box-panel",key:t},r.a.createElement("div",{className:"heading"},e.icon,r.a.createElement("div",{className:"heading-text"},e.name)),r.a.createElement("div",{className:"content"},e.text))}));return r.a.createElement("div",{className:"panel-grid"},t)}function B(e){for(var t="millisecond",a=e.millisec,n=e.suffix||"",r=e.minSec,c=[{name:"second",scale:1e3},{name:"minute",scale:60},{name:"hour",scale:60},{name:"day",scale:24},{name:"week",scale:7},{name:"year",scale:52}],o=0;o<c.length-1&&a>=c[o].scale;)a/=c[o].scale,t=c[o].name,o++;return r&&"millisecond"==t?"Less than a second".concat(n):((a=Math.floor(a))>1&&(t+="s"),"".concat(a," ").concat(t).concat(n))}function V(e){var t=e.notifCount,a=e.onClick,n=e.lOffset;return r.a.createElement("div",{className:"notif-bound ".concat(e.className||""),onClick:a,ref:e.fwdRef},t>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-circle notif-icon ".concat(n?"l-offset":"")},r.a.createElement("div",{className:"notif-count"},t))),e.children)}function U(e){var t=Object(n.useState)(e.text),a=Object(i.a)(t,2),c=a[0],o=a[1];return Object(n.useEffect)((function(){if(null!=e.text){var t=e.text;e.filterProfanity&&(t=G(t,e.settings,e.profChar)),e.linkify&&(t=function(e){if(null==e)return;Array.isArray(e)||(e=[e]);var t=/http(s{0,1}):\/\/([\w.]+)\.(\w+)([^\s]*)/g;for(var a in e){for(var n=e[a],c=[],o=0,s=t.exec(n);s;)c.push(n.slice(o,s.index)),c.push(r.a.createElement("a",{href:s[0],target:"blank",key:o},s[0])),o=t.lastIndex,s=t.exec(n);c.push(n.slice(o,n.length)),e[a]=c}return 1==(e=e.flat()).length?e[0]:e}(t)),e.emotify&&(t=function(e){if(null!=e){for(var t in Array.isArray(e)||(e=[e]),e){var a=e[t];if("string"==typeof a){var n=a.split(" ");for(var c in n){var o=n[c];for(var s in M){var i=M[s],l=new RegExp("^".concat(i,"$"),"i");if(o.match(l)){n[c]=r.a.createElement(L,{emote:i});break}s==M.length-1&&(n[c]=n[c]+" ")}}e[t]=n}}return 1==(e=e.flat()).length?e[0]:e}}(t)),o(t)}}),[e.content]),c}function G(e,t,a){if(null!=e){for(var n in Array.isArray(e)||(e=[e]),t=t||{},e){var r=e[n];"string"==typeof r&&(a=a||"*",t.disablePg13Censor||(r=_(R,r,a)),t.disableAllCensors||(r=_(P,r,a)),e[n]=r)}return 1==(e=e.flat()).length?e[0]:e}}function _(e,t,a){var n,r=Object(T.a)(e);try{for(r.s();!(n=r.n()).done;)for(var c=n.value,o=new RegExp(c,"i"),s=o.exec(t);s;){var i=s.index,l=s[0].length,u=a.repeat(l);(t=t.split("")).splice(i,l,u),t=t.join(""),s=o.exec(t)}}catch(m){r.e(m)}finally{r.f()}return t}function W(e,t){function a(a){var n,r=Object(T.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;if(!c||!c.current||c.current.contains(a.target))return}}catch(o){r.e(o)}finally{r.f()}t()}Array.isArray(e)||(e=[e]),Object(n.useEffect)((function(){return document.addEventListener("click",a),document.addEventListener("contextmenu",a),function(){document.removeEventListener("click",a)}}),e)}function $(e){var t=H(),a=Object(i.a)(t,4),n=a[0],c=a[1],o=a[2],s=a[3],l=e.options.filter((function(t){return t==e.value||t.id==e.value}))[0],u=l?l.label||l:"",m=e.options.map((function(t){return"divider"==t?r.a.createElement("div",{className:"dropdown-divider"}):("string"==typeof t&&(t={id:t,label:t}),r.a.createElement("div",{className:"dropdown-menu-option",key:t.id,onClick:function(){return a=t.id,c(!1),void e.onChange(a);var a}},t.label," ",t.placeholder))}));return r.a.createElement("div",{className:"dropdown ".concat(e.className||""),ref:o},r.a.createElement("div",{className:"dropdown-control",onClick:function(){c(!n)}},e.icon,u,e.caret&&r.a.createElement("i",{className:"fas fa-caret-down"})),n&&r.a.createElement("div",{className:"dropdown-menu",ref:s},m))}function H(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(n.useRef)(),o=Object(n.useRef)();return W([o,c],(function(){return r(!1)})),Object(n.useLayoutEffect)((function(){if(a){var e=c.current.getBoundingClientRect(),t=o.current.getBoundingClientRect(),n=e.left,r=e.top+e.height+1+window.scrollY,s=window.innerWidith-(n+t.width);r+t.height-window.scrollY>window.innerHeight&&(r=e.top-t.height-2),s<0?n+s<0&&(s-=n+s):s=0,o.current.style.left=n+"px",o.current.style.top=r+"px",o.current.style.visibility="visible"}})),[a,r,c,o]}function q(e){e=e.slice();for(var t=0;t<e.length;t++)" "==e[t]&&(e=e.replace(" ","-"));return e}function Y(e){for(var t=e.toLowerCase().split(" "),a="",n=0;n<t.length;n++)a+=0==n?t[n]:t[n].charAt(0).toUpperCase()+t[n].substring(1);return a}function z(e,t,a){for(;e.length<t;)e=a+e;return e}function J(e){if(!e)return"";if("string"==typeof e)return e;var t=(e=new Date(e)).toLocaleDateString(),a=e.toTimeString();return e=(t=z((t=t.split("/"))[2],2,"0")+"-"+z(t[0],2,"0")+"-"+z(t[1],2,"0"))+"T"+(a=(a=a.split(":"))[0]+":"+a[1])}a(188);function Q(e){return r.a.createElement("div",{className:"nav"},e.children)}function K(e){var t=e.links.map((function(e,t){return!e.hide&&r.a.createElement(s.c,{exact:e.exact,to:e.path,key:e.path},e.text)}));return r.a.createElement("div",{className:"sub-nav"},t,e.showFilter&&r.a.createElement("div",{className:"filter"},r.a.createElement($,{value:e.filterSel,options:e.filterOptions,onChange:e.onFilter,icon:e.filterIcon,caret:!0})))}function X(e){var t=e.page,a=e.maxPage,c=e.range||5,o=e.onNav,s=e.inverted,l=null==a,u=Object(n.useReducer)((function(){if(l)return[t];for(var e=t<=a?t:1,n=e,r=e+1,o=[],s=!0;s;)s=!1,o.length<c&&n>=1&&(o.unshift(n--),s=!0),o.length<c&&r<=a&&(o.push(r++),s=!0);return o}),a,(function(e){if(l)return[1];for(var t=[],a=0;a<e;a++)t.push(a+1);return t})),m=Object(i.a)(u,2),d=m[0],f=m[1];function p(e){e>=1&&(l||e<=a)&&o(e)}Object(n.useEffect)((function(){f()}),[t,c,a]);var h=d.map((function(t){var a="page-num";return e.page==t&&(a+=" page-sel"),r.a.createElement("div",{className:a,onClick:function(){return p(t)},key:t},t)}));return r.a.createElement("div",{className:"page-nav ".concat(s?"inverted":"")},r.a.createElement("div",{className:"page-nav-left max",onClick:function(){return p(1)}},"\xab"),r.a.createElement("div",{className:"page-nav-left",onClick:function(){return p(t-1)}},"\u2039"),h,r.a.createElement("div",{className:"page-nav-right ".concat(l?"max":""),onClick:function(){return p(t+1)}},"\u203a"),!l&&r.a.createElement("div",{className:"page-nav-right max",onClick:function(){return p(a)}},"\xbb"))}function Z(e,t,a,n){var r;if(1==e)r="last=Infinity";else if(e<t&&0!=a.length)r="first=".concat(a[0][n]);else{if(!(e>t&&0!=a.length))return;r="last=".concat(a[a.length-1][n])}return r}function ee(e){return r.a.createElement("div",{className:"search-bar"},r.a.createElement("input",{type:"text",value:e.value,placeholder:e.placeholder,onChange:function(t){e.onInput(t.target.value)}}),r.a.createElement("div",{className:"search-icon"},r.a.createElement("i",{className:"fas fa-search"})))}var te=a(16),ae=a(99),ne=a.n(ae),re=a(53),ce=a.n(re);function oe(e){return r.a.createElement("div",{className:"loading-page ".concat(e.className||"")},r.a.createElement(ce.a,{type:"bars",color:"#ffffff"}))}function se(){var e=Object(n.useContext)(k),t=e.history,a=e.updateHistory,c=(e.updatePlayers,e.stateViewing),o=e.updateStateViewing,s=e.self,i=e.players,l=e.isSpectator,u=Object(n.useRef)(!1),m=t.states[c]?t.states[c].meetings:{},d=(t.states[c]&&t.states[c].stateEvents,["gunshot"]),f=[!1],p=[!1],h=[1];return Object(n.useEffect)((function(){o({type:"current"})}),[t.currentState]),Object(n.useEffect)((function(){e.loadAudioFiles(d,f,p,h),e.review&&o({type:"first"})}),[]),xt((function(t){t.on("state",(function(t){u.current&&e.playAudio("bell"),u.current=!0})),t.on("winners",(function(e){})),t.on("gunshot",(function(){e.playAudio("gunshot")}))}),e.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(It,{gameType:"Mafia",setup:e.setup,history:t,stateViewing:c,updateStateViewing:o,players:i,socket:e.socket,options:e.options,spectatorCount:e.spectatorCount,setLeave:e.setLeave,finished:e.finished,review:e.review,setShowSettingsModal:e.setShowSettingsModal,setRehostId:e.setRehostId,dev:e.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"M"),"afia"),timer:r.a.createElement(Ht,{timers:e.timers,history:t})}),r.a.createElement(Tt,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt,{players:i,history:t,gameType:"Mafia",stateViewing:c,activity:e.activity}),r.a.createElement(Jt,{filters:e.speechFilters,setFilters:e.setSpeechFilters,stateViewing:c})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{socket:e.socket,history:t,updateHistory:a,players:i,stateViewing:c,settings:e.settings,filters:e.speechFilters,review:e.review,options:e.options,setTyping:e.setTyping,agoraClient:e.agoraClient,localAudioTrack:e.localAudioTrack,setActiveVoiceChannel:e.setActiveVoiceChannel,muted:e.muted,setMuted:e.setMuted,deafened:e.deafened,setDeafened:e.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Vt,{socket:e.socket,meetings:m,players:i,self:s,history:t,stateViewing:c}),!e.review&&!l&&t.currentState>=0&&e.setup.lastWill&&r.a.createElement(qt,{lastWill:e.lastWill,socket:e.socket}),!e.review&&!l&&r.a.createElement(Qt,{stateViewing:c}))}))}function ie(e){var t=Object(n.useContext)(k),a=t.history,c=t.updateHistory,o=(t.updatePlayers,t.stateViewing),s=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[o]?a.states[o].meetings:{},f=(a.states[o]&&a.states[o].stateEvents,[]),p=[],h=[],v=[];return Object(n.useEffect)((function(){s({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,v),t.review&&s({type:"first"})}),[]),xt((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(It,{gameType:"Split Decision",setup:t.setup,history:a,stateViewing:o,updateStateViewing:s,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"Split")," Decision"),timer:r.a.createElement(Ht,{timers:t.timers,history:a})}),r.a.createElement(Tt,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt,{players:l,history:a,gameType:"Split Decision",stateViewing:o,activity:t.activity}),r.a.createElement(Jt,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:o})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{socket:t.socket,history:a,updateHistory:c,players:l,stateViewing:o,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Vt,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:o}),!u&&r.a.createElement(Qt,{stateViewing:o}))}))}function le(e){var t=Object(n.useContext)(k),a=t.history,c=t.updateHistory,o=(t.updatePlayers,t.stateViewing),s=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[o]?a.states[o].meetings:{},f=(a.states[o]&&a.states[o].stateEvents,[]),p=[],h=[],v=[];return Object(n.useEffect)((function(){s({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,v),t.review&&s({type:"first"})}),[]),xt((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(It,{gameType:"Resistance",setup:t.setup,history:a,stateViewing:o,updateStateViewing:s,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"R"),"esistance"),timer:r.a.createElement(Ht,{timers:t.timers,history:a})}),r.a.createElement(Tt,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt,{players:l,history:a,gameType:"Resistance",stateViewing:o,activity:t.activity}),r.a.createElement(Jt,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:o})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{socket:t.socket,history:a,updateHistory:c,players:l,stateViewing:o,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Vt,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:o}),!u&&r.a.createElement(Qt,{stateViewing:o}))}))}function ue(e){var t=Object(n.useContext)(k),a=t.history,c=t.updateHistory,o=(t.updatePlayers,t.stateViewing),s=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[o]?a.states[o].meetings:{},f=(a.states[o]&&a.states[o].stateEvents,["gunshot"]),p=[!1],h=[!1],v=[1];return Object(n.useEffect)((function(){s({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,v),t.review&&s({type:"first"})}),[]),xt((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){})),e.on("gunshot",(function(){t.playAudio("gunshot")}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(It,{gameType:"One Night",setup:t.setup,history:a,stateViewing:o,updateStateViewing:s,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"One")," Night"),timer:r.a.createElement(Ht,{timers:t.timers,history:a})}),r.a.createElement(Tt,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt,{players:l,history:a,gameType:"One Night",stateViewing:o,activity:t.activity}),r.a.createElement(Jt,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:o})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt,{socket:t.socket,history:a,updateHistory:c,players:l,stateViewing:o,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Vt,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:o}),!u&&r.a.createElement(Qt,{stateViewing:o}))}))}a(218);function me(e){return r.a.createElement("div",{className:"span-panel main landing-page"},r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"logo"}),r.a.createElement("div",{className:"characters-circle"})),r.a.createElement("div",{className:"play-break"},r.a.createElement("div",{className:"play-btn-wrapper"},r.a.createElement(s.b,{to:"/auth/signup"},"Play Mafia"))),r.a.createElement("div",{className:"intro"},"BeyondMafia is the mafia site that is revolutionary in design, safety, and has a thriving community of users from all walks of life. With competitive and casual live mafia, and other gamemodes like Resistance, you're sure to find something that suits how YOU want to play."),r.a.createElement("div",{className:"mafia-features"},r.a.createElement("div",{className:"chat-mafia"},r.a.createElement("div",{className:"village-character"}),r.a.createElement("div",{className:"feature-title"},"Chat Mafia"),r.a.createElement("div",{className:"feature-desc"},"10-20 minute games with a variety of roles! Play wiht classic roles, or try out something different in the Sandbox lobby. You can create your own custom roles, too, using modifiers or by contributing to the open source codebase!")),r.a.createElement("div",{className:"forum-mafia"},r.a.createElement("div",{className:"cop-character"}),r.a.createElement("div",{className:"feature-title"},"Forum Mafia"),r.a.createElement("div",{className:"feature-desc"},"Play Mafia in the forums. More features are coming soon with the planned forum game engine!"))),r.a.createElement("div",{className:"other-games"},r.a.createElement("div",{className:"other-games-img"}),r.a.createElement("div",{className:"feature-title"},"Other Games"),r.a.createElement("div",{className:"feature-desc"},"Explore other Mafia-esque games like Resistance, One Night Ultimate Werewolf, and 2 Rooms and a Boom.")),r.a.createElement("div",{className:"play-break"},r.a.createElement("div",{className:"play-btn-wrapper"},r.a.createElement(s.b,{to:"/auth/signup"},"Play Mafia"))))}var de=a(34),fe=a.n(de),pe=a(163),he=a(97),ve=a.n(he);a(426),a(427),a(428),a(429),a(430),a(431);function ge(e){function t(t,a,n){var r=t.target.value;null!=a.min&&Number(r)<a.min?r=a.min:null!=a.max&&Number(r)>a.max&&(r=a.max),e.onChange({ref:a.ref,prop:"value",value:r,localOnly:n})}var a=e.fields.map((function(a,n){var c,o="function"==typeof a.disabled?a.disabled(e.deps):a.disabled,s="field-wrapper ".concat(o?"disabled":"");if(c="string"==typeof a.showIf?[a.showIf]:a.showIf,Array.isArray(c)){var i,l=Object(T.a)(c);try{for(l.s();!(i=l.n()).done;){var u=i.value,m="!"==u[0];m&&(u=u.slice(1));var d,f=Object(T.a)(e.fields);try{for(f.s();!(d=f.n()).done;){var p=d.value;if(p.ref==u&&"boolean"==p.type){if(0==(1==p.value^m))return;break}}}catch(v){f.e(v)}finally{f.f()}}}catch(v){l.e(v)}finally{l.f()}}else if("function"==typeof c&&!c(e.deps))return;var h="function"==typeof a.value?a.value(e.deps):a.value;switch(a.type){case"text":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("input",{type:a.type,value:h||"",placeholder:a.placeholder,disabled:o,onChange:function(e){return!a.fixed&&t(e,a,a.saveBtn)},onClick:function(e){return a.highlight&&e.target.select()}}),a.saveBtn&&e.deps[a.saveBtnDiffer]!=a.value&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(n){(!a.confirm||window.confirm(a.confirm))&&(a.saveBtnOnClick?a.saveBtnOnClick(a.value,e.deps):t(n,a))}},a.saveBtn));case"number":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("input",{type:"number",value:a.value||"0",min:a.min,max:a.max,step:a.step,disabled:o,onChange:function(e){return t(e,a)}}));case"boolean":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("div",{className:"switch-wrapper"},r.a.createElement(be,{value:a.value||!1,disabled:o,onChange:function(e){return t(e,a)}})));case"select":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("select",{value:a.value||a.options[0].ref,disabled:o,onChange:function(e){return t(e,a)}},a.options.map((function(e){return r.a.createElement("option",{value:e.value,key:e.value},e.label)}))));case"range":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("div",{className:"range-wrapper"},r.a.createElement("input",{type:"range",min:a.min,max:a.max,step:a.step,value:a.value,disabled:o,onChange:function(e){return t(e,a)}})));case"color":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement(ye,{value:a.value,default:a.default,alpha:a.alpha,disabled:o,onChange:function(e){return t(e,a)}}),!a.noReset&&a.value!=a.default&&a.value&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(){return t({target:{value:a.default}},a)}},"Reset"));case"datetime-local":return r.a.createElement("div",{className:s,key:a.ref},r.a.createElement("div",{className:"label"},a.label),r.a.createElement("div",{className:"datetime-wrapper"},r.a.createElement("input",{type:"datetime-local",min:J(a.min),max:J(a.max),value:J(a.value),disabled:o,onChange:function(e){return t(e,a)}})))}}));return r.a.createElement("div",{className:"form"},a,e.submitText&&r.a.createElement("div",{className:"btn btn-theme-sec",onClick:e.onSubmit},e.submitText))}function be(e){return r.a.createElement("div",{className:"switch ".concat(e.value?"on":""),onClick:function(){return!e.disabled&&e.onChange({target:{value:!e.value}})}},r.a.createElement("div",{className:"track"}),r.a.createElement("div",{className:"thumb"}),r.a.createElement("input",{type:"hidden",value:e.value}))}function ye(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useRef)(),l=e.value||e.default,u=e.disabled;return W(s,(function(){return o(!1)})),r.a.createElement("div",{className:"color-picker ".concat(u?"disabled":""),style:{backgroundColor:l},onClick:function(e){u||e.target!=s.current||o(!c)},ref:s},c&&r.a.createElement(pe.a,{color:l,disableAlpha:!e.alpha,onChangeComplete:function(t,a){e.onChange({target:{value:t.hex}})}}))}function Ee(e){var t=Object(n.useRef)();return r.a.createElement("div",{className:e.className,onClick:function(){var a=!0;e.onClick&&(a=e.onClick()),a&&t.current.click()}},e.children,r.a.createElement("input",{className:"hidden-upload",ref:t,type:"file",onChange:function(t){return e.onFileUpload(t.target.files,e.name)}}))}function we(e){var t=Object(n.useState)(e),a=Object(i.a)(t,1)[0],r=Object(n.useReducer)((function(e,t){var a=Object(te.a)(e);for(var n in Array.isArray(t)||(t=[t]),a){var r,c=a[n],o=Object(h.a)({},c),s=Object(T.a)(t);try{for(s.s();!(r=s.n()).done;){var i=r.value;if(c.ref&&c.ref==i.ref){"string"==typeof i.value&&"boolean"==c.type&&(i.value="true"==i.value),o[i.prop]=i.value;break}}}catch(l){s.e(l)}finally{s.f()}a[n]=o}return a}),e),c=Object(i.a)(r,2),o=c[0],s=c[1];return[o,s,function(){var e,t=[],n=Object(T.a)(a);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push({ref:r.ref,prop:"value",value:r.value})}}catch(c){n.e(c)}finally{n.f()}s(t)}]}function Oe(e){var t=e.value,a=e.setValue,c=Object(n.useState)(""),o=Object(i.a)(c,2),s=o[0],l=o[1],u=Object(n.useState)(!1),m=Object(i.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(e.options),y=Object(i.a)(b,2),E=y[0],w=y[1],O=Object(n.useRef)(),N=Object(n.useRef)();Object(n.useEffect)((function(){if(d){var e=O.current.getBoundingClientRect(),t=N.current.getBoundingClientRect(),a=e.top+e.height+1;a+t.height>window.innerHeight&&(a=e.top-t.height-2),N.current.style.top=a+"px",N.current.style.visibility="visible"}})),Object(n.useEffect)((function(){if(""==s)w(e.options);else{var t=e.options.filter((function(e){return e.toLowerCase().includes(s.toLowerCase())}));w(t)}}),[s,e.options]);var j=E.map((function(t){return r.a.createElement("div",{className:"option-row",onClick:function(){return function(t){a(t),l(""),f(!1),g(!1),e.onChange&&e.onChange(t)}(t)},key:t},t)}));return r.a.createElement("div",{className:"search-select",tabIndex:"0",onFocus:function(){f(!0)},onBlur:function(){v||(f(!1),l(""),w(e.options))},ref:O},r.a.createElement("input",{value:s,placeholder:t||e.placeholder,onChange:function(t){l(t.target.value),e.onInputChange&&e.onInputChange(t)},onKeyDown:function(t){"Enter"==t.key?(a(E[0]),l(""),f(!1),g(!1),e.onChange&&e.onChange(E[0])):d||f(!0)}}),r.a.createElement("div",{className:"icon-wrapper"},r.a.createElement("i",{className:"fas fa-chevron-down"})),d&&r.a.createElement("div",{className:"option-list",onMouseEnter:function(){g(!0)},onMouseLeave:function(){g(!1)},ref:N},j.length>0&&j,!j.length&&r.a.createElement("div",{className:"no-options"},"No Options")))}function Ne(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)({}),l=Object(i.a)(s,2),u=l[0],m=l[1],f=Object(n.useState)(""),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(""),b=Object(i.a)(g,2),y=b[0],E=b[1];return Object(n.useEffect)((function(){0!=h.length&&d.a.get("/user/searchName?query=".concat(h)).then((function(e){var t,a={},n=Object(T.a)(e.data);try{for(n.s();!(t=n.n()).done;){var r=t.value;a[r.name]=r.id}}catch(c){n.e(c)}finally{n.f()}m(a),o(e.data.map((function(e){return e.name})))})).catch(I)}),[h]),r.a.createElement(Oe,Object.assign({},e,{options:c,value:y,setValue:function(t){E(t),e.setValue(u[t])},onInputChange:function(e){v(e.target.value)}}))}function je(e){var t=Object(n.useState)("write"),a=Object(i.a)(t,2),c=a[0],o=a[1];return r.a.createElement(ve.a,{value:e.value,onChange:e.onChange,selectedTab:c,onTabChange:o,classes:{preview:"md-content"},generateMarkdownPreview:function(e){return Promise.resolve(r.a.createElement(fe.a,{source:e}))}})}a(153);function ke(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(),s=Object(i.a)(o,2),l=s[0],m=s[1],f=Object(n.useState)(),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(),b=Object(i.a)(g,2),y=b[0],E=b[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),S=k[0],C=k[1],x=Object(n.useState)(),L=Object(i.a)(x,2),A=L[0],M=L[1],R=Object(n.useState)(!1),P=Object(i.a)(R,2),F=P[0],D=P[1],V=Object(n.useState)(!1),U=Object(i.a)(V,2),_=U[0],W=U[1],$=Object(n.useState)({}),H=Object(i.a)($,2),q=H[0],Y=H[1],z=Object(n.useState)({}),J=Object(i.a)(z,2),Q=J[0],K=J[1],ee=Object(n.useState)([]),te=Object(i.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)([]),ce=Object(i.a)(re,2),se=ce[0],ie=ce[1],le=Object(n.useState)(!1),ue=Object(i.a)(le,2),me=ue[0],de=ue[1],pe=Object(n.useState)(1),he=Object(i.a)(pe,2),ve=he[0],ge=he[1],be=Object(n.useState)(1),ye=Object(i.a)(be,2),we=(ye[0],ye[1]),Oe=Object(n.useState)([]),Ne=Object(i.a)(Oe,2),ke=Ne[0],Se=Ne[1],Ce=Object(n.useState)([]),xe=Object(i.a)(Ce,2),Ie=xe[0],Ae=xe[1],Me=Object(n.useState)({Mafia:{}}),Re=Object(i.a)(Me,2),Pe=Re[0],Fe=Re[1],De=Object(n.useContext)(O),Be=Object(n.useContext)(N),Ve=Object(u.g)(),Ue=I(),Ge=Object(u.i)().userId,_e=Ge==De.id,$e=!_e&&-1!=De.blockedUsers.indexOf(Ge);function He(e,t){if(e.length){var a=new FormData;a.append("image",e[0]);var n,r=Object(T.a)(document.getElementsByClassName("hidden-upload"));try{for(r.s();!(n=r.n()).done;){n.value.value=""}}catch(c){r.e(c)}finally{r.f()}d.a.post("/user/".concat(t),a).then((function(e){switch(t){case"avatar":v(!0),Be.clearCache();break;case"banner":E(!0),Be.clearCache()}})).catch((function(e){null==e.response||413==e.response.status?Ue("File too large, must be less than 2 MB."):Ue(e)}))}}function Ye(e){var t=Z(e,ve,ke,"lastActive");null!=t&&d.a.get("/user/".concat(Ge,"/friends?").concat(t)).then((function(t){t.data.length&&(Se(t.data),ge(e))})).catch(Ue)}Object(n.useEffect)((function(){me&&de(!1)}),[me]),Object(n.useEffect)((function(){Ge&&(c(!1),d.a.get("/user/".concat(Ge,"/profile")).then((function(e){c(!0),m(e.data.name),v(e.data.avatar),E(e.data.banner),C(G(e.data.bio,De.settings,"\\*")||""),W(e.data.isFriend),Y(e.data.settings),K(e.data.accounts||{}),ne(e.data.games),ie(e.data.setups),we(e.data.maxFriendsPage),Ae(e.data.friendRequests),ge(1),Fe(e.data.stats),document.title="".concat(e.data.name,"'s Profile | BeyondMafia")})).catch((function(e){Ue(e),Ve.push("/play")})),d.a.get("/user/".concat(Ge,"/friends")).then((function(e){Se(e.data)})).catch(Ue))}),[Ge]);var ze,Je={},Qe={};q.backgroundColor&&(Je.backgroundColor=q.backgroundColor),y&&(Qe.backgroundImage="url(/uploads/".concat(Ge,"_banner.jpg?t=").concat(Be.cacheVal,")")),"stretch"==q.bannerFormat&&(Qe.backgroundSize="100% 100%"),ze=Object.keys(Pe.Mafia).map((function(e){var t,a=Pe.Mafia[e];if(a.total<1)a="-";else if("wins"==e)a="".concat(Math.round(a.count/a.total*100),"%");else{var n="F",c=Object.keys(w[e]).reverse(),o=0;for(a=a.count/a.total;a>=w[e][c[o]]&&o<c.length;)n=c[o++];a=n}return r.a.createElement("div",{className:"rating",key:e},r.a.createElement("div",{className:"name"},(t=e).charAt(0).toUpperCase()+t.substring(1)),r.a.createElement("div",{className:"score"},a))}));var Ke=ae.map((function(e){return r.a.createElement(qe,{game:e,type:e.status||"Finished",key:e.id,small:!0})})),Xe=se.map((function(e){return r.a.createElement(pt,{setup:e,key:e.id})})),Ze=Ie.map((function(e){return r.a.createElement("div",{className:"friend-request",key:e.id},r.a.createElement(Le,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"btns"},r.a.createElement("i",{className:"fas fa-check",onClick:function(){return t=e.id,void d.a.post("/user/friend",{user:t}).then((function(e){var a=Ie.slice().filter((function(e){return e.id!=t}));Ae(a),Be.showAlert(e.data,"success")})).catch(Ue);var t}}),r.a.createElement("i",{className:"fas fa-times",onClick:function(){return t=e.id,void d.a.post("/user/friend/reject",{user:t}).then((function(e){var a=Ie.slice().filter((function(e){return e.id!=t}));Ae(a),Be.showAlert(e.data,"success")})).catch(Ue);var t}})))})),et=ke.map((function(e){return r.a.createElement("div",{className:"friend",key:e.id},r.a.createElement(Le,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"last-active"},r.a.createElement(B,{minSec:!0,millisec:Date.now()-e.lastActive,suffix:" ago"})))}));return!De.loaded||De.loggedIn||Ge?De.loaded&&De.loggedIn&&!Ge?r.a.createElement(u.a,{to:"/user/".concat(De.id)}):a&&De.loaded?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"profile"},r.a.createElement("div",{className:"main-panel",style:Je},r.a.createElement("div",{className:"banner",style:Qe},_e&&r.a.createElement(Ee,{className:"edit",name:"banner",onClick:function(e,t){return!!De.itemsOwned.customProfile||(Ue("You must purchase profile customization with coins from the Shop."),!1)},onFileUpload:He},r.a.createElement("i",{className:"far fa-file-image"}))),r.a.createElement("div",{className:"user-info"},r.a.createElement("div",{className:"avi-name-row"},r.a.createElement("div",{className:"avi-name"},!me&&r.a.createElement(Te,{large:!0,id:Ge,hasImage:h,bustCache:me,name:l,edit:_e,onUpload:He}),r.a.createElement("div",{className:"name"},l))),!_e&&De.loggedIn&&r.a.createElement("div",{className:"options"},r.a.createElement("i",{className:"fas fa-user-plus ".concat(_?"sel":""),onClick:function(){if(_&&!window.confirm("Are you sure you wish to unfriend or cancel your friend request?"))return;d.a.post("/user/friend",{user:Ge}).then((function(e){W(!_),Be.showAlert(e.data,"success")})).catch(Ue)}}),r.a.createElement("i",{className:"fas fa-ban ".concat($e?"sel":""),onClick:function(){if(!$e&&!window.confirm("Are you sure you wish to block this user?"))return;d.a.post("/user/block",{user:Ge}).then((function(){De.blockUserToggle(Ge),$e?Be.showAlert("User unblocked.","success"):Be.showAlert("User blocked.","success")})).catch(Ue)},title:"Block user"})),r.a.createElement("div",{className:"accounts"},Q.discord&&q.showDiscord&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon discord-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},Q.discord))),Q.twitch&&q.showTwitch&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon twitch-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},Q.twitch))),Q.steam&&q.showSteam&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon steam-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},Q.steam)))),r.a.createElement("div",{className:"bio ".concat(_e&&!F?"edit":""),onClick:function(){D(_e),M(S)}},!F&&r.a.createElement("div",{className:"md-content"},r.a.createElement(fe.a,{source:S})),F&&r.a.createElement(r.a.Fragment,null,r.a.createElement(je,{value:S,onChange:C}),r.a.createElement("div",{className:"buttons"},r.a.createElement("div",{className:"btn btn-theme",onClick:function(e){d.a.post("/user/bio",{bio:S}).then((function(){D(!1),C(G(S,De.settings,"\\*"))})).catch(Ue)}},"Submit"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(e){e.stopPropagation(),D(!1),C(A)}},"Cancel")))))),r.a.createElement("div",{className:"side column"},ze.length>0&&r.a.createElement("div",{className:"box-panel ratings",style:Je},r.a.createElement("div",{className:"heading"},"Mafia Ratings"),r.a.createElement("div",{className:"content"},ze)),r.a.createElement("div",{className:"box-panel recent-games",style:Je},r.a.createElement("div",{className:"heading"},"Recent Games"),r.a.createElement("div",{className:"content"},Ke,0==ae.length&&"No games")),Ie.length>0&&r.a.createElement("div",{className:"box-panel friend-requests",style:Je},r.a.createElement("div",{className:"heading"},"Friend Requests"),r.a.createElement("div",{className:"content"},Ze)),r.a.createElement("div",{className:"box-panel friends",style:Je},r.a.createElement("div",{className:"heading"},"Friends"),r.a.createElement("div",{className:"content"},r.a.createElement(X,{inverted:!0,page:ve,onNav:Ye}),et,0==ke.length&&"No friends yet",r.a.createElement(X,{inverted:!0,page:ve,onNav:Ye}))),r.a.createElement("div",{className:"box-panel created-setups",style:Je},r.a.createElement("div",{className:"heading"},"Setups Created"),r.a.createElement("div",{className:"content"},Xe,0==se.length&&"No setups")))),r.a.createElement(We,{location:Ge})):r.a.createElement(oe,null):r.a.createElement(u.a,{to:"/play"})}a(432);function Se(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useState)({}),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(u.g)(),E=Object(n.useContext)(O),w=Object(n.useContext)(N),j=I(),k=we([{label:"Referral URL",ref:"referralURL",type:"text",value:function(e){return"".concat("https://ujwcbfwxrqnp.beyondmafia.com","/auth/login?ref=").concat(e.user.id)},fixed:!0,highlight:!0},{label:"DMs from Friends Only",ref:"onlyFriendDMs",type:"boolean"},{label:"Disable PG-13 Censor",ref:"disablePg13Censor",type:"boolean",showIf:"!disableAllCensors"},{label:"Disable All Censors",ref:"disableAllCensors",type:"boolean",showIf:function(e){return e.user.perms.disableAllCensors}},{label:"Hide Deleted Posts",ref:"hideDeleted",type:"boolean",showIf:function(e){return e.user.perms.viewDeleted}}]),S=Object(i.a)(k,2),C=S[0],x=S[1],T=we([{label:"Name",ref:"username",type:"text",saveBtn:"Change",saveBtnDiffer:"name",saveBtnOnClick:function(e,t){var a="";-1!=Ce.indexOf(e.toLowerCase())&&(a=window.prompt("This name is reserved, please enter your reservation code."));d.a.post("/user/name",{name:e,code:a}).then((function(a){t.siteInfo.showAlert("Username changed","success"),t.user.set(p()(t.user,{name:{$set:e},itemsOwned:{nameChange:{$set:t.user.itemsOwned.nameChange-1}}}))})).catch(t.errorAlert)},confirm:"Are you sure you wish to change your username?"},{label:"Show Discord",ref:"showDiscord",type:"boolean",showIf:function(e){return e.accounts.discord&&e.accounts.discord.id}},{label:"Show Twitch",ref:"showTwitch",type:"boolean",showIf:function(e){return e.accounts.twitch&&e.accounts.twitch.id}},{label:"Show Steam",ref:"showSteam",type:"boolean",showIf:function(e){return e.accounts.steam&&e.accounts.steam.id}},{label:"Background Color",ref:"backgroundColor",type:"color",default:"#5357a5",disabled:function(e){return!e.user.itemsOwned.customProfile}},{label:"Banner Format",ref:"bannerFormat",type:"select",options:[{label:"Tile",value:"tile"},{label:"Stretch",value:"stretch"}],disabled:function(e){return!e.user.itemsOwned.customProfile}}]),L=Object(i.a)(T,2),A=L[0],M=L[1],R=we([{label:"Name Color",ref:"nameColor",type:"color",default:"#000",disabled:function(e){return!e.user.itemsOwned.textColors}},{label:"Text Color",ref:"textColor",type:"color",default:"#000",disabled:function(e){return!e.user.itemsOwned.textColors}}]),P=Object(i.a)(R,2),F=P[0],D=P[1];function B(e,t){"value"!=e.prop||e.localOnly||d.a.post("/user/settings/update",{prop:e.ref,value:e.value}).then((function(){E.updateSetting(e.ref,e.value)})).catch(j),t(e)}return Object(n.useEffect)((function(){document.title="Settings | BeyondMafia"}),[]),Object(n.useEffect)((function(){E.loaded&&E.loggedIn&&(c||d.a.get("/user/settings/data").then((function(e){var t=[],a=[],n=[];for(var r in e.data)e.data[r]&&(t.push({ref:r,prop:"value",value:e.data[r]}),a.push({ref:r,prop:"value",value:e.data[r]}),n.push({ref:r,prop:"value",value:e.data[r]}));x(t),M(a),D(n),o(!0)})).catch(j),m||d.a.get("/user/accounts").then((function(e){b(e.data),f(!0)})).catch(j))}),[E]),E.loaded&&!E.loggedIn?r.a.createElement(u.a,{to:"/play"}):c&&m&&E.loaded?r.a.createElement("div",{className:"span-panel main settings"},r.a.createElement("div",{className:"heading"},"Site"),r.a.createElement(ge,{fields:C,deps:{user:E},onChange:function(e){return B(e,x)}}),r.a.createElement("div",{className:"heading"},"Profile"),r.a.createElement(ge,{fields:A,deps:{name:E.name,user:E,accounts:g,siteInfo:w,errorAlert:j},onChange:function(e){return B(e,M)}}),r.a.createElement("div",{className:"heading"},"Game"),r.a.createElement(ge,{fields:F,deps:{user:E},onChange:function(e){return B(e,D)}}),r.a.createElement("div",{className:"heading"},"Accounts"),r.a.createElement("div",{className:"accounts-row"},r.a.createElement("div",{className:"accounts-column"},r.a.createElement("div",{className:"btn btn-theme-sec logout",onClick:function(){d.a.post("/user/logout").then((function(e){E.clear(),y.push("/")})).catch(j)}},"Sign Out"),r.a.createElement("div",{className:"btn delete-account",onClick:function(){window.confirm("Are you sure you wish to delete your account? This is irreversible.")&&d.a.post("/user/delete").then((function(e){E.clear(),y.push("/")})).catch(j)}},"Delete Account")))):r.a.createElement(oe,null)}var Ce=["admin","administrator","mod","moderator","dev","developer","giga","rend","arcbell"];a(433);function xe(e){var t=Object(n.useState)({shopItems:[],balance:0}),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useContext)(O),g=Object(n.useContext)(N),b=I();Object(n.useEffect)((function(){document.title="Shop | BeyondMafia"}),[]),Object(n.useEffect)((function(){h.loaded&&h.loggedIn&&d.a.get("/shop/info").then((function(e){o(e.data),f(!0)})).catch(b)}),[h.loaded]);var y=c.shopItems.map((function(e,t){return r.a.createElement("div",{className:"shop-item",key:t},r.a.createElement("div",{className:"name"},e.name),r.a.createElement("div",{className:"desc"},e.desc),r.a.createElement("div",{className:"bottom"},r.a.createElement("div",{className:"price"},r.a.createElement("i",{className:"fas fa-coins"}),e.price," coins"),r.a.createElement("div",{className:"owned"},"Owned:",r.a.createElement("div",{className:"amt"},h.itemsOwned[e.key],null!=e.limit&&" / ".concat(e.limit))),r.a.createElement("div",{className:"buy btn btn-theme",disabled:null!=e.limit&&h.itemsOwned[e.key]>=e.limit,onClick:function(){return function(e){var t=c.shopItems[e];window.confirm("Are you sure you wish to buy ".concat(t.name," for ").concat(t.price," coins?"))&&d.a.post("/shop/spendCoins",{item:e}).then((function(){g.showAlert("Item purchased.","success"),o(p()(c,{balance:{$set:c.balance-t.price}})),h.set(p()(h.state,{itemsOwned:Object(v.a)({},t.key,{$set:h.itemsOwned[t.key]+1})}))})).catch(b)}(t)}},"Buy")))}));return h.loaded&&!h.loggedIn?r.a.createElement(u.a,{to:"/play"}):m?r.a.createElement("div",{className:"span-panel main shop"},r.a.createElement("div",{className:"top-bar"},r.a.createElement("div",{className:"balance"},r.a.createElement("i",{className:"fas fa-coins"}),c.balance)),r.a.createElement("div",{className:"shop-items"},y)):r.a.createElement(oe,null)}function Ie(e){var t=Object(n.useContext)(O),a=[{text:"Profile",path:t.id?"/user/".concat(t.id):"/user",exact:!0,hide:!t.loggedIn},{text:"Settings",path:"/user/settings",hide:!t.loggedIn},{text:"Shop",path:"/user/shop",hide:!t.loggedIn}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{links:a}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/user",render:function(){return r.a.createElement(ke,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/settings",render:function(){return r.a.createElement(Se,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/shop",render:function(){return r.a.createElement(xe,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/:userId",render:function(){return r.a.createElement(ke,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/user"})}}))))}function Te(e){var t,a=e.small,c=e.large,o=e.id,s=e.name,i=e.hasImage,l=e.imageUrl,u=e.edit,m=e.onUpload,d=e.active,f=Object(n.useContext)(N),p={},h=["#fff59d","#ef9a9a","#9fa8da","#ce93d8","#a5d6a7","#f48fb1","#ffcc80","#90deea","#80cbc4"];if(t=a?"small":c?"large":"",i&&!l&&o)p.backgroundImage="url(/uploads/".concat(o,"_avatar.jpg?t=").concat(f.cacheVal,")");else if(i&&l)p.backgroundImage="url(".concat(l,")");else if(s){for(var v=0,g=0;g<s.length;g++)v^=s.charCodeAt(g);v^=s.charCodeAt(1),v^=v<<13,v^=v>>7,v^=v<<17,v=Math.abs(v)/Math.pow(2,31),p.backgroundColor=h[Math.floor(v*h.length)]}return r.a.createElement("div",{className:"avatar ".concat(t," ").concat(d?"active":""),style:p},u&&r.a.createElement(Ee,{className:"edit",name:"avatar",onFileUpload:m},r.a.createElement("i",{className:"far fa-file-image"})))}function Le(e){var t=e.id,a=e.name||"[deleted]",c=e.avatar,o=!e.name||e.noLink,i=e.color,l=e.newTab,u=e.small,m=e.active,d=Object(n.useContext)(j);return r.a.createElement(s.b,{className:"name-with-avatar ".concat(o?"no-link":""),to:"/user/".concat(t),target:l?"_blank":"",onClick:function(e){d.setVisible(!1),o&&e.preventDefault()}},r.a.createElement(Te,{hasImage:c,id:t,name:a,small:u,active:m}),r.a.createElement("div",{className:"user-name",style:i?{color:i}:{}},a))}function Ae(e){return r.a.createElement("div",{className:"status-icon ".concat(e.status)})}function Me(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),u=Object(i.a)(l,2),m=u[0],f=u[1],p=I();function h(e,t){return e.position-t.position}Object(n.useEffect)((function(){document.title="Categories | BeyondMafia",e.updateForumNavInfo({action:"home"}),d.a.get("/forums/categories").then((function(t){var a,n=t.data.sort(h),r=Object(T.a)(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;c.boards=c.boards.sort(h)}}catch(s){r.e(s)}finally{r.f()}o(n),f(!0),e.updateForumNavInfo({type:"home"})})).catch(p)}),[]);var v=c.map((function(e){var t=e.boards.map((function(e){var t=e.newestThreads.map((function(e){return r.a.createElement("div",{className:"column-item",key:e.id},r.a.createElement("div",{className:"thread-link-wrapper"},r.a.createElement(s.b,{to:"/community/forums/thread/".concat(e.id)},e.title)),r.a.createElement(Le,{small:!0,id:e.author.id,name:e.author.name,avatar:e.author.avatar}),r.a.createElement("div",{className:"thread-counts"},r.a.createElement(_e,{viewCount:e.viewCount||0,replyCount:e.replyCount||0})))})),a=e.recentReplies.map((function(e){return r.a.createElement("div",{className:"column-item",key:e.id},r.a.createElement("div",{className:"thread-link-wrapper"},r.a.createElement(s.b,{to:"/community/forums/thread/".concat(e.thread.id,"?reply=").concat(e.id)},e.thread.title)),r.a.createElement(Le,{small:!0,id:e.author.id,name:e.author.name,avatar:e.author.avatar}),r.a.createElement("div",{className:"reply-age"},r.a.createElement(B,{millisec:Date.now()-e.postDate})," ago"))}));return r.a.createElement("div",{className:"board",key:e.id},r.a.createElement("i",{className:"fas fa-".concat(e.icon||"comments"," board-icon")}),r.a.createElement(s.b,{className:"board-info",to:"/community/forums/board/".concat(e.id)},r.a.createElement("div",{className:"board-name"},e.name),r.a.createElement("div",{className:"board-desc"},e.description)),r.a.createElement("div",{className:"forum-column tall"},r.a.createElement("div",{className:"column-title"},"Newest Thread"),r.a.createElement("div",{className:"column-content ".concat(0==t.length?"center-content":"")},0==t.length&&r.a.createElement("div",{className:"column-item center-item"},"No threads yet"),t)),r.a.createElement("div",{className:"forum-column tall three"},r.a.createElement("div",{className:"column-title"},"Recent Replies"),r.a.createElement("div",{className:"column-content ".concat(0==a.length?"center-content":"")},0==a.length&&r.a.createElement("div",{className:"column-item center-item"},"No replies yet"),a)))}));return r.a.createElement("div",{className:"span-panel forum-category",key:e.id},r.a.createElement("div",{className:"title"},e.name),r.a.createElement("div",{className:"boards"},t))}));return m?v:r.a.createElement(oe,null)}a(434);function Re(e){return r.a.createElement(r.a.Fragment,null,e.show&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"modal-bg",onClick:e.onBgClick}),r.a.createElement("div",{className:"modal ".concat(e.className?e.className:"")},r.a.createElement("div",{className:"modal-header"},e.header),r.a.createElement("div",{className:"modal-content"},e.content),r.a.createElement("div",{className:"modal-footer"},e.footer))))}function Pe(e){var t=Object(n.useState)({}),a=Object(i.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),m=Object(i.a)(l,2),f=m[0],p=m[1],h=Object(n.useState)(""),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useState)(""),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useState)(1),k=Object(i.a)(j,2),S=k[0],C=k[1],x=Object(n.useState)("bumpDate"),T=Object(i.a)(x,2),L=T[0],A=(T[1],Object(n.useState)(!1)),M=Object(i.a)(A,2),R=M[0],P=M[1],F=Object(n.useState)(),D=Object(i.a)(F,2),V=D[0],U=D[1],G=Object(u.i)().boardId,_=Object(n.useContext)(O),W=I();function $(e){var t=Z(e,S,c.threads,L);null!=t&&d.a.get("/forums/board/".concat(G,"?sortType=").concat(L,"&").concat(t)).then((function(t){t.data.threads.length>0&&(o(t.data),C(e))})).catch(W)}function H(e){var t=e.recentReplies.map((function(t){return r.a.createElement("div",{className:"column-item",key:t.id},r.a.createElement(Le,{small:!0,id:t.author.id,name:t.author.name,avatar:t.author.avatar}),r.a.createElement(s.b,{className:"reply-age",to:"/community/forums/thread/".concat(e.id,"?reply=").concat(t.id)},r.a.createElement(B,{millisec:Date.now()-t.postDate})," ago"))}));return r.a.createElement("div",{className:"thread ".concat(e.deleted?"deleted":""),key:e.id},r.a.createElement(Ge,{item:e,itemType:"thread",itemHolder:c,setItemHolder:o,itemKey:"threads"}),r.a.createElement("div",{className:"thread-info"},r.a.createElement(s.b,{className:"thread-title",to:"/community/forums/thread/".concat(e.id)},e.locked&&r.a.createElement("i",{className:"fas fa-lock"}),e.pinned&&r.a.createElement("i",{className:"fas fa-thumbtack"}),e.title),r.a.createElement(Le,{small:!0,id:e.author.id,avatar:e.author.avatar,name:e.author.name}),r.a.createElement("div",{className:"counts"},r.a.createElement(_e,{viewCount:e.viewCount||0,replyCount:e.replyCount||0}))),r.a.createElement("div",{className:"forum-column"},r.a.createElement("div",{className:"column-title"},"Post Date"),r.a.createElement("div",{className:"column-content"},r.a.createElement("div",{className:"column-item center-item"},r.a.createElement(B,{millisec:Date.now()-e.postDate})," ago"))),r.a.createElement("div",{className:"forum-column three"},r.a.createElement("div",{className:"column-title"},"Recent Replies"),r.a.createElement("div",{className:"column-content ".concat(0==t.length?"center-content":"")},0==t.length&&r.a.createElement("div",{className:"column-item center-item"},"No replies yet"),t)))}if(Object(n.useEffect)((function(){document.title="Create Mafia Setup | BeyondMafia"}),[]),Object(n.useEffect)((function(){d.a.get("/forums/board/".concat(G)).then((function(t){o(t.data),P(!0),document.title="".concat(t.data.name," | BeyondMafia"),e.updateForumNavInfo({type:"board",id:G,name:t.data.name})})).catch((function(e){W(e),U("/community/forums")}))}),[G]),Object(n.useEffect)((function(){R&&e.updateForumNavInfo({action:"board",id:c.id,name:c.name})}),[R,c]),V)return r.a.createElement(u.a,{to:V});if(!R)return r.a.createElement(oe,null);var q=c.threads.map(H),Y=c.pinnedThreads.map(H);return r.a.createElement("div",{className:"board-wrapper"},r.a.createElement(Fe,{boardId:G,show:f,setShow:p,threadTitle:g,setThreadTitle:b,threadContent:w,setThreadContent:N,setRedirect:U}),r.a.createElement("div",{className:"board-info"},r.a.createElement("div",{className:"board-title-wrapper"},r.a.createElement("i",{className:"fas fa-".concat(c.icon||"comments"," board-icon")}),r.a.createElement("div",{className:"board-title"},c.name)),r.a.createElement("div",{className:"create-thread btn btn-theme",onClick:function(){p(!0)},disabled:!_.perms.createThread},r.a.createElement("i",{className:"fas fa-plus"}),"Create Thread")),Y.length>0&&r.a.createElement("div",{className:"threads pinned-threads span-panel"},Y),r.a.createElement(X,{inverted:!0,page:S,onNav:$}),r.a.createElement("div",{className:"threads span-panel"},q.length>0&&q,0==q.length&&"No threads yet"),r.a.createElement(X,{inverted:!0,page:S,onNav:$}))}function Fe(e){var t=I(),a=r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"field-wrapper thread-title"},r.a.createElement("div",{className:"label"},"Title"),r.a.createElement("input",{type:"text",value:e.threadTitle,onChange:function(t){e.setThreadTitle(t.target.value)}})),r.a.createElement(je,{value:e.threadContent,onChange:e.setThreadContent})),n=r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"post btn btn-theme",onClick:function(){d.a.post("/forums/thread",{board:e.boardId,title:e.threadTitle,content:e.threadContent}).then((function(t){e.setShow(!1),e.setRedirect("/community/forums/thread/".concat(t.data))})).catch(t)}},"Post"),r.a.createElement("div",{className:"cancel btn btn-theme-third",onClick:c},"Cancel"));function c(){e.setShow(!1)}return r.a.createElement(Re,{className:"create-thread",show:e.show,onBgClick:c,header:"Create Thread",content:a,footer:n})}function De(e){var t=Object(n.useState)({}),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useState)(),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useState)(!1),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),S=k[0],C=k[1],x=Object(n.useState)(1),L=Object(i.a)(x,2),A=L[0],M=L[1],R=Object(n.useState)(!1),P=Object(i.a)(R,2),F=P[0],D=P[1],B=Object(n.useRef)(),V=Object(u.i)().threadId,U=Object(u.h)(),_=Object(n.useContext)(O),W=I(),$=new URLSearchParams(U.search);function H(e){if(!c.locked||_.perms.postInLocked){if(N(!0),e){for(var t="".concat(S,"\n\n> ##### @").concat(e.author.name,":\n"),a=e.content.split("\n"),n=0;n<a.length;n++)a[n]="> ".concat(a[n]);t="".concat(t).concat(a.join("\n"),"\n\n"),C(t)}w&&B.current.scrollIntoView()}}function q(e){d.a.get("/forums/thread/".concat(V,"?page=").concat(e)).then((function(t){t.data.content=G(t.data.content,_.settings,"\\*");var a,n=Object(T.a)(t.data.replies);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=G(r.content,_.settings,"\\*")}}catch(c){n.e(c)}finally{n.f()}M(e),o(t.data)})).catch(W)}if(Object(n.useEffect)((function(){document.title="Forums | BeyondMafia"}),[]),Object(n.useEffect)((function(){d.a.get("/forums/thread/".concat(V,"?reply=").concat($.get("reply")||"")).then((function(t){t.data.content=G(t.data.content,_.settings,"\\*");var a,n=Object(T.a)(t.data.replies);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=G(r.content,_.settings,"\\*")}}catch(c){n.e(c)}finally{n.f()}o(t.data),M(t.data.page),f(!0),e.updateForumNavInfo({type:"thread",boardId:t.data.board.id,boardName:t.data.board.name,threadId:t.data.id,threadTitle:t.data.title})})).catch((function(e){W(e),b("/community/forums")}))}),[V]),Object(n.useEffect)((function(){if(m){if(e.updateForumNavInfo({action:"boardAndThread",boardId:c.board.id,boardName:c.board.name,threadId:c.id,threadTitle:c.title}),F||!$.get("reply"))return;var t=document.getElementById("reply-".concat($.get("reply")));D(!0),t&&t.scrollIntoView()}}),[m,c]),Object(n.useEffect)((function(){w&&B.current.scrollIntoView()}),[w]),g)return r.a.createElement(u.a,{to:g});if(!m)return r.a.createElement(oe,null);var Y=c.replies.map((function(e){return r.a.createElement(Be,{className:"reply ".concat(e.id==$.get("reply")?"sel":""),id:"reply-".concat(e.id),key:e.id,postInfo:e,itemType:"reply",voteItem:e,voteItemHolder:c,setVoteItemHolder:o,itemKey:"replies",locked:c.locked,permaLink:"/community/forums/thread/".concat(V,"?reply=").concat(e.id),onReplyClick:function(){return H(e)},onDelete:function(){return q(A)},onRestore:function(){return q(A)},onEdit:function(){return q(A)}})}));return r.a.createElement("div",{className:"thread-wrapper"},r.a.createElement(Be,{postInfo:c,itemType:"thread",voteItem:c,setVoteItemHolder:o,locked:c.locked,onReplyClick:function(){return H()},onDelete:function(){b("/community/forums/board/".concat(c.board.id))},onRestore:function(){return q(A)},onEdit:function(){return q(A)},onNotifyToggled:function(){o(p()(c,{replyNotify:{$set:!c.replyNotify}}))},onPinToggled:function(){o(p()(c,{pinned:{$set:!c.pinned}}))},onLockToggled:function(){o(p()(c,{locked:{$set:!c.locked}}))},hasTitle:!0}),r.a.createElement("div",{className:"reply-form-wrapper",ref:B},w&&r.a.createElement("div",{className:"reply-form span-panel"},r.a.createElement(je,{value:S,onChange:C}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme",onClick:function(){d.a.post("/forums/reply",{thread:c.id,content:S}).then((function(e){q(Number(e.data)),C(""),N(!1),document.body.scrollTop=document.body.scrollHeight})).catch(W)}},"Post"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){N(!1),C("")}},"Cancel")))),r.a.createElement("div",{className:"replies-wrapper"},r.a.createElement(X,{inverted:!0,page:A,maxPage:c.pageCount,onNav:q}),r.a.createElement("div",{className:"replies"},0==Y.length&&"No replies yet",Y),r.a.createElement(X,{inverted:!0,page:A,maxPage:c.pageCount,onNav:q})))}function Be(e){var t=e.id,a=e.postInfo,c=e.itemType,o=e.voteItem,l=e.voteItemHolder,u=e.setVoteItemHolder,m=e.itemKey,f=e.hasTitle,p=e.permaLink,h=e.locked,g=e.onReplyClick,b=e.onDelete,y=e.onRestore,E=e.onEdit,w=e.onNotifyToggled,N=e.onPinToggled,j=e.onLockToggled,k=Object(n.useState)(!1),S=Object(i.a)(k,2),C=S[0],x=S[1],T=Object(n.useState)(a.content),L=Object(i.a)(T,2),A=L[0],M=L[1],R=Object(n.useContext)(O),P=I();var F=a.content;return a.deleted&&R.settings.hideDeleted&&(F="*deleted*"),r.a.createElement("div",{className:"post span-panel ".concat(a.deleted?"deleted":""," ").concat(e.className),id:t},r.a.createElement("div",{className:"vote-wrapper"},r.a.createElement(Ge,{item:o,itemType:c,itemHolder:l,setItemHolder:u,itemKey:m})),r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"heading-left"},f&&r.a.createElement("div",{className:"title"},h&&r.a.createElement("i",{className:"fas fa-lock"}),a.pinned&&r.a.createElement("i",{className:"fas fa-thumbtack"}),a.title),r.a.createElement("div",{className:"post-info"},r.a.createElement(Le,{id:a.author.id,name:a.author.name,avatar:a.author.avatar}),r.a.createElement("div",{className:"post-date"},r.a.createElement(B,{minSec:!0,millisec:Date.now()-a.postDate})," ago"))),r.a.createElement("div",{className:"btns-wrapper"},!a.deleted&&r.a.createElement(r.a.Fragment,null,"thread"==c&&R.perms.pinThreads&&r.a.createElement("i",{className:"fas fa-thumbtack ".concat(a.pinned?"fa-rotate-180":""),onClick:function(){d.a.post("/forums/thread/togglePinned",{thread:a.id}).then(N).catch(P)}}),"thread"==c&&R.perms.lockThreads&&r.a.createElement("i",{className:"fas fa-lock".concat(a.locked?"-open":""),onClick:function(){d.a.post("/forums/thread/toggleLocked",{thread:a.id}).then(j).catch(P)}}),(R.perms.deleteAnyPost||R.perms.deleteOwnPost&&a.author.id==R.id)&&r.a.createElement("i",{className:"fas fa-trash",onClick:function(){window.confirm("Are you sure you wish to delete this?")&&d.a.post("/forums/".concat(c,"/delete"),Object(v.a)({},c,a.id)).then(b).catch(P)}}),R.perms.editPost&&a.author.id==R.id&&(!h||R.perms.postInLocked)&&r.a.createElement("i",{className:"fas fa-pencil-alt",onClick:function(){x(!0)}}),"thread"==c&&a.author.id==R.id&&r.a.createElement("i",{className:"fa".concat(a.replyNotify?"s":"r"," fa-bell"),onClick:function(){d.a.post("/forums/thread/notify",{thread:a.id}).then(w).catch((function(){}))}}),p&&r.a.createElement(s.b,{to:p,onClick:function(){navigator.clipboard.writeText(window.location.origin+p)}},r.a.createElement("i",{className:"fas fa-link"})),R.perms.postReply&&(!h||R.perms.postInLocked)&&r.a.createElement("i",{className:"reply-btn fas fa-reply",onClick:g})),a.deleted&&R.perms.restoreDeleted&&r.a.createElement("i",{className:"fas fa-trash-restore",onClick:function(){d.a.post("/forums/".concat(c,"/restore"),Object(v.a)({},c,a.id)).then(y).catch(P)}}))),!C&&r.a.createElement("div",{className:"md-content"},r.a.createElement(fe.a,{source:F})),C&&r.a.createElement("div",{className:"edit-wrapper"},r.a.createElement(je,{value:A,onChange:M}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme-sec",onClick:function(){var e;d.a.post("/forums/".concat(c,"/edit"),(e={},Object(v.a)(e,c,a.id),Object(v.a)(e,"content",A),e)).then((function(){x(!1),E()})).catch(P)}},"Save"),r.a.createElement("div",{className:"btn btn-theme-third",onClick:function(){x(!1)}},"Cancel")))))}a(154);function Ve(){var e=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"board":a={board:{id:t.id,name:t.name}};break;case"thread":a={board:{id:t.boardId,name:t.boardName},thread:{id:t.threadId,title:t.threadTitle}};break;case"home":a={}}return a||e}),{}),t=Object(i.a)(e,2),a=t[0],c=t[1];return r.a.createElement("div",{className:"forums"},r.a.createElement(Ue,{forumNavInfo:a}),r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/community/forums",render:function(){return r.a.createElement(Me,{updateForumNavInfo:c})}}),r.a.createElement(u.b,{exact:!0,path:"/community/forums/board/:boardId",render:function(){return r.a.createElement(Pe,{updateForumNavInfo:c})}}),r.a.createElement(u.b,{exact:!0,path:"/community/forums/thread/:threadId",render:function(){return r.a.createElement(De,{updateForumNavInfo:c})}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/community/forums"})}})))}function Ue(e){var t=e.forumNavInfo;return r.a.createElement("div",{className:"span-panel"},r.a.createElement("div",{className:"forum-nav"},r.a.createElement("div",{className:"path"},r.a.createElement(s.c,{to:"/community/forums"},r.a.createElement("i",{className:"fas fa-home home"}),"Forums"),t.board&&r.a.createElement(s.c,{to:"/community/forums/board/".concat(t.board.id)},r.a.createElement("i",{className:"fas fa-chevron-right separator"}),t.board.name),t.thread&&r.a.createElement(s.c,{to:"/community/forums/thread/".concat(t.thread.id)},r.a.createElement("i",{className:"fas fa-chevron-right separator"}),t.thread.title))))}function Ge(e){var t=e.item,a=e.itemType,c=e.itemHolder,o=e.setItemHolder,s=e.itemKey,i=Object(n.useContext)(O),l=I();function u(e,n){i.perms.vote&&d.a.post("/forums/vote",{item:e,itemType:a,direction:n}).then((function(a){var r,i=Number(a.data),l=function(e,a){var n=t.voteCount;return 0==t.vote?n+=e:t.vote==e?n+=-1*e:n+=2*e,p()(t,{vote:{$set:a},voteCount:{$set:n}})}(n,i);if(null!=c){for(var u in r=s?c[s]:c)if(r[u].id==e){var m=r.slice();m[u]=l,o(s?p()(c,Object(v.a)({},s,{$set:m})):m);break}}else o(l)})).catch(l)}return r.a.createElement("div",{className:"vote-widget"},r.a.createElement("i",{className:"fas fa-arrow-up ".concat(1==t.vote&&"sel"),onClick:function(){return u(t.id,1)}}),t.voteCount||0,r.a.createElement("i",{className:"fas fa-arrow-down ".concat(-1==t.vote&&"sel"),onClick:function(){return u(t.id,-1)}}))}function _e(e){var t=e.viewCount,a=e.replyCount,n=1!=t,r=1!=a;return"".concat(t," view").concat(n?"s":"",", ").concat(a," repl").concat(r?"ies":"y")}a(435);function We(e){var t=e.location,a=Object(n.useState)(1),c=Object(i.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)([]),u=Object(i.a)(l,2),m=u[0],f=u[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(""),y=Object(i.a)(b,2),E=y[0],w=y[1],N=Object(n.useState)(!1),j=Object(i.a)(N,2),k=j[0],S=j[1],C=Object(n.useContext)(O),x=I();function L(e){var a=Z(e,o,m,"date");null!=a&&d.a.get("/comment?location=".concat(t,"&").concat(a)).then((function(t){if(S(!0),t.data.length>0){var a,n=Object(T.a)(t.data);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=G(r.content,C.settings,"\\*")}}catch(c){n.e(c)}finally{n.f()}f(t.data),s(e)}})).catch(x)}Object(n.useEffect)((function(){f([]),L(1)}),[t]);var A=m.map((function(e){return r.a.createElement($e,{comment:e,comments:m,setComments:f,onDelete:function(){return L(o)},onRestore:function(){return L(o)},key:e.id})}));return k?r.a.createElement("div",{className:"comments-wrapper thread-wrapper"},r.a.createElement("div",{className:"comments-input-wrapper"},!v&&C.loggedIn&&C.perms.postReply&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){return g(!0)}},"Post Comment"),v&&r.a.createElement("div",{className:"reply-form span-panel"},r.a.createElement(je,{value:E,onChange:w}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme",onClick:function(){d.a.post("/comment",{content:E,location:t}).then((function(){L(1),w(""),g(!1)})).catch(x)}},"Post"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){g(!1)}},"Cancel")))),r.a.createElement("div",{className:"comments-page"},r.a.createElement(X,{inverted:!0,page:o,onNav:L}),0==m.length&&"No comments yet",A,r.a.createElement(X,{inverted:!0,page:o,onNav:L}))):r.a.createElement(oe,{className:"under"})}function $e(e){var t=e.comment,a=e.comments,c=e.setComments,o=e.onDelete,s=e.onRestore,i=Object(n.useContext)(O),l=I();var u=t.content;return t.deleted&&i.settings.hideDeleted&&(u="*deleted*"),r.a.createElement("div",{className:"post ".concat(t.deleted?"deleted":""," ").concat(e.className||"")},r.a.createElement("div",{className:"vote-wrapper"},r.a.createElement(Ge,{item:t,itemHolder:a,setItemHolder:c,itemType:"comment"})),r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"heading-left"},r.a.createElement("div",{className:"post-info"},r.a.createElement(Le,{id:t.author.id,name:t.author.name,avatar:t.author.avatar}),r.a.createElement("div",{className:"post-date"},r.a.createElement(B,{minSec:!0,millisec:Date.now()-t.date})," ago"))),r.a.createElement("div",{className:"btns-wrapper"},!t.deleted&&(i.perms.deleteAnyPost||i.perms.deleteOwnPost&&t.author.id==i.id)&&r.a.createElement("i",{className:"fas fa-trash",onClick:function(){window.confirm("Are you sure you wish to delete this?")&&d.a.post("/comment/delete",{comment:t.id}).then(o).catch(l)}}),t.deleted&&i.perms.restoreDeleted&&r.a.createElement("i",{className:"fas fa-trash-restore",onClick:function(){d.a.post("/comment/restore",{comment:t.id}).then(s).catch(l)}}))),r.a.createElement("div",{className:"md-content"},r.a.createElement(fe.a,{source:u}))))}a(436);function He(e){var t=Object(n.useState)("All"),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(1),l=Object(i.a)(s,2),m=l[0],f=l[1],p=Object(n.useState)([]),h=Object(i.a)(p,2),v=h[0],g=h[1],y=Object(u.h)(),E=Object(u.g)(),w=Object(n.useContext)(O),N=I(),j=new URLSearchParams(y.search),k=Object(n.useState)(j.get("lobby")||localStorage.getItem("lobby")||"All"),S=Object(i.a)(k,2),C=S[0],x=S[1];function T(e,t){var a=Z(t,m,v,"endTime");null!=a&&(a+="&page=".concat(t),d.a.get("/game/list?list=".concat(Y(e),"&lobby=").concat(C,"&").concat(a)).then((function(a){(a.data.length>0||1==t)&&(o(e),f(t),g(a.data))})).catch(N))}return Object(n.useEffect)((function(){localStorage.setItem("lobby",C),j.get("lobby")!=C&&E.push(y.pathname+"?lobby=".concat(C)),document.title="Play (".concat(C,") | BeyondMafia"),T(c,1)}),[y.pathname,C]),"All"!=C&&-1==b.indexOf(C)&&x("All"),w.loaded?w.loaded&&!w.loggedIn?r.a.createElement(me,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"span-panel main join"},r.a.createElement("div",{className:"left-panel"}),r.a.createElement("div",{className:"right-panel"},r.a.createElement("div",{className:"top-bar lobby-list"},r.a.createElement(mt,{text:"All",sel:C,onClick:function(){return x("All")}}),r.a.createElement(mt,{text:"Main",sel:C,onClick:function(){return x("Main")}}),r.a.createElement(mt,{text:"Sandbox",sel:C,onClick:function(){return x("Sandbox")}}),r.a.createElement(mt,{text:"Competitive",sel:C,onClick:function(){return x("Competitive")}}),r.a.createElement(mt,{text:"Games",sel:C,onClick:function(){return x("Games")}})),r.a.createElement(F,{className:"games",items:v,map:function(e){return r.a.createElement(qe,{game:e,lobby:C,refresh:function(){return T(c,m)},odd:v.indexOf(e)%2==1,key:e.id})},empty:"No games"}),r.a.createElement(X,{page:m,onNav:function(e){return T(c,e)}}))),r.a.createElement(We,{location:"Main"==C||"All"==C?"lobby":"lobby-".concat(C)})):r.a.createElement(oe,null)}function qe(e){var t,a,c=Object(n.useState)(!1),o=Object(i.a)(c,2),l=o[0],m=o[1],f=Object(n.useState)(e.game.reserved),p=Object(i.a)(f,2),v=p[0],g=p[1],b=Object(n.useRef)(),y=Object(n.useContext)(O),E=Object(n.useContext)(j),w=Object(n.useContext)(N),k=I();var S="btn ";switch(e.small&&(S+="btn-small "),e.game.status){case"Open":t="/game/".concat(e.game.id),S+="btn-join ",e.game.scheduled<=Date.now()&&(a="Join");break;case"In Progress":e.game.spectating||y.perms.canSpectateAny?(t="/game/".concat(e.game.id),S+="btn-spectate ",a="Spectate"):(t="/play",S+="btn-in-progress ",a="In Progress");break;case"Finished":t="/game/".concat(e.game.id,"/review"),S+="btn-review ",a="Review"}return l?r.a.createElement(u.a,{to:l}):e.game.setup?r.a.createElement("div",{className:"row ".concat(e.odd?"odd":""," game-row")},r.a.createElement("div",{className:"btns-wrapper"},(y.loggedIn||"Finished"==e.status)&&!e.game.broken&&!e.game.private&&r.a.createElement(s.b,{to:t,className:S,disabled:"In Progress"==e.status&&!e.game.spectating},a),y.loggedIn&&e.game.scheduled>Date.now()&&!v&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){d.a.post("/game/reserve",{gameId:e.game.id}).then((function(e){g(!v),w.showAlert(e.data,"success")})).catch(k)}},"Reserve"),y.loggedIn&&e.game.scheduled>Date.now()&&v&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){d.a.post("/game/unreserve",{gameId:e.game.id}).then((function(e){g(!v),w.showAlert(e.data,"success")})).catch(k)}},"Unreserve"),e.game.scheduled>Date.now()&&y.id==e.game.hostId&&r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){d.a.post("/game/cancel",{gameId:e.game.id}).then((function(t){w.showAlert(t.data,"success"),e.refresh()})).catch(k)}},"Cancel"),e.game.broken&&r.a.createElement("i",{className:"fas fa-car-crash review-icon",title:"Broken"}),e.game.private&&r.a.createElement("i",{className:"fas fa-lock review-icon",title:"Private"})),r.a.createElement("div",{className:"player-count-wrapper"},r.a.createElement(Ye,{game:e.game})),r.a.createElement("div",{className:"setup-wrapper"},r.a.createElement(pt,{setup:e.game.setup,maxRolesCount:e.small?3:5})),!e.small&&r.a.createElement("div",{className:"setup-name"},e.game.setup.name),r.a.createElement("div",{className:"game-infos"},e.game.ranked&&r.a.createElement("i",{className:"ranked fas fa-chart-bar",title:"Ranked game"}),e.game.voiceChat&&r.a.createElement("i",{className:"voice-chat fas fa-microphone",title:"Voice chat game"}),"Finished"==e.game.status&&y.loggedIn&&!e.small&&r.a.createElement("i",{className:"rehost fas fa-redo",title:"Rehost",onClick:function(){var t={};for(var a in e.game.stateLengths)t[a]=e.game.stateLengths[a]/6e4;d.a.post("/game/host",Object(h.a)({gameType:e.game.type,setup:e.game.setup.id,lobby:e.lobby,guests:e.game.guests,private:!1,ranked:e.game.ranked,spectating:e.game.spectating,voiceChat:e.game.voiceChat,readyCheck:e.game.readyCheck,stateLengths:t},JSON.parse(e.game.gameTypeOptions))).then((function(e){return m("/game/".concat(e.data))})).catch(k)}}),r.a.createElement("i",{className:"game-info fas fa-info-circle",ref:b,onClick:function(t){t.stopPropagation(),E.onClick("/game/".concat(e.game.id,"/info"),"game",b.current,"Game ".concat(e.game.id))}}))):r.a.createElement(r.a.Fragment,null)}function Ye(e){for(var t=e.game,a=[],n=0;n<t.setup.total;n++)a.push(r.a.createElement("div",{className:"player-circle ".concat(n<t.players?"filled":""),key:n}));return r.a.createElement("div",{className:"player-count"},a)}a(51);function ze(e){e.gameType;var t=e.selSetup,a=e.setSelSetup,c=e.formFields,o=e.updateFormFields,s=e.onHostGame,l=Object(n.useState)("featured"),m=Object(i.a)(l,2),f=m[0],p=m[1],h=Object(n.useState)(1),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useState)(1),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),S=k[0],C=k[1],x=Object(n.useState)([]),T=Object(i.a)(x,2),L=T[0],A=T[1],M=Object(u.h)(),R=Object(u.g)(),P=I(),D=Object(n.useContext)(O);function B(t,a,n){d.a.get("/setup/".concat(Y(t),"?gameType=").concat(e.gameType,"&page=").concat(a,"&query=").concat(n||"")).then((function(e){p(t),b(a),A(e.data.setups),N(e.data.pages)}))}function V(e){d.a.post("/setup/favorite",{id:e.id}).catch(P);var t=Object(te.a)(L);for(var a in L)if(L[a].id==e.id){t[a].favorite=!L[a].favorite;break}A(t)}function U(e){R.push("/play/create?edit=".concat(e.id))}function _(e){d.a.post("/setup/delete",{id:e.id}).then((function(){B(f,g)})).catch(P)}Object(n.useEffect)((function(){var e=new URLSearchParams(M.search);e.get("setup")?(B("id",1,e.get("setup")),d.a.get("/setup/".concat(e.get("setup"))).then((function(e){e.data.name=G(e.data.name,D.settings),a(e.data)})).catch(P)):B(f,g)}),[]),Object(n.useEffect)((function(){o({ref:"setup",prop:"value",value:t.name})}),[t]);var W=["Featured","Popular","Favorites","Yours"].map((function(e){return r.a.createElement(mt,{text:e,sel:f,onClick:function(){return function(e){C(""),B(e,1)}(e)},key:e})}));return r.a.createElement("div",{className:"span-panel main host"},r.a.createElement("div",{className:"top-bar"},W,r.a.createElement(ee,{value:S,placeholder:"Setup Name",onInput:function(e){C(e),e.length?B("search",1,e):B("featured",1)}})),r.a.createElement(F,{items:L,map:function(e){return r.a.createElement(Je,{setup:e,sel:t,listType:f,onSelect:a,onFav:V,onEdit:U,onDel:_,odd:L.indexOf(e)%2==1,key:e.id})},empty:"No setups"}),r.a.createElement(X,{page:g,maxPage:w,onNav:function(e){var t=[f,e];S.length&&t.append(S),B.apply(void 0,t)}}),D.loggedIn&&r.a.createElement(ge,{fields:c,onChange:o,submitText:"Host",onSubmit:s}))}function Je(e){var t=Object(n.useContext)(O),a="far",c="far";return e.sel.id==e.setup.id&&(a="fas"),e.setup.favorite&&(c="fas"),r.a.createElement("div",{className:"row ".concat(e.odd?"odd":"")},t.loggedIn&&r.a.createElement("i",{className:"select-setup fa-circle ".concat(a),onClick:function(){return e.onSelect(e.setup)}}),r.a.createElement("div",{className:"setup-wrapper"},r.a.createElement(pt,{setup:e.setup})),r.a.createElement("div",{className:"setup-name"},e.setup.name),t.loggedIn&&r.a.createElement("i",{className:"setup-btn fav-setup fa-star ".concat(c),onClick:function(){return e.onFav(e.setup)}}),t.loggedIn&&"Yours"==e.listType&&r.a.createElement("i",{className:"setup-btn edit-setup fa-pen-square fas",onClick:function(){return e.onEdit(e.setup)}}),t.loggedIn&&"Yours"==e.listType&&r.a.createElement("i",{className:"setup-btn del-setup fa-times-circle fas",onClick:function(){return e.onDel(e.setup)}}))}function Qe(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),s=Object(i.a)(o,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=we([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean",showIf:"!ranked"},{label:"Allow Guests",ref:"guests",type:"boolean",showIf:"!ranked"},{label:"Ranked",ref:"ranked",type:"boolean",showIf:["!private","!spectating","!voiceChat","!guests"]},{label:"Spectating",ref:"spectating",type:"boolean",showIf:"!ranked"},{label:"Voice Chat",ref:"voiceChat",type:"boolean",showIf:"!ranked"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Day Length (minutes)",ref:"dayLength",type:"number",value:10,min:1,max:30},{label:"Night Length (minutes)",ref:"nightLength",type:"number",value:2,min:1,max:10},{label:"Extension Length (minutes)",ref:"extendLength",type:"number",value:3,min:1,max:5}]),v=Object(i.a)(h,2),g=v[0],y=v[1];function E(e){var t,a=Object(T.a)(g);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host Mafia | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(ze,{gameType:"Mafia",selSetup:a,setSelSetup:c,formFields:g,updateFormFields:y,onHostGame:function(){var e=E("scheduled"),t=E("lobby");"All"==t&&(t="Main"),a.id?d.a.post("/game/host",{gameType:"Mafia",lobby:t,setup:a.id,private:E("private"),guests:E("guests"),ranked:E("ranked"),spectating:E("spectating"),voiceChat:E("voiceChat"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{Day:E("dayLength"),Night:E("nightLength")},extendLength:E("extendLength")}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}a(437);function Ke(e){var t,a=e.gameType,c=e.formFields,o=e.updateFormFields,s=e.closedField,l=e.resetFormFields,m=e.formFieldValueMods,f=e.onCreateSetup,p=I(),v=Object(n.useState)(0),g=Object(i.a)(v,2),b=g[0],y=g[1],E=Object(n.useState)(""),w=Object(i.a)(E,2),j=w[0],k=w[1],S=Object(n.useState)(!1),C=Object(i.a)(S,2),x=C[0],L=C[1],A=Object(n.useState)("None"),M=Object(i.a)(A,2),R=M[0],P=M[1],F=Object(u.h)(),D=new URLSearchParams(F.search),B=Object(n.useContext)(N),V=Object(n.useReducer)((function(e,t){var a=Object(h.a)({},e);if("reset"!=t.type&&"setClosed"!=t.type)for(var n in a.roles=e.roles.slice(),e.roles)a.roles[n]=Object(h.a)({},e.roles[n]);switch(t.type){case"reset":a.roles=[{}];break;case"setClosed":a.closed=t.closed,t.closed&&(a.roles=a.roles.slice(0,1));break;case"addRole":(r=a.roles[b])[t.role]||(r[t.role]=0),r[t.role]++;break;case"removeRole":var r;(r=a.roles[b])[t.role]&&r[t.role]--,r[t.role]<1&&delete r[t.role];break;case"addRoleSet":a.roles.push({});break;case"removeRoleSet":a.roles.splice(t.index,1),t.index==b&&y(0);break;case"setFromSetup":a.closed=t.closed,a.roles=t.roles}return a}),{roles:[{}],closed:!1}),U=Object(i.a)(V,2),G=U[0],_=U[1],W=Object(n.useContext)(O);Object(n.useEffect)((function(){_({type:"setClosed",closed:s.value})}),[s.value]),Object(n.useEffect)((function(){D.get("edit")&&d.a.get("/setup/".concat(D.get("edit"))).then((function(e){var t=e.data;L(!0),_({type:"setFromSetup",roles:JSON.parse(t.roles),closed:t.closed});var a,n=[],r=Object(T.a)(c);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(t[s.ref]){var i=t[s.ref];if(m[s.ref]){var l,u=Object(T.a)(m[s.ref]);try{for(u.s();!(l=u.n()).done;){i=(0,l.value)(i)}}catch(f){u.e(f)}finally{u.f()}}n.push({ref:s.ref,prop:"value",value:i})}}}catch(f){r.e(f)}finally{r.f()}if(t.closed)for(var d in t.count)n.push({ref:"count-".concat(d),prop:"value",value:t.count[d]});o(n)})).catch(p)}),[]),x&&!D.get("edit")&&(L(!1),l(),_({type:"reset"})),t=G.roles.map((function(e,t){var n=[],c=function(t){n.push(r.a.createElement(dt,{role:t,count:e[t],gameType:a,onClick:function(){_({type:"removeRole",role:t})},key:t}))};for(var o in e)c(o);return r.a.createElement(Xe,{roles:n,index:t,sel:b,onClick:function(){return y(t)},onDelete:function(){_({type:"removeRoleSet",index:t})},key:t})}));var $=B.roles?B.roles.Modifiers[a]:[];return($=$.map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))).unshift(r.a.createElement("option",{value:"None",key:"None"},"None")),D.get("edit")&&!x?r.a.createElement(oe,null):r.a.createElement("div",{className:"span-panel main create-setup"},r.a.createElement(ft,{onAddClick:function(e){_({type:"addRole",role:"".concat(e.name,":").concat("None"!=R?R:""),alignment:e.alignment})},gameType:a}),W.loggedIn&&r.a.createElement("div",{className:"creation-options"},r.a.createElement(ge,{fields:c,onChange:o,submitText:x?"Edit":"Create",onSubmit:function(){return f(G,x,k)}}),r.a.createElement("div",{className:"rolesets-wrapper"},r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Role Modifier"),r.a.createElement("select",{value:R,onChange:function(e){var t=e.target.value;P(t)}},$))),r.a.createElement("div",{className:"rolesets"},t,!G.closed&&G.roles.length<10&&r.a.createElement("i",{className:"add-roleset fa-plus-circle fas",onClick:function(){return _({type:"addRoleSet"})}})))),j&&r.a.createElement(u.a,{to:"/play/host/?setup=".concat(j)}))}function Xe(e){return r.a.createElement("div",{className:"roleset ".concat(e.sel==e.index?"sel":""),onClick:e.onClick},e.roles,e.index>0&&r.a.createElement("i",{className:"del-roleset fa-times-circle fas",onClick:e.onDelete}))}function Ze(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),c=we([{label:"Setup Name",ref:"name",type:"text"},{label:"Day Start",ref:"startState",type:"boolean"},{label:"Dawn",ref:"dawn",type:"boolean"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Last Wills",ref:"lastWill",type:"boolean"},{label:"Must Act",ref:"mustAct",type:"boolean"},{label:"No Reveal",ref:"noReveal",type:"boolean"},{label:"Votes Invisible",ref:"votesInvisible",type:"boolean"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Village Count",ref:"count-Village",type:"number",value:"7",min:"0",max:"50",showIf:"closed"},{label:"Mafia Count",ref:"count-Mafia",type:"number",value:"3",min:"0",max:"50",showIf:"closed"},{label:"Monsters Count",ref:"count-Monsters",type:"number",value:"0",min:"0",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"2",min:"0",max:"50",showIf:"closed"}]),o=Object(i.a)(c,3),s=o[0],l=o[1],m=o[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create Mafia Setup | BeyondMafia"}),[]),r.a.createElement(Ke,{gameType:"Mafia",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[9],formFieldValueMods:{startState:[function(e){return"Day"==e}]},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Mafia",roles:e.roles,closed:e.closed,name:s[0].value,startState:s[1].value?"Day":"Night",dawn:s[2].value,whispers:s[3].value,leakPercentage:Number(s[4].value),lastWill:s[5].value,mustAct:s[6].value,noReveal:s[7].value,votesInvisible:s[8].value,unique:s[10].value,count:{Village:Number(s[11].value),Mafia:Number(s[12].value),Monsters:Number(s[13].value),Independent:Number(s[14].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}a(66);function et(e){var t=[{name:"Armed",text:"Starts with a gun.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Armed"})},{name:"Explosive",text:"Starts with a bomb.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Explosive"})},{name:"Armored",text:"Starts with armor.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Armored"})},{name:"Exposed",text:"Starts revealed to everyone.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Exposed"})},{name:"Lizard",text:"Appears as a Villager to investigative roles.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Lizard"})},{name:"Humble",text:"Appears as Villager to self with no modifier.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Humble"})},{name:"Lone",text:"Does not attend the Mafia or Monsters meeting.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Lone"})},{name:"Delayed",text:"Cannot attend secondary meetings for the first day and night.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Delayed"})},{name:"Even",text:"Can only attend secondary meetings on even days and nights.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Even"})},{name:"Odd",text:"Can only attend secondary meetings on odd days and nights.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Odd"})},{name:"One Shot",text:"Can only perform actions once.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-One-Shot"})}];return Object(n.useEffect)((function(){document.title="Learn Mafia | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Mafia is a game of social deception where an informed minority (the Mafia) compete against the uniformed majority (the Village). The Mafia choose one player to kill each night, and they win the game if they successfully outnumber the non-mafia players at any point. Everyone votes to execute one person during the day, with the Village aiming to eliminate all mafia members."),r.a.createElement("div",{className:"paragraph"},"In addition to the Village and the Mafia, there are two other alignments: Independent and Monsters. Independents are not aligned with a side and usually have their own unique win condition. Monsters meet together and win if they reach the majority just like the mafia, but they do not vote to kill someone each night."),r.a.createElement("div",{className:"paragraph"},"At the beginning of a game, each player is given a role. This role may grant the player special abilities, usually in the form of actions they can take to aid their side. A list of all roles and their abilities can be found below.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(ft,{gameType:"Mafia"}),r.a.createElement("div",{className:"heading"},"Items"),r.a.createElement(D,{panels:[{name:"Gun",text:"Can be shot once during the day to kill a specific player."},{name:"Armor",text:"Saves a player from being killed one time, not including being executed."},{name:"Bomb",text:"When a player is killed while holding a bomb, the player who killed them will also die."}]}),r.a.createElement("div",{className:"heading"},"Mechanics"),r.a.createElement(D,{panels:[{name:"Whispers",text:"Allow players to privately contact another player in the town meeting. If the whisper leaks then everyone will see it."},{name:"Last Wills",text:"Allow players to write a message that will be revealed when they die."},{name:"Must Act",text:"Players cannot select 'no one' for their actions."},{name:"No Reveal",text:"The roles of dead players are not revealed."},{name:"Closed Roles",text:"Roles for each alignment are randomly chosen from the pool of roles in the setup."},{name:"Dawn",text:"No actions can be taken the first night."},{name:"Full Moon",text:"When a Lycan or Werewolf is present in the game, full moons will occur on odd nights."},{name:"Eclipse",text:"Occurs during the day due to certain roles, making all votes and speech anonymous."}]}),r.a.createElement("div",{className:"heading"},"Modifiers"),r.a.createElement(D,{panels:t})))}function tt(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),s=Object(i.a)(o,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=we([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Voice Chat",ref:"voiceChat",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Initial Round Length (minutes)",ref:"initRoundLength",type:"number",value:3,min:1,max:5},{label:"Hostage Swap Length (minutes)",ref:"hostageSwapLength",type:"number",value:.5,min:.1,max:1,step:.1}]),v=Object(i.a)(h,2),g=v[0],y=v[1];function E(e){var t,a=Object(T.a)(g);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host Split Decision | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(ze,{gameType:"Split Decision",selSetup:a,setSelSetup:c,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[6].value;a.id?d.a.post("/game/host",{gameType:"Split Decision",setup:a.id,lobby:E("lobby"),private:E("private"),guests:E("guests"),ranked:E("ranked"),spectating:E("spectating"),voiceChat:E("voiceChat"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{"Initial Round":E("initialRoundLength"),"Hostage Swap":E("hostageSwapLength")}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function at(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),c=we([{label:"Setup Name",ref:"name",type:"text"},{label:"Initial Swap Amount",ref:"swapAmt",type:"number",value:"1",min:"1",max:"24"},{label:"Round Amount",ref:"aroundAmt",type:"number",value:3,min:2,max:10},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Blue Count",ref:"count-Blue",type:"number",value:"4",min:"1",max:"50",showIf:"closed"},{label:"Red Count",ref:"count-Red",type:"number",value:"4",min:"1",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"1",min:"0",max:"50",showIf:"closed"}]),o=Object(i.a)(c,3),s=o[0],l=o[1],m=o[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create Split Decision Setup | BeyondMafia"}),[]),r.a.createElement(Ke,{gameType:"Split Decision",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[5],formFieldValueMods:{},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Split Decision",roles:e.roles,closed:e.closed,name:s[0].value,startState:"Round",swapAmt:Number(s[1].value),roundAmt:Number(s[2].value),whispers:s[3].value,leakPercentage:Number(s[4].value),unique:s[6].value,count:{Red:Number(s[7].value),Blue:Number(s[8].value),Independent:Number(s[9].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function nt(e){return Object(n.useEffect)((function(){document.title="Learn Split Decision | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on the card game ",r.a.createElement("a",{href:"https://www.tuesdayknightgames.com/tworoomsandaboom",target:"_blank"},"2 Rooms and a Boom")," by Tudesday Knight Games."),r.a.createElement("div",{className:"paragraph"},"In Split Decision, all players are randomly a split among two rooms, as well as split among two teams: Red and Blue. One player is assigned the role of President, and another is the Bomber. The game plays over a series of rounds, and in each round each room will elect a leader. Those leaders will then meet together and choose one or more players (the hostages) to swap between the rooms for the next round."),r.a.createElement("div",{className:"paragraph"},"As the game progresses the rounds will get shorter and the number of players swapped between rooms will decrease. It is the goal of the Red team for the President and the Bomber to end up in the same room after the last round. It is the goal of the Blue team for them to end up in different rooms.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(ft,{gameType:"Split Decision"})))}function rt(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),s=Object(i.a)(o,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=we([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Voice Chat",ref:"voiceChat",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Team Selection Length (minutes)",ref:"teamSelLength",type:"number",value:2,min:1,max:5},{label:"Team Approval Length (minutes)",ref:"teamApprovalLength",type:"number",value:.5,min:.1,max:2,step:.1},{label:"Mission Length (minutes)",ref:"missionLength",type:"number",value:.5,min:.1,max:1,step:.1}]),v=Object(i.a)(h,2),g=v[0],y=v[1];function E(e){var t,a=Object(T.a)(g);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host Resistance | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(ze,{gameType:"Resistance",selSetup:a,setSelSetup:c,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[6].value;a.id?d.a.post("/game/host",{gameType:"Resistance",setup:a.id,lobby:E("lobby"),private:E("private"),guests:E("guests"),spectating:E("spectating"),voiceChat:E("voiceChat"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{"Team Selection":E("teamSelLength"),"Team Approval":E("teamApprovalLength"),Mission:E("missionLength")}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function ct(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),c=we([{label:"Setup Name",ref:"name",type:"text"},{label:"First Team Size",ref:"firstTeamSize",type:"number",value:"2",min:"2",max:"49"},{label:"Last Team Size",ref:"lastTeamSize",type:"number",value:"4",min:"2",max:"49"},{label:"Number of Missions",ref:"numMissions",type:"number",value:"5",min:"2",max:"10"},{label:"Team Formation Attempts",ref:"teamFailLimit",type:"number",value:"5",min:"1",max:"49"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Resistance Count",ref:"count-Resistance",type:"number",value:"3",min:"2",max:"49",showIf:"closed"},{label:"Spies Count",ref:"count-Spies",type:"number",value:"2",min:"1",max:"49",showIf:"closed"}]),o=Object(i.a)(c,3),s=o[0],l=o[1],m=o[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create Resistance Setup | BeyondMafia"}),[]),r.a.createElement(Ke,{gameType:"Resistance",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[7],formFieldValueMods:{},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Resistance",roles:e.roles,closed:e.closed,name:s[0].value,startState:"Team Selection",firstTeamSize:Number(s[1].value),lastTeamSize:Number(s[2].value),numMissions:Number(s[3].value),teamFailLimit:Number(s[4].value),whispers:s[5].value,leakPercentage:Number(s[6].value),unique:s[8].value,count:{Resistance:Number(s[9].value),Spies:Number(s[10].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function ot(e){return Object(n.useEffect)((function(){document.title="Learn Resistance | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on the card game ",r.a.createElement("a",{href:"https://www.boardgamegeek.com/boardgame/41114/resistance",target:"_blank"},"The Resistance")," by Don Eskridge."),r.a.createElement("div",{className:"paragraph"},"In Resistance, a group of rebels is trying to overthrow the government by completing a series of missions. However, the government has caught word of the plan and has recruited spies to inflitrate the resistance and sabotage the missions."),r.a.createElement("div",{className:"paragraph"},"At the beginning of each mission a player is selected as the leader and must recruit several group members to the team. All players vote on the selected team and if the majority approve then the mission will proceed. Otherwise, a new leader is chosen to make a new team. If several leaders are unable to form a team then that mission automatically fails."),r.a.createElement("div",{className:"paragraph"},"During a mission the members of the teams who are spies can choose to either make the mission succeed or fail. If at least one team member opts for it to fail then the entire mission will fail, otherwise it will succeed. The game continues until a certain number of missions succeed or fail, with the Resistance and the Spies winning respectively.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(ft,{gameType:"Resistance"})))}function st(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),s=Object(i.a)(o,2),l=s[0],m=s[1],f=Object(n.useContext)(N),p=I(),h=we([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:b.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Voice Chat",ref:"voiceChat",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Day Length (minutes)",ref:"dayLength",type:"number",value:10,min:1,max:30},{label:"Night Length (minutes)",ref:"nightLength",type:"number",value:2,min:1,max:10}]),v=Object(i.a)(h,2),g=v[0],y=v[1];function E(e){var t,a=Object(T.a)(g);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host One Night | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(ze,{gameType:"One Night",selSetup:a,setSelSetup:c,formFields:g,updateFormFields:y,onHostGame:function(){var e=g[6].value;a.id?d.a.post("/game/host",{gameType:"One Night",setup:a.id,lobby:E("lobby"),private:E("private"),guests:E("guests"),spectating:E("spectating"),voiceChat:E("voiceChat"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{Day:E("dayLength"),Night:E("nightLength")}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function it(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),c=we([{label:"Setup Name",ref:"name",type:"text"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Must Act",ref:"mustAct",type:"boolean"},{label:"Votes Invisible",ref:"votesInvisible",type:"boolean"},{label:"Excess Roles",ref:"excessRoles",type:"number",value:"3",min:"2",max:"10"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Village Count",ref:"count-Village",type:"number",value:"7",min:"0",max:"50",showIf:"closed"},{label:"Werewolves Count",ref:"count-Werewolves",type:"number",value:"0",min:"0",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"2",min:"0",max:"50",showIf:"closed"}]),o=Object(i.a)(c,3),s=o[0],l=o[1],m=o[2],f=Object(n.useContext)(N);return Object(n.useEffect)((function(){document.title="Create One Night Setup | BeyondMafia"}),[]),r.a.createElement(Ke,{gameType:"One Night",formFields:s,updateFormFields:l,resetFormFields:m,closedField:s[6],formFieldValueMods:{startState:[function(e){return"Day"==e}]},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"One Night",roles:e.roles,closed:e.closed,name:s[0].value,whispers:s[1].value,leakPercentage:Number(s[2].value),mustAct:s[3].value,votesInvisible:s[4].value,excessRoles:s[5].value,unique:s[7].value,count:{Village:Number(s[8].value),Werewolves:Number(s[9].value),Independent:Number(s[10].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(s[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function lt(e){return Object(n.useEffect)((function(){document.title="Learn One Night | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on ",r.a.createElement("a",{href:"https://beziergames.com/collections/one-night-ultimate-werewolf",target:"_blank"},"One Night Ultimate Werewolf")," by Bezier Games."),r.a.createElement("div",{className:"paragraph"},"One Night is a game of logical deduction similar to Mafia, but with only one Night and one Day phase."),r.a.createElement("div",{className:"paragraph"},"The Village side must kill one of the Werewolves to win, and Werewolves must kill one of the village. The Village also loses if there are no Werewolves present but they kill a Village member. The one night is typically eventful; the role you are given at the beginning of the night may not be the card you end up with. Actions will all take place at once at the end of the night. The order of events is given by times in the role descriptions.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(ft,{gameType:"One Night"})))}a(438);function ut(e){var t=Object(n.useContext)(O),a=Object(u.h)(),c=Object(u.g)(),o=new URLSearchParams(a.search),s="/play"==a.pathname,l=Object(n.useState)(o.get("game")||localStorage.getItem("gameType")||"Mafia"),m=Object(i.a)(l,2),d=m[0],f=m[1],p=[{text:"Play",path:"/play",exact:!0},{text:"Host",path:"/play/host",hide:!t.loggedIn},{text:"Create Setup",path:"/play/create",hide:!t.loggedIn},{text:"Learn",path:"/play/learn"}];return Object(n.useEffect)((function(){localStorage.setItem("gameType",d),s||o.get("edit")||o.get("game")==d||c.push(a.pathname+"?game=".concat(d))}),[a.pathname,d]),r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{links:p,showFilter:!s,filterSel:d,filterOptions:g,onFilter:function(e){f(e)},filterIcon:r.a.createElement("i",{className:"fas fa-gamepad"})}),r.a.createElement("div",{className:"inner-content play"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/play",render:function(){return r.a.createElement(He,null)}}),r.a.createElement(u.b,{exact:!0,path:"/play/host",render:function(){switch(d){case"Mafia":return r.a.createElement(Qe,null);case"Split Decision":return r.a.createElement(tt,null);case"Resistance":return r.a.createElement(rt,null);case"One Night":return r.a.createElement(st,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{exact:!0,path:"/play/create",render:function(){switch(d){case"Mafia":return r.a.createElement(Ze,null);case"Split Decision":return r.a.createElement(at,null);case"Resistance":return r.a.createElement(ct,null);case"One Night":return r.a.createElement(it,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{exact:!0,path:"/play/learn",render:function(){switch(d){case"Mafia":return r.a.createElement(et,null);case"Split Decision":return r.a.createElement(nt,null);case"Resistance":return r.a.createElement(ot,null);case"One Night":return r.a.createElement(lt,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/play"})}}))))}function mt(e){var t=e.sel.toLowerCase()==e.text.toLowerCase();return r.a.createElement("div",{className:"top-link ".concat(t?"active":""),onClick:e.onClick},e.text)}function dt(e){var t,a,c=Object(n.useRef)(),o=Object(n.useContext)(j);if("string"==typeof e.role?(t=e.role.split(":")[0],a=e.role.split(":")[1]):e.role&&(t=e.role.name,a=e.role.modifier),e.closed)return e.count>0||e.hideCount?r.a.createElement("div",{className:"role-count-wrap"},r.a.createElement("i",{className:"fas fa-question i-".concat(e.alignment),onClick:e.onClick}),!e.hideCount&&r.a.createElement("div",{className:"super"},e.count)):r.a.createElement(r.a.Fragment,null);var s=t?"".concat(q(e.gameType),"-").concat(q(t)):"null";return r.a.createElement("div",{className:"role-count-wrap"},r.a.createElement("div",{className:"role role-".concat(s," ").concat(e.small?"small":""," ").concat(e.bg?"bg":""),title:"".concat(t||""," ").concat(a?"(".concat(a,")"):""),onClick:function(){e.onClick&&e.onClick(),t&&e.showPopover&&o.onClick("/roles/".concat(e.gameType,"/").concat(t),"role",c.current,t)},ref:c},a&&r.a.createElement("div",{className:"modifier modifier-".concat(e.gameType,"-").concat(q(a))})),e.count>0&&r.a.createElement("div",{className:"super"},e.count))}function ft(e){var t=Object(n.useState)(y[e.gameType][0]),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1],d=Object(n.useRef)([]),f=(I(),Object(n.useContext)(O)),p=Object(n.useContext)(N),h=Object(n.useContext)(j);var v=y[e.gameType].map((function(e){return r.a.createElement(mt,{text:e,sel:c,onClick:function(){return t=e,m(""),void o(t);var t},key:e})}));if(!p.roles)return r.a.createElement(oe,{className:"roles-loading"});var g=p.roles[e.gameType].map((function(t,a){if(t.alignment==c||u.length>0&&-1!=t.name.toLowerCase().indexOf(u))return r.a.createElement("div",{className:"role-cell",key:t.name},f.loggedIn&&e.onAddClick&&r.a.createElement("i",{className:"add-role fa-plus-circle fas",onClick:function(a){a.stopPropagation(),e.onAddClick(t)}}),r.a.createElement("div",{className:"role-cell-content",onClick:function(){return function(t,a){h.onClick("/roles/".concat(e.gameType,"/").concat(a.name),"role",t,a.name)}(d.current[a],t)},ref:function(e){return d.current[a]=e}},r.a.createElement(dt,{role:t.name,gameType:e.gameType}),t.name))}));return r.a.createElement("div",{className:"role-list-container"},r.a.createElement("div",{className:"top-bar"},v,r.a.createElement(ee,{value:u,placeholder:"Role Name",onInput:function(t){m(t.toLowerCase()),""!=t&&c.length>0?o(""):""==t&&0==c.length&&o(y[e.gameType][0])}})),r.a.createElement("div",{className:"role-list"},g))}a(439),a(440);function pt(e){var t,a,c=Object(n.useContext)(O),o=Object(n.useContext)(j),s=Object(n.useRef)(),i=e.maxRolesCount||5,l=!1;if("string"==typeof e.setup.roles&&(e.setup.roles=JSON.parse(e.setup.roles)),e.setup.closed){t=[];var u,m=Object(T.a)(y[e.setup.gameType]);try{for(m.s();!(u=m.n()).done;){var d=u.value;t.push(r.a.createElement(dt,{closed:!0,alignment:d,count:e.setup.count[d],gameType:e.setup.gameType,key:d}))}}catch(p){m.e(p)}finally{m.f()}}else{var f=Object.keys(e.setup.roles[0]);a=e.setup.roles.length>1,(t=f.map((function(t){return r.a.createElement(dt,{small:!0,role:t,count:e.setup.roles[0][t],gameType:e.setup.gameType,key:t})}))).length>i&&(t=t.slice(0,i),l=!0)}return r.a.createElement("div",{className:"setup",ref:s,onClick:function(){o.onClick("/setup/".concat(e.setup.id),"setup",s.current,G(e.setup.name,c.settings),(function(e){return e.roles=JSON.parse(e.roles)}))}},r.a.createElement(vt,{gameType:e.setup.gameType}),a&&r.a.createElement("i",{className:"multi-setup-icon fas fa-list-alt"}),t,l&&r.a.createElement("i",{className:"fas fa-ellipsis-h"}))}function ht(e){var t;return t=Array.isArray(e.roles)?e.roles.map((function(t){return r.a.createElement(dt,{small:!0,role:t,key:t,gameType:e.gameType})})):Object.keys(e.roles).map((function(t){return r.a.createElement(dt,{role:t,count:e.roles[t],small:!0,gameType:e.gameType,key:t})})),r.a.createElement("div",{className:"small-role-list"},t)}function vt(e){var t=q(e.gameType);return r.a.createElement("div",{className:"game-icon ".concat(t)})}function gt(e){var t;return"Day"==e.state?t="sun":"Night"==e.state&&(t="moon"),r.a.createElement("i",{className:"fa-".concat(t," fas state-icon")})}var bt=a(33),yt=a(20),Et=a(14),wt=a(15),Ot=a(8),Nt=a(9),jt=function(e){Object(Et.a)(a,e);var t=Object(wt.a)(a);function a(e,n){var r;return Object(Ot.a)(this,a),(r=t.call(this,new WebSocket(e))).path=e,r.persistent=n,r.configurePing(),r.configureClose(),r}return Object(Nt.a)(a,[{key:"reconnect",value:function(){Object(bt.a)(Object(yt.a)(a.prototype),"setSocket",this).call(this,new WebSocket(this.path)),this.heartbeat(),this.configureClose()}},{key:"configurePing",value:function(){var e=this;this.heartbeat(),this.on("p",(function(){return e.heartbeat()}))}},{key:"heartbeat",value:function(){var e=this;clearTimeout(this.pingTimeout),this.send("p"),this.pingTimeout=setTimeout((function(){e.socket.close()}),11e3)}},{key:"configureClose",value:function(){var e=this;this.socket.addEventListener("close",(function(){e.persistent&&e.reconnect()}))}},{key:"clear",value:function(){clearTimeout(this.pingTimeout),this.persistent=!1,this.listeners={},this.sendQueue=[],this.socket&&this.socket.close(),this.socket=null}}]),a}(function(){function e(t){Object(Ot.a)(this,e),this.listeners={},this.sendQueue=[],this.received=[],this.setSocket(t)}return Object(Nt.a)(e,[{key:"setSocket",value:function(e){var t=this;this.socket=e,this.configureListeners(),this.socket.addEventListener("open",(function(){t.received=[];var e,a=Object(T.a)(t.sendQueue);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.socket.send(n)}}catch(r){a.e(r)}finally{a.f()}})),this.socket.addEventListener("close",(function(){t.triggerEvent("disconnected")})),this.socket.addEventListener("error",(function(){t.terminate()}))}},{key:"configureListeners",value:function(){var e=this;this.socket.addEventListener("message",(function(t){var a=function(e){var t=e.split(/:([\s\S]*)/),a=t[0];if(t.length<2)return[a];if((t=t[1].split(/:([\s\S]*)/)).length<2)return;var n=t[0],r=t[1];switch(n){case"number":r=Number(r);break;case"boolean":r="false"!=r;break;case"object":try{r=JSON.parse(r)}catch(c){return}}return[a,r]}(t.data),n=Object(i.a)(a,2),r=n[0],c=n[1];e.triggerEvent(r,c),e.received.push({eventName:r,data:c})}))}},{key:"triggerEvent",value:function(e,t){var a=this.listeners[e];if(a)for(var n=0;n<a.length;n++)a[n](t)}},{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),t=t.bind(this),this.listeners[e].push(t);var a,n=Object(T.a)(this.received);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.eventName==e&&t(r.data)}}catch(c){n.e(c)}finally{n.f()}}},{key:"send",value:function(e,t){var a=function(e,t){var a=typeof t;if("undefined"==a)return e;"object"==a?t=JSON.stringify(t):"string"!=a&&(t=String(t));return"".concat(e,":").concat(a,":").concat(t)}(e,t);0==this.socket.readyState?this.sendQueue.push(a):1==this.socket.readyState&&this.socket.send(a)}},{key:"clearListeners",value:function(){var e={};e.p=this.listeners.p,this.listeners=e}},{key:"terminate",value:function(){this.socket.close()}},{key:"readyState",get:function(){return this.socket?this.socket.readyState:3}}]),e}());a(441);function kt(){kt=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var c=t&&t.prototype instanceof d?t:d,o=Object.create(c.prototype),s=new k(r||[]);return n(o,"_invoke",{value:w(e,a,s)}),o}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,c,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,c)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,c){function o(){return new t((function(r,o){!function n(r,c,o,s){var i=u(e[r],e,c);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(m).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(i.arg)}(n,c,r,o)}))}return r=r?r.then(o,o):o()}})}function w(e,t,a){var n="suspendedStart";return function(r,c){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw c;return C()}for(a.method=r,a.arg=c;;){var o=a.delegate;if(o){var s=O(o,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var c=r.arg;return c?c.done?(t[e.resultName]=c.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):c:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,c){void 0===c&&(c=Promise);var o=new E(l(t,a,n,r),c);return e.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(b),i(b,s,"Generator"),i(b,c,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return o.type="throw",o.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r],o=c.completion;if("root"===c.tryLoc)return n("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),i=a.call(c,"finallyLoc");if(s&&i){if(this.prev<c.catchLoc)return n(c.catchLoc,!0);if(this.prev<c.finallyLoc)return n(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return n(c.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return n(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var c=r;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=t&&t<=c.finallyLoc&&(c=null);var o=c?c.completion:{};return o.type=e,o.arg=t,c?(this.method="next",this.next=c.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function St(){return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/game/:gameId",render:function(e){return r.a.createElement(Ct,{key:e.match.params.gameId})}}),r.a.createElement(u.b,{exact:!0,path:"/game/:gameId/review",render:function(){return r.a.createElement(Ct,{review:!0})}}),r.a.createElement(u.a,{to:"/play"}))}function Ct(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),m=Object(i.a)(s,2),f=m[0],g=m[1],b=Object(n.useState)(!1),y=Object(i.a)(b,2),E=y[0],w=y[1],O=Object(n.useState)(),S=Object(i.a)(O,2),C=S[0],x=S[1],L=Object(n.useState)(),A=Object(i.a)(L,2),M=A[0],R=A[1],P=Object(n.useState)(),F=Object(i.a)(P,2),D=F[0],B=F[1],V=Object(n.useState)({}),U=Object(i.a)(V,2),G=U[0],_=U[1],W=Object(n.useState)(0),$=Object(i.a)(W,2),H=$[0],q=$[1],Y=Object(n.useState)(),z=Object(i.a)(Y,2),J=z[0],Q=z[1],K=Object(n.useState)({}),X=Object(i.a)(K,2),Z=X[0],ee=X[1],ae=Object(n.useState)({}),re=Object(i.a)(ae,2),ce=re[0],me=re[1],de=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"set":var n=Object.keys(t.history).sort((function(e,t){return e-t}));a={states:t.history},-2==n[0]?a.currentState=-2:a.currentState=n[n.length-1];break;case"addState":var r;e.states[t.state.id]?a=e:(r=-2!=t.state.id?t.state.id-1:Object.keys(e.states).sort((function(e,t){return t-e}))[0],a=p()(e,{states:Object(v.a)({},t.state.id,{$set:{name:t.state.name,meetings:{},alerts:[],stateEvents:[],roles:Object(h.a)({},e.states[r].roles),dead:Object(h.a)({},e.states[r].dead)}}),currentState:{$set:t.state.id}}));break;case"addMeeting":(o=e.states[e.currentState])&&(o.meetings||(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:{$set:{}}})})),a=p()(a||e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.meeting.id,{$set:t.meeting})})}));break;case"meetingMembers":e.states[e.currentState]&&e.states[e.currentState].meetings[t.meetingId]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.meetingId,{members:{$set:t.members}})})}));break;case"removeMeeting":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:{$unset:[t.meetingId]}})})).states[e.currentState].selTab==t.meetingId&&(a=p()(a,{states:Object(v.a)({},e.currentState,{$unset:["selTab"]})}));break;case"addMessage":e.states[e.currentState]&&(t.message.meetingId?e.states[e.currentState].meetings[t.message.meetingId]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.message.meetingId,{messages:{$push:[t.message]}})})})):a=p()(e,{states:Object(v.a)({},e.currentState,{alerts:{$push:[t.message]}})}));break;case"addQuote":e.states[e.currentState]&&e.states[e.currentState].meetings[t.quote.toMeetingId]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.quote.toMeetingId,{messages:{$push:[t.quote]}})})}));break;case"vote":var c=t.vote.target;(s=(o=e.states[e.currentState])&&o.meetings[t.vote.meetingId])&&(s.multi&&(c=[].concat(Object(te.a)(s.votes[t.vote.voterId]||[]),[c])),a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.vote.meetingId,{votes:Object(v.a)({},t.vote.voterId,{$set:c})})})}),t.vote.noLog||(a=p()(a,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.vote.meetingId,{voteRecord:{$push:[{type:"vote",voterId:t.vote.voterId,target:t.vote.target,time:Date.now()}]}})})})));break;case"unvote":var o,s;c=void 0,(s=(o=e.states[e.currentState])&&o.meetings[t.info.meetingId])&&(s.multi&&(c=(s.votes[t.info.voterId]||[]).filter((function(e){return e!=t.info.target}))),a=p()(e,{states:Object(v.a)({},e.currentState,{meetings:Object(v.a)({},t.info.meetingId,{votes:Object(v.a)({},t.info.voterId,{$set:c}),voteRecord:{$push:[{type:"unvote",voterId:t.info.voterId,time:Date.now()}]}})})}));break;case"stateEvents":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{stateEvents:{$set:t.stateEvents}})}));break;case"selTab":e.states[t.state]&&(a=p()(e,{states:Object(v.a)({},t.state,{selTab:{$set:t.meetingId}})}));break;case"reveal":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{roles:Object(v.a)({},t.playerId,{$set:t.role})})}));break;case"death":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{dead:Object(v.a)({},t.playerId,{$set:!0})})}));break;case"revival":e.states[e.currentState]&&(a=p()(e,{states:Object(v.a)({},e.currentState,{dead:Object(v.a)({},t.playerId,{$set:!1})})}))}return a||e}),{states:{}}),fe=Object(i.a)(de,2),pe=fe[0],he=fe[1],ve=function(e){return Object(n.useReducer)((function(t,a){var n;switch(a.type){case"backward":n=t>-2?t-1:Math.max.apply(Math,Object(te.a)(Object.keys(e.states)));break;case"forward":n=e.states[t+1]?t+1:-2;break;case"current":n=e.currentState;break;case"first":n=-1;break;default:n=t}return e.states[n]?n:t}),e.currentState)}(pe),ge=Object(i.a)(ve,2),be=ge[0],ye=ge[1],Ee=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"set":a=t.players;break;case"add":a=e[t.player.id]?p()(e,Object(v.a)({},t.player.id,{$unset:["left"]})):p()(e,Object(v.a)({},t.player.id,{$set:t.player}));break;case"remove":a=p()(e,Object(v.a)({},t.playerId,{left:{$set:!0}}));break;case"setProp":a=p()(e,Object(v.a)({},t.playerId,Object(v.a)({},t.propName,{$set:t.propVal})))}return a||e}),{}),we=Object(i.a)(Ee,2),Oe=we[0],Ne=we[1],je=Object(n.useState)(0),ke=Object(i.a)(je,2),Se=ke[0],Ce=ke[1],xe=Object(n.useState)(!1),Ie=Object(i.a)(xe,2),Te=Ie[0],Le=Ie[1],Ae=Object(n.useState)(),Me=Object(i.a)(Ae,2),Re=Me[0],Pe=Me[1],Fe=Object(n.useState)(""),De=Object(i.a)(Fe,2),Be=De[0],Ve=De[1],Ue=Object(n.useReducer)((function(e,t){var a=Object(h.a)({},e);switch(t.type){case"create":a[t.timer.name]={delay:t.timer.delay,time:0};break;case"clear":delete a[t.name];break;case"update":a[t.name].time=t.time;break;case"updateAll":for(var n in a)a[n].time+=1e3;var r=a.pregameCountdown||a.secondary||a.main;if(!r)break;var c=Math.round((r.delay-r.time)/1e3);c<6&&c>0&&t.playAudio("tick")}return a}),{}),Ge=Object(i.a)(Ue,2),_e=Ge[0],We=Ge[1],$e=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"load":try{a=window.localStorage.getItem("gameSettings"),a=JSON.parse(a)}catch(n){a=e}break;case"set":a=t.settings,window.localStorage.setItem("gameSettings",JSON.stringify(a));break;case"setProp":a=p()(e,Object(v.a)({},t.propName,{$set:t.propval})),window.localStorage.setItem("gameSettings",JSON.stringify(a))}return a||e}),{votingLog:!1,timestamps:!0,sounds:!0,volume:1}),He=Object(i.a)($e,2),qe=He[0],Ye=He[1],ze=Object(n.useState)(!1),Je=Object(i.a)(ze,2),Qe=Je[0],Ke=Je[1],Xe=Object(n.useState)(!1),Ze=Object(i.a)(Xe,2),et=Ze[0],tt=Ze[1],at=Object(n.useState)({from:"",contains:""}),nt=Object(i.a)(at,2),rt=nt[0],ct=nt[1],ot=Object(n.useState)(),st=Object(i.a)(ot,2),it=st[0],lt=st[1],ut=Object(n.useState)(!1),mt=Object(i.a)(ut,2),dt=mt[0],ft=mt[1],pt=Object(n.useState)(!1),ht=Object(i.a)(pt,2),vt=ht[0],gt=ht[1],bt=Object(n.useState)(),yt=Object(i.a)(bt,2),Et=yt[0],wt=yt[1],Ot=Object(n.useState)(!1),Nt=Object(i.a)(Ot,2),St=Nt[0],Ct=Nt[1],xt=Object(n.useRef)(),It=Object(n.useRef)(),Tt=Object(n.useRef)(),Lt=Object(n.useRef)(),At=function(e,t){var a=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"typing":a=p()(e,{typing:Object(v.a)({},t.playerId,{$set:t.meetingId})});break;case"speaking":var n=t.players.reduce((function(e,t){return e[t]=!0,e}),{});a=p()(e,{speaking:{$set:n}})}return a||e}),{typing:{},speaking:{}}),r=Object(i.a)(a,2),c=r[0],o=r[1];return Object(n.useEffect)((function(){var a=setInterval((function(){if(e.current){var a=[];t.current&&t.current.getVolumeLevel()>.001&&(a.push(e.current.uid),console.log(t.current.getVolumeLevel())),e.current.remoteUsers.forEach((function(e){e.audioTrack&&e.audioTrack.getVolumeLevel()>.001&&a.push(e.uid)})),o({type:"speaking",players:a})}}),50);return function(){return clearInterval(a)}})),[c,o]}(Tt,Lt),Mt=Object(i.a)(At,2),Rt=Mt[0],Pt=Mt[1],Ft=function(e){var t=Object(n.useRef)({}),a=Object(n.useReducer)((function(a,n){var r;switch(n.type){case"play":if(!e.sounds)return a;if(a.overrides[n.audioName])for(var c in a.overrides)a.overrides[c]&&t.current[c]&&t.current[c].pause();t.current[n.audioName]&&(t.current[n.audioName].currentTime=0,t.current[n.audioName].play().catch((function(e){})));break;case"load":for(var o in r={overrides:Object(h.a)({},a.overrides),volumes:Object(h.a)({},a.volumes)},n.files){var s=n.files[o];t.current[s]||(t.current[s]=new Audio("/audio/".concat(s,".mp3")),t.current[s].load(),t.current[s].loop=n.loops[o]),r.overrides[s]=n.overrides[o],r.volumes[s]=n.volumes[o]}break;case"volume":for(var i in t.current)a.volumes[i]&&(t.current[i].volume=a.volumes[i]*n.volume)}return r||a}),{overrides:{},volumes:{}}),r=Object(i.a)(a,2),c=r[0],o=r[1];return Object(n.useEffect)((function(){o({type:"volume",volume:e.volume})}),[e.volume,c]),[function(e){o({type:"play",audioName:e})},function(e,t,a,n){o({type:"load",files:e,loops:t,overrides:a,volumes:n})},function(){for(var e in t.current)t.current[e].pause()},function(e){var a,n=Object(T.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;t.current[r].pause()}}catch(c){n.e(c)}finally{n.f()}},function(e){o({type:"volume",volume:e})}]}(qe),Dt=Object(i.a)(Ft,5),Bt=Dt[0],Vt=Dt[1],Ut=Dt[2],Gt=Dt[3],_t=(Dt[4],Object(n.useContext)(N)),Wt=(Object(n.useContext)(j),I()),$t=Object(u.i)().gameId,Ht=["bell","ping","tick"],qt=[!1,!1,!1],Jt=[!1,!1,!1],Qt=[1,1,1];function Xt(){Tt.current||(Tt.current=ne.a.createClient({mode:"rtc",codec:"vp8"}),Tt.current.on("user-published",function(){var e=Object(l.a)(kt().mark((function e(t,a){return kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("audio"==a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Tt.current.subscribe(t,a);case 4:vt&&t.audioTrack.setVolume(0),t.audioTrack.play();case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Tt.current.on("user-unpublished",(function(e){var t=document.getElementById(e.uid);t&&t.remove()})))}function Zt(){return(Zt=Object(l.a)(kt().mark((function e(t,a){return kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Tt.current){e.next=5;break}Xt(),e.next=7;break;case 5:return e.next=7,ea();case 7:return e.next=9,Tt.current.join("f366ac8a8daa4be5bd04700e89b5e1ac",t,a,Re);case 9:if(Lt.current){e.next=14;break}return e.next=12,ne.a.createMicrophoneAudioTrack();case 12:Lt.current=e.sent,dt&&Lt.current.setVolume(0);case 14:return e.next=16,Tt.current.publish([Lt.current]);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function ea(){return ta.apply(this,arguments)}function ta(){return(ta=Object(l.a)(kt().mark((function e(){return kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Tt.current){e.next=2;break}return e.abrupt("return");case 2:return Tt.current.remoteUsers.forEach((function(e){var t=document.getElementById(e.uid);t&&t.remove()})),e.next=5,Tt.current.leave();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(Object(n.useEffect)((function(){if(null!=D){var e;e="".concat("wss","://").concat("ujwcbfwxrqnp.beyondmafia.com","/").concat(C);var t=new jt(e);return t.on("connected",(function(){return q(H+1)})),t.on("disconnected",(function(){return q(H-1)})),_(t),function(){t&&t.clear()}}}),[D]),Object(n.useEffect)((function(){E&&(G.clear(),_({send:function(){}}))}),[E]),Object(n.useEffect)((function(){if(Ye({type:"load"}),!e.review){var t=function(){var e=document.getElementById("speechInput"),t=document.activeElement.tagName;e&&"INPUT"!=t&&"TEXTAREA"!=t&&e.focus()};document.title="Game ".concat($t," | BeyondMafia"),Vt(Ht,qt,Jt,Qt),function(){Kt.apply(this,arguments)}();var a=setInterval((function(){We({type:"updateAll",playAudio:Bt})}),1e3);return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t),clearInterval(a),Ut(),ea(),Lt.current&&Lt.current.close()}}document.title="Review Game ".concat($t," | BeyondMafia"),d.a.get("/game/".concat($t,"/review/data")).then((function(e){var t=e.data;if(t.broken)return g(!0),void Wt("Game not found.");R(t.type),Q(t.setup),ee({ranked:t.ranked,spectating:t.spectating,private:!1}),he({type:"set",history:JSON.parse(t.history)});var a={};for(var n in t.players)a[t.players[n]]={id:t.players[n],name:t.names[n],userId:t.users[n]?t.users[n].id:"",avatar:!!t.users[n]&&t.users[n].avatar,textColor:t.users[n]&&t.users[n].settings.textColor,nameColor:t.users[n]&&t.users[n].settings.nameColor,left:-1!=t.left.indexOf(t.players[n])};Ne({type:"set",players:a}),o(!0)})).catch((function(e){g(!0),Wt(e)}))}),[]),Object(n.useEffect)((function(){It.current=Re}),[Re]),Object(n.useEffect)((function(){null==be&&ye({type:"current"})}),[pe.currentState]),Object(n.useEffect)((function(){xt.current=Oe}),[Oe]),Object(n.useEffect)((function(){if(Z.voiceChat&&!e.review)if(it){var t=pe.states[pe.currentState],a=t&&t.meetings[it],n=a&&a.vcToken;n&&function(e,t){Zt.apply(this,arguments)}(it,n)}else ea()}),[it]),Object(n.useEffect)((function(){1==G.readyState?(D?G.send("auth",D):G.send("join",{gameId:$t,guestId:window.localStorage.getItem("cacheVal")}),G.on("authSuccess",(function(){G.send("join",{gameId:$t,isBot:"?bot"==window.location.search})})),G.on("loaded",(function(){o(!0)})),G.on("setup",(function(e){Q(e)})),G.on("options",(function(e){ee(e)})),G.on("emojis",(function(e){me(e)})),G.on("state",(function(e){he({type:"addState",state:e})})),G.on("history",(function(e){he({type:"set",history:e})})),G.on("players",(function(e){Ne({type:"set",players:e})})),G.on("playerJoin",(function(e){Ne({type:"add",player:e})})),G.on("playerLeave",(function(e){Ne({type:"remove",playerId:e})})),G.on("spectatorCount",(function(e){Ce(e)})),G.on("self",(function(e){Pe(e)})),G.on("reveal",(function(e){he({type:"reveal",playerId:e.playerId,role:e.role})})),G.on("death",(function(e){he({type:"death",playerId:e})})),G.on("revival",(function(e){he({type:"revival",playerId:e})})),G.on("meeting",(function(e){he({type:"addMeeting",meeting:e})})),G.on("members",(function(e){he({type:"meetingMembers",meetingId:e.meetingId,members:e.members})})),G.on("leftMeeting",(function(e){he({type:"removeMeeting",meetingId:e})})),G.on("stateEvents",(function(e){he({type:"stateEvents",stateEvents:e})})),G.on("message",(function(e){he({type:"addMessage",message:e});var t=e.content.match(/@[\w-]*/gm)||[];It.current&&xt.current[It.current]&&(-1!=t.indexOf("@"+xt.current[It.current].name)||-1!=t.indexOf("@everyone"))&&Bt("ping")})),G.on("quote",(function(e){he({type:"addQuote",quote:e})})),G.on("vote",(function(e){he({type:"vote",vote:e})})),G.on("unvote",(function(e){he({type:"unvote",info:e})})),G.on("lastWill",(function(e){Ve(e)})),G.on("firstGame",(function(){tt(!0)})),G.on("timerInfo",(function(e){We({type:"create",timer:e}),"pregameCountdown"==e.name&&Notification&&"granted"==Notification.permission&&!document.hasFocus()&&new Notification("Your game is starting!")})),G.on("clearTimer",(function(e){We({type:"clear",name:e})})),G.on("time",(function(e){We({type:"update",name:e.name,time:e.time})})),G.on("typing",(function(e){Pt({type:"typing",playerId:e.playerId,meetingId:e.meetingId})})),G.on("isSpectator",(function(){Le(!0)})),G.on("left",(function(){g(!0),_t.hideAllAlerts()})),G.on("finished",(function(){w(!0)})),G.on("error",(function(e){g(!0),Wt(e)})),G.on("dev",(function(){Ct(!0)}))):null!=G.readyState&&3!=G.readyState||f||E||e.review||d.a.get("/game/".concat($t,"/connect")).then((function(e){R(e.data.type),x(e.data.port),B(e.data.token||!1)})).catch((function(e){g(!0),Wt(e)}))}),[H]),f)return r.a.createElement(u.a,{to:"/play"});if(Et)return r.a.createElement(u.a,{to:"/game/".concat(Et)});if(c&&null!=be){var aa={socket:G,review:e.review,setup:J,history:pe,updateHistory:he,stateViewing:be,updateStateViewing:ye,self:Re,isSpectator:Te,players:Oe,updatePlayers:Ne,timers:_e,options:Z,spectatorCount:Se,lastWill:Be,emojis:ce,setLeave:g,finished:E,settings:qe,updateSettings:Ye,setShowSettingsModal:Ke,speechFilters:rt,setSpeechFilters:ct,loadAudioFiles:Vt,playAudio:Bt,stopAudio:Ut,stopAudios:Gt,setRehostId:wt,agoraClient:Tt,localAudioTrack:Lt,setActiveVoiceChannel:lt,activity:Rt,muted:dt,setMuted:ft,deafened:vt,setDeafened:gt,dev:St};return r.a.createElement(k.Provider,{value:aa},r.a.createElement("div",{className:"game no-highlight"},r.a.createElement(Yt,{showModal:Qe,setShowModal:Ke,settings:qe,updateSettings:Ye}),r.a.createElement(zt,{showModal:et,setShowModal:tt}),"Mafia"==M&&r.a.createElement(se,null),"Resistance"==M&&r.a.createElement(le,null),"Split Decision"==M&&r.a.createElement(ie,null),"One Night"==M&&r.a.createElement(ue,null)))}return r.a.createElement("div",{className:"game"},r.a.createElement(oe,null))}function xt(e,t){Object(n.useEffect)((function(){t.on&&e(t)}),[t])}function It(e){var t=Object(u.i)().gameId,a=Object(n.useRef)(),c=I(),o=Object(n.useContext)(N),s=Object(n.useContext)(j);return r.a.createElement("div",{className:"top"},r.a.createElement("div",{className:"game-name-wrapper"},e.gameName),r.a.createElement("div",{className:"state-wrapper"},r.a.createElement(Pt,{history:e.history,stateViewing:e.stateViewing,updateStateViewing:e.updateStateViewing}),e.timer),r.a.createElement("div",{className:"misc-wrapper"},r.a.createElement("div",{className:"misc-left"},r.a.createElement("div",{className:"misc-buttons"},e.options.voiceChat&&r.a.createElement("i",{className:"misc-icon fas fa-microphone"}),r.a.createElement("i",{className:"misc-icon fas fa-info-circle",ref:a,onClick:function(e){e.stopPropagation(),s.onClick("/game/".concat(t,"/info"),"game",a.current,"Game ".concat(t))}}),r.a.createElement("i",{className:"misc-icon fas fa-cog",onClick:function(){e.setShowSettingsModal(!0)}}),e.dev&&r.a.createElement("i",{className:"misc-icon fas fa-vial",onClick:function(){for(var t=0;t<e.setup.total-1;t++)window.open(window.location+"?bot")}})),r.a.createElement("div",{className:"options"},!e.options.private&&!e.review&&r.a.createElement("i",{className:"fas fa-lock-open"}),e.options.private&&!e.review&&r.a.createElement("i",{className:"fas fa-lock"}),!e.review&&r.a.createElement("div",{className:"player-count"},r.a.createElement("i",{className:"fas fa-users"}),Object.values(e.players).filter((function(e){return!e.left})).length," / ",e.setup.total),!e.options.spectating&&!e.review&&r.a.createElement("div",{className:"no-spectator"},r.a.createElement("i",{className:"fas fa-eye-slash"})),e.options.spectating&&!e.review&&r.a.createElement("div",{className:"spectator-count"},r.a.createElement("i",{className:"fas fa-eye"}),e.spectatorCount))),e.setup&&r.a.createElement(pt,{setup:e.setup}),r.a.createElement("div",{className:"btn btn-theme leave-game",onClick:function(){(e.finished||e.review||window.confirm("Are you sure you wish to leave?"))&&(e.finished&&o.hideAllAlerts(),e.socket.on?e.socket.send("leave"):e.setLeave(!0))}},"Leave"),!e.review&&-2==e.history.currentState&&r.a.createElement("div",{className:"btn btn-theme-sec rehost-game",onClick:function(){var a={};for(var n in e.options.stateLengths)a[n]=e.options.stateLengths[n]/6e4;d.a.post("/game/host",Object(h.a)({rehost:t,gameType:e.gameType,setup:e.setup.id,lobby:e.options.lobby,private:e.options.private,spectating:e.options.spectating,guests:e.options.guests,ranked:e.options.ranked,stateLengths:a},e.options.gameTypeOptions)).then((function(t){return e.setRehostId(t.data)})).catch(c)}},"Rehost")))}function Tt(e){return r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"left-panel panel"},e.leftPanelContent),r.a.createElement("div",{className:"center-panel panel"},e.centerPanelContent),r.a.createElement("div",{className:"right-panel panel"},e.rightPanelContent))}function Lt(e){var t=e.history,a=e.players,c=e.stateViewing,o=e.updateHistory,s=e.setActiveVoiceChannel,l=t.states[c],u=l?l.meetings:{},m=l?l.alerts:[],d=l&&l.selTab,f=Object(n.useState)(!0),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(!1),b=Object(i.a)(g,2),y=b[0],E=b[1],w=Object(n.useRef)(),O=Object.values(u).filter((function(e){return e.speech}));function N(){h&&w.current&&(w.current.scrollTop=w.current.scrollHeight)}function j(a){e.review||"server"==a.senderId||a.isQuote||!a.quotable||e.socket.send("quote",{messageId:a.id,toMeetingId:t.states[t.currentState].selTab,fromMeetingId:a.meetingId,fromState:c})}Object(n.useLayoutEffect)((function(){return N()})),Object(n.useEffect)((function(){null!=c&&!d&&O.length&&o({type:"selTab",state:c,meetingId:O[0].id})}),[c,O]),Object(n.useEffect)((function(){c==t.currentState?v(!0):v(!1)}),[c]),Object(n.useEffect)((function(){function e(){E(!0),document.removeEventListener("mousemove",e)}return document.addEventListener("mousemove",e),function(){return document.removeEventListener("mousemove",e)}}),[]),Object(n.useEffect)((function(){d&&u[d]&&u[d].vcToken||s(null),s(d)}),[d,u]);var k=O.map((function(e){return r.a.createElement("div",{className:"tab ".concat(d==e.id?"sel":""),key:e.id,onClick:function(){return t=e.id,o({type:"selTab",state:c,meetingId:t}),void v(!0);var t}},e.name)})),S=function(e,t,a,n,r,c){var o;o=a?Object(te.a)(e[a].messages):[];c&&(c.from||c.contains)&&(o=o.filter((function(e){var t=-1!=(e.content||"").toLowerCase().indexOf(c.contains.toLowerCase()),a=n[e.senderId].name;return t=t&&-1!=a.toLowerCase().indexOf(c.from.toLowerCase())})));var s,i,l=Object(T.a)(t);try{for(l.s();!(s=l.n()).done;)for(var u=s.value,m=0;m<=o.length;m++){if(m==o.length){o.push(u);break}if(u.time<o[m].time){o.splice(m,0,u);break}}}catch(O){l.e(O)}finally{l.f()}if(!r.votingLog)return o;i=a?e[a].voteRecord:[];for(var d in e)e[d].speech||(i=i.concat(e[d].voteRecord));var f,p=Object(T.a)(i);try{for(p.s();!(f=p.n()).done;){var h=f.value,v="unvote"==h.type,g=n[h.voterId],b=g?g.name:"Anonymous",y=h.target;v||("*"!=y&&n[y]?y=n[y].name:"*"==y&&(y="no one"));for(var E={senderId:"vote",content:"".concat(b," ").concat(v?"unvotes":"votes"," ").concat(v?"":y),time:h.time},w=0;w<=o.length;w++){if(w==o.length){o.push(E);break}if(h.time<o[w].time){o.splice(w,0,E);break}}}}catch(O){p.e(O)}finally{p.f()}return o}(u,m,d,a,e.settings,e.filters);S=S.map((function(n,c){return r.a.createElement(At,{message:n,history:t,players:a,key:n.id||n.messageId+n.time||c,onMessageQuote:j,settings:e.settings})}));var C=d;return C=(C=C&&(u[d].members.length>1||-1==t.currentState))&&c==t.currentState&&u[d].amMember&&u[d].canTalk,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"meeting-tabs"},k.length>0&&k,0==k.length&&r.a.createElement("div",{className:"tab sel"},l&&l.name)),r.a.createElement("div",{className:"speech-wrapper"},r.a.createElement("div",{className:"speech-display",onScroll:function(){if(y){var e=w.current;Math.round(e.scrollTop+e.clientHeight)>=Math.round(e.scrollHeight)?v(!0):v(!1)}else N()},ref:w},S),C&&r.a.createElement(Rt,{meetings:u,selTab:d,players:a,options:e.options,socket:e.socket,setAutoScroll:v,agoraClient:e.agoraClient,localAudioTrack:e.localAudioTrack,muted:e.muted,setMuted:e.setMuted,deafened:e.deafened,setDeafened:e.setDeafened})))}function At(e){var t,a,c=e.history,o=e.players,s=Object(n.useContext)(O),i=e.message,l="content ",u=!1;if("server"!=i.senderId&&"vote"!=i.senderId&&"anonymous"!=i.senderId&&(t=o[i.senderId]),i.isQuote){var m=c.states[i.fromState];if(!m)return;var d=m.meetings[i.fromMeetingId];if(!d)return;var f,p=Object(T.a)(d.messages);try{for(p.s();!(f=p.n()).done;){var v=f.value;if(v.id==i.messageId){(a=Object(h.a)({},v)).meetingName=d.name,"anonymous"==v.senderId?a.senderName="Anonymous":a.senderName=o[v.senderId].name;break}}}catch(g){p.e(g)}finally{p.f()}}return i.isQuote&&!a?r.a.createElement(r.a.Fragment,null):(!t&&"anonymous"!=i.senderId||i.isQuote||(l+="clickable "),i.isQuote||0!=i.content.indexOf("/me ")||(u=!0,(i=Object(h.a)({},i)).content=i.content.replace("/me ","")),i.isQuote?l+="quote ":"server"==i.senderId?l+="server ":"vote"==i.senderId?l+="vote-record ":u&&(l+="me "),r.a.createElement("div",{className:"message",onDoubleClick:function(){return e.onMessageQuote(i)}},r.a.createElement("div",{className:"sender"},e.settings.timestamps&&r.a.createElement(Mt,{time:i.time}),t&&r.a.createElement(Le,{id:t.userId,name:t.name,avatar:t.avatar,color:t.nameColor,noLink:!0,small:!0}),"anonymous"==i.senderId&&r.a.createElement("div",{className:"name-with-avatar"},"Anonymous")),r.a.createElement("div",{className:l,style:t&&t.textColor?{color:t.textColor}:{}},!i.isQuote&&r.a.createElement(r.a.Fragment,null,i.prefix&&r.a.createElement("div",{className:"prefix"},"(",i.prefix,")"),r.a.createElement(U,{text:i.content,settings:s.settings,filterProfanity:!0,linkify:!0,emotify:!0})),i.isQuote&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-quote-left"}),r.a.createElement(Mt,{time:a.time}),r.a.createElement("div",{className:"quote-info"},"".concat(a.senderName," in ").concat(a.meetingName,": ")),r.a.createElement("div",{className:"quote-content"},r.a.createElement(U,{text:a.content,settings:s.settings,filterProfanity:!0,linkify:!0,emotify:!0})),r.a.createElement("i",{className:"fas fa-quote-right"})))))}function Mt(e){var t=new Date(e.time),a=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),c=String(t.getSeconds()).padStart(2,"0");return r.a.createElement("div",{className:"time"},a,":",n,":",c)}function Rt(e){var t,a=e.socket,c=e.meetings,o=e.selTab,s=e.players,l=e.options,u=e.agoraClient,m=e.localAudioTrack,d=e.muted,f=e.setMuted,p=e.deafened,h=e.setDeafened,v=Object(n.useState)(""),g=Object(i.a)(v,2),b=g[0],y=g[1],E=Object(n.useState)([]),w=Object(i.a)(E,2),O=w[0],N=w[1],j=Object(n.useState)("Say"),k=Object(i.a)(j,2),S=k[0],C=k[1],x=Object(n.useState)(0),I=Object(i.a)(x,2),L=I[0],A=I[1],M=Object(n.useState)(),R=Object(i.a)(M,2),P=R[0],F=R[1],D=Object(n.useState)(),B=Object(i.a)(D,2),V=B[0],U=B[1],G="",_=Object(T.a)(O);try{for(_.s();!(t=_.n()).done;){var W=t.value;if(S==W.id){G=W.placeholder||"";break}}}catch(H){_.e(H)}finally{_.f()}return Object(n.useEffect)((function(){if(o){var e,t=c[o].speechAbilities,a=[{label:"Say",id:"Say",placeholder:"to everyone"}],n=Object(T.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;a.push("divider");var i,l=Object(T.a)(r.targets);try{for(l.s();!(i=l.n()).done;){var u=i.value,m=u;"player"==r.targetType&&(m=s[u].name),a.push({label:r.name,placeholder:"".concat(r.verb," ").concat(m),id:"".concat(r.name,":").concat(u)})}}catch(H){l.e(H)}finally{l.f()}}}catch(H){n.e(H)}finally{n.f()}N(a)}}),[o]),Object(n.useEffect)((function(){L>0?(clearTimeout(V),U(setTimeout((function(){return A(0)}),1e3)),P!=o&&(F(o),null!=P&&a.send("typing",{meetingId:P,isTyping:!1}),a.send("typing",{meetingId:o,isTyping:!0}))):null!=P&&(F(null),a.send("typing",{meetingId:P,isTyping:!1}))}),[L]),r.a.createElement("div",{className:"speech-input-area"},r.a.createElement("div",{className:"speech-input-wrapper"},r.a.createElement($,{className:"speech-dropdown",options:O,onChange:function(e){C(e)},value:S}),r.a.createElement("input",{id:"speechInput",className:"speech-input",type:"text",autoComplete:"off",value:b,placeholder:G,maxLength:240,onChange:function(e){y(e.target.value),e.target.value.length>0&&("/"!=e.target.value[0]||"/me "==e.target.value.slice(0,4))&&A(Date.now())},onKeyPress:function(t){if("Enter"==t.key&&o&&b.length){var n=S.split(":"),r=n[0],c=n[1];"Say"==r&&(r=null),a.send("speak",{content:b,meetingId:o,abilityName:r,abilityTarget:c}),y(""),e.setAutoScroll(!0)}}})),l.voiceChat&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-microphone ".concat(d?"disabled":""),onClick:function(){if(m.current){var e=d?100:0;m.current.setVolume(e),f(!d)}}}),r.a.createElement("i",{className:"fas fa-headphones ".concat(p?"disabled":""),onClick:function(){if(u.current){var e=p?100:0;u.current.remoteUsers.forEach((function(t){t.audioTrack&&t.audioTrack.setVolume(e)})),h(!p)}}})))}function Pt(e){var t=e.history,a=e.stateViewing,n=t.states[a]?t.states[a].name:"",c=-1!=e.stateViewing,o=e.stateViewing<t.currentState||-2==t.currentState&&e.stateViewing!=t.currentState;return r.a.createElement("div",{className:"state-nav"},r.a.createElement("i",{className:"hist-arrow fas fa-caret-left ".concat(c?"":"invisible"),onClick:function(){return e.updateStateViewing({type:"backward"})}}),r.a.createElement("div",{className:"state-name",onClick:function(){e.updateStateViewing({type:"current"})}},n.toUpperCase()),r.a.createElement("i",{className:"hist-arrow fas fa-caret-right ".concat(o?"":"invisible"),onClick:function(){return e.updateStateViewing({type:"forward"})}}))}function Ft(e){return r.a.createElement("div",{className:"side-menu ".concat(e.scrollable?"scrollable":"")},r.a.createElement("div",{className:"side-menu-title"},e.title),r.a.createElement("div",{className:"side-menu-content"},e.content))}function Dt(e){var t=e.history,a=e.players,n=e.activity,c=t.states[e.stateViewing],o=c&&c.selTab;return a.map((function(t){return r.a.createElement("div",{className:"player ".concat(e.className?e.className:""),key:t.id},-1!=e.stateViewing&&r.a.createElement(dt,{role:c.roles[t.id],gameType:e.gameType,showPopover:!0}),r.a.createElement(Le,{id:t.userId,name:t.name,avatar:t.avatar,color:t.nameColor,active:n.speaking[t.id],newTab:!0}),o&&n.typing[t.id]==o&&r.a.createElement(ce.a,{className:"typing-icon ".concat(-1!=e.stateViewing?"has-role":""),type:"bubbles",color:"black",width:"20",height:"20"}))}))}function Bt(e){var t=e.history,a=t.states[e.stateViewing],n=Object.values(e.players).filter((function(e){return!a.dead[e.id]&&!e.left})),c=Object.values(e.players).filter((function(e){return a.dead[e.id]&&!e.left}));return r.a.createElement(Ft,{title:"Players",scrollable:!0,content:r.a.createElement("div",{className:"player-list"},r.a.createElement(Dt,{players:n,history:t,gameType:e.gameType,stateViewing:e.stateViewing,activity:e.activity}),c.length>0&&r.a.createElement("div",{className:"section-title"},r.a.createElement("i",{className:"fas fa-skull"}),"Graveyard"),r.a.createElement(Dt,{players:c,history:t,gameType:e.gameType,stateViewing:e.stateViewing,activity:e.activity,className:"dead"}))})}function Vt(e){var t=Object.values(e.meetings).reduce((function(t,a){if(a.voting){var n;switch(a.inputType){case"player":case"boolean":case"alignment":case"select":n=r.a.createElement(Ut,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing});break;case"button":n=r.a.createElement(Gt,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing});break;case"text":n=r.a.createElement(_t,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing})}t.push(n)}return t}),[]);return r.a.createElement(r.a.Fragment,null,t.length>0&&r.a.createElement(Ft,{scrollable:!0,title:"Actions",content:r.a.createElement("div",{className:"action-list"},t)}))}function Ut(e){var t=Wt(e),a=Object(i.a)(t,6),n=a[0],c=(a[1],a[2],a[3],a[4]),o=a[5],s=H(),l=Object(i.a)(s,4),u=l[0],m=l[1],d=l[2],f=l[3],p=n.targets.map((function(t){var a=$t(t,n,e.players);return r.a.createElement("div",{className:"target dropdown-menu-option",key:t,onClick:function(){return e=t,m(!1),void o(e);var e}},a)})),h=Object.values(n.members).filter((function(e){return e.canVote})).map((function(t){var a=n.votes[t.id],c=e.players[t.id];return a=$t(a,n,e.players),r.a.createElement("div",{className:"vote ".concat(n.multi?"multi":""),key:t.id},r.a.createElement("div",{className:"voter"},c&&c.name||"Anonymous"),a.length>0&&r.a.createElement("div",{className:"italic"},"votes"),r.a.createElement("div",{className:"selection"},a.join(", ")))}));return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name dropdown-control ".concat(c?"not-clickable":""),ref:d,onClick:function(){c||m(!u)}},n.actionName,r.a.createElement("i",{className:"fas fa-angle-down dropdown-arrow"})),u&&r.a.createElement("div",{className:"targets dropdown-menu",ref:f},p),r.a.createElement("div",{className:"votes"},h))}function Gt(e){var t=Wt(e),a=Object(i.a)(t,6),n=a[0],c=(a[1],a[2],a[3],a[4],a[5]),o=Object(h.a)({},n.votes);for(var s in o)o[s]=$t(o[s],n,e.players);var l=n.targets.map((function(t){var a=$t(t,n,e.players);return r.a.createElement("div",{className:"btn btn-theme ".concat(o[e.self]==a?"sel":""),key:t,disabled:o[e.self]&&!n.canUnvote,onClick:function(){return c(t)}},a)}));return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name"},n.actionName),l)}function _t(e){var t=Wt(e),a=Object(i.a)(t,6),c=a[0],o=(a[1],a[2],a[3],a[4],a[5]),s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1],d=Object(h.a)({},c.votes);0==u.length&&d[e.self]&&m(d[e.self]);c.targets.map((function(t){var a=$t(t,c,e.players);return r.a.createElement("div",{className:"btn btn-theme ".concat(d[e.self]==a?"sel":""),key:t,onClick:function(){return o(t)}},a)}));return r.a.createElement("div",{className:"action"},r.a.createElement("input",{value:u,onChange:function(e){o(e.target.value),m(e.target.value)}}))}function Wt(e){var t=e.meeting,a=e.history,n=e.stateViewing,r=n==a.currentState,c=!r||!t.amMember||!t.canVote||t.instant&&t.votes[e.self];return[t,a,n,r,c,function(a){(Array.isArray(t.votes[e.self])?-1!=t.votes[e.self].indexOf(a):a==t.votes[e.self])?e.socket.send("unvote",{meetingId:t.id,selection:a}):e.socket.send("vote",{meetingId:t.id,selection:a})}]}function $t(e,t,a){for(var n in e=!Array.isArray(e)&&e?[e]:e?Object(te.a)(e):[]){var r=e[n];switch(t.inputType){case"player":r="*"==r?"no one":r?a[r].name:"";break;case"boolean":"*"==r?r="No":r||(r="");default:"*"==r?r="None":r||(r="")}e[n]=r}return e}function Ht(e){var t;t=-1==e.history.currentState?"pregameCountdown":e.timers.secondary?"secondary":"main";var a=e.timers[t];if(!a)return r.a.createElement("div",{className:"state-timer"});var n=a.delay-a.time;return n=function(e){e=e>0?Math.round(e/1e3):0;var t=String(Math.floor(e/60)).padStart(2,"0"),a=String(e%60).padStart(2,"0");return"".concat(t,":").concat(a)}(n),r.a.createElement("div",{className:"state-timer"},n)}function qt(e){var t=Object(n.useState)(e.lastWill),a=Object(i.a)(t,2),c=a[0],o=a[1];return r.a.createElement(Ft,{title:"Last Will",content:r.a.createElement("div",{className:"last-will-wrapper"},r.a.createElement("textarea",{className:"last-will-entry",value:c,onChange:function(t){var a=t.target.value.slice(0,100);o(a),e.socket.send("lastWill",a)}}))})}function Yt(e){var t=e.settings,a=e.updateSettings,n=e.showModal,c=e.setShowModal,o=we([{label:"Voting Log",ref:"votingLog",type:"boolean",value:t.votingLog},{label:"Timestamps",ref:"timestamps",type:"boolean",value:t.timestamps},{label:"Sounds",ref:"sounds",type:"boolean",value:t.sounds},{label:"Volume",ref:"volume",type:"range",min:0,max:1,step:.1,value:t.volume}]),s=Object(i.a)(o,2),l=s[0],u=s[1],m=r.a.createElement(ge,{fields:l,onChange:u}),d=r.a.createElement("div",{className:"settings-control"},r.a.createElement("div",{className:"settings-save btn btn-theme",onClick:function(){var e,t={},n=Object(T.a)(l);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r.ref]=r.value}}catch(o){n.e(o)}finally{n.f()}a({type:"set",settings:t}),c(!1)}},"Save"),r.a.createElement("div",{className:"settings-cancel btn btn-theme-third",onClick:f},"Cancel"));function f(){var e,a=Object(T.a)(l);try{for(a.s();!(e=a.n()).done;){var n=e.value;u({ref:n.ref,prop:"value",value:t[n.ref]})}}catch(r){a.e(r)}finally{a.f()}c(!1)}return r.a.createElement(Re,{className:"settings",show:n,header:"Settings",content:m,footer:d,onBgClick:f})}function zt(e){var t=e.showModal,a=e.setShowModal,n=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"paragraph"},"To keep games fun and competitive for all, please don't:"),r.a.createElement("div",{className:"paragraph"},r.a.createElement("div",null,"- Communicate with other players using anything which isn't part of the game."),r.a.createElement("div",null,"- Form alliances or other out-of-game arrangements with other users."),r.a.createElement("div",null,"- Attempt to play a game using more than one account."),r.a.createElement("div",null,'- Send screenshots or "prove" anything with images or video.'),r.a.createElement("div",null,"- Copy exactly any system messages you recieve (blue text)."),r.a.createElement("div",null,"- Try to lose the game on purpose."),r.a.createElement("div",null,"- Give up or leave partway through the game."),r.a.createElement("div",null,"- Issue out-of-game bribes or threats to sway other players, including threatening to leave.")),r.a.createElement("div",{className:"paragraph"},"Breaking game conduct may result in necessary action being taken against your account."),r.a.createElement("div",{className:"paragraph"},"A full description of these rules as well as site and community rules is found ",r.a.createElement("a",null,"here"),"."),r.a.createElement("div",{className:"paragraph"},"You can also find tutorials, tips, and strategy guides ",r.a.createElement("a",{href:"/community/forums/board/SLsDA_SI2"},"here"),". Good luck, and have fun!")),c=r.a.createElement("div",{className:"btn btn-theme",onClick:o},"Close");function o(){a(!1)}return r.a.createElement(Re,{className:"first-game",show:t,header:"Welcome to BeyondMafia",content:n,footer:c,onBgClick:o})}function Jt(e){var t=e.filters,a=e.setFilters;function n(e,n){a(p()(t,Object(v.a)({},e,{$set:n})))}return e.stateViewing<0?r.a.createElement(r.a.Fragment,null):r.a.createElement(Ft,{title:"Speech Filters",content:r.a.createElement("div",{className:"speech-filters"},r.a.createElement("input",{type:"text",placeholder:"From user",value:t.from,onChange:function(e){return n("from",e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Contains",value:t.contains,onChange:function(e){return n("contains",e.target.value)}}))})}function Qt(e){var t=e.stateViewing,a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],s=c[1],l=Object(u.i)().gameId;return Object(n.useEffect)((function(){var e=window.localStorage.getItem("notesData");e&&((e=JSON.parse(e)).game!=l?window.localStorage.removeItem("notesData"):s(e.notes))}),[]),t<0?r.a.createElement(r.a.Fragment,null):r.a.createElement(Ft,{title:"Notes",content:r.a.createElement("div",{className:"notes-wrapper"},r.a.createElement("textarea",{className:"notes-entry",value:o,onChange:function(e){return t=e.target.value,s(t),void window.localStorage.setItem("notesData",JSON.stringify({game:l,notes:t}));var t}}))})}function Kt(){return(Kt=Object(l.a)(kt().mark((function e(){return kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Notification){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Notification.requestPermission();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(442);function Xt(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1];Object(n.useEffect)((function(){document.title="Users | BeyondMafia"}),[]),Object(n.useEffect)((function(){u.length>0?d.a.get("/user/searchName?query=".concat(u)).then((function(e){o(e.data)})).catch(I):d.a.get("/user/online").then((function(e){o(e.data)})).catch(I)}),[u]);var f=c.map((function(e){return r.a.createElement("div",{className:"user-cell"},r.a.createElement(Le,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement(Ae,{status:e.status}))}));return r.a.createElement("div",{className:"user-search-page"},r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"form"},r.a.createElement("input",{type:"text",placeholder:"Username",value:u,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",{className:"users"},f)),r.a.createElement(Zt,null))}function Zt(e){var t=Object(n.useState)(1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)([]),l=Object(i.a)(s,2),u=l[0],m=l[1],f=I();function p(e){var t=Z(e,c,u,"joined");null!=t&&d.a.get("/user/newest?".concat(t)).then((function(t){t.data.length>0&&(m(t.data),o(e))})).catch(f)}Object(n.useEffect)((function(){p(1)}),[]);var h=u.map((function(e){return r.a.createElement("div",{className:"user-row",key:e.id},r.a.createElement(Le,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"joined"},r.a.createElement(B,{minSec:!0,millisec:Date.now()-e.joined,suffix:" ago"})))}));return r.a.createElement("div",{className:"newest-users box-panel"},r.a.createElement("div",{className:"heading"},"Newest Users"),r.a.createElement("div",{className:"newest-users-list"},r.a.createElement(X,{page:c,onNav:p,inverted:!0}),h,r.a.createElement(X,{page:c,onNav:p,inverted:!0})))}a(443);function ea(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),s=Object(i.a)(o,2),l=s[0],u=s[1],m=Object(n.useContext)(O),f=I();Object(n.useEffect)((function(){document.title="Moderation | BeyondMafia",d.a.get("/mod/groups").then((function(e){c(e.data.sort((function(e,t){return t.rank-e.rank}))),u(!0)})).catch((function(e){u(!0),f(e)}))}),[]);var p=a.map((function(e){var t=e.members.map((function(e){return r.a.createElement("div",{className:"member user-cell",key:e.id},r.a.createElement(Le,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement(Ae,{status:e.status}))}));return r.a.createElement("div",{className:"span-panel group-panel",key:e.name},r.a.createElement("div",{className:"title"},e.name+"s"),r.a.createElement("div",{className:"members"},t))}));return l?r.a.createElement("div",{className:"moderation"},r.a.createElement("div",{className:"main-section"},m.perms.viewModActions&&r.a.createElement("div",{className:"span-panel action-panel"},r.a.createElement("div",{className:"title"},"Do Action"),r.a.createElement(ta,null)),p),r.a.createElement("div",{className:"side-column"},r.a.createElement(na,null))):r.a.createElement(oe,null)}function ta(){var e=Object(n.useState)(),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({}),s=Object(i.a)(o,2),l=s[0],u=s[1],m=aa(l,(function(){c(null),u({})})),d=Object(n.useContext)(O),f=I(),h=[],g=[];for(var b in m)d.perms[m[b].perm]&&!m[b].hidden&&h.push(b);function y(e,t,a){a&&(t=t.split(/ *, */)),u(p()(l,Object(v.a)({},e,{$set:t})))}return a&&(g=m[a].args.map((function(e){var t=e.label;return null!=e.default?t="".concat(t," (").concat(e.default,")"):e.optional&&(t="[".concat(t,"]")),"user_search"==e.type?r.a.createElement(Ne,{value:l[e.name]||"",setValue:function(t){return y(e.name,t,e.isArray)},placeholder:t,key:e.name}):r.a.createElement("input",{className:"arg",type:e.type,placeholder:t,maxLength:e.maxlength,onChange:function(t){return y(e.name,t.target.value,e.isArray)},key:e.name})}))),r.a.createElement("div",{className:"mod-commands"},r.a.createElement("div",{className:"inputs"},r.a.createElement(Oe,{options:h,value:a,setValue:c}),g),a&&r.a.createElement("div",{className:"btn btn-theme-sec submit",onClick:function(){var e,t=Object(T.a)(m[a].args);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(null==l[n.name])if(null!=n.default)l[n.name]=n.default;else if(!n.optional)return void f("Missing arguments.")}}catch(r){t.e(r)}finally{t.f()}m[a].run()}},"Run"))}function aa(e,t){var a,r=Object(n.useContext)(N),c=I();return a={"Create Group":{perm:"createGroup",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Rank",name:"rank",type:"number",default:0},{label:"Permissions",name:"permissions",type:"text",optional:!0,isArray:!0}],run:function(){d.a.post("/mod/group",e).then((function(){r.showAlert("Group created.","success"),t()})).catch(c)}},"Delete Group":{perm:"deleteGroup",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.post("/mod/group/delete",e).then((function(){r.showAlert("Group deleted.","success"),t()})).catch(c)}},"Create Forum Category":{perm:"createCategory",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Rank",name:"rank",type:"number",default:0},{label:"Position",name:"position",type:"number",default:0}],run:function(){d.a.post("/forums/category",e).then((function(){r.showAlert("Category created.","success"),t()})).catch(c)}},"Create Forum Board":{perm:"createBoard",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Category",name:"category",type:"text",maxlength:20},{label:"Description",name:"description",type:"text",maxlength:60},{label:"Icon",name:"icon",type:"text",optional:!0},{label:"Rank",name:"rank",type:"number",optional:!0},{label:"Position",name:"position",type:"number",optional:!0}],run:function(){d.a.post("/forums/board",e).then((function(){r.showAlert("Board created.","success"),t()})).catch(c)}},"Update Group Permissions":{perm:"updateGroupPerms",args:[{label:"Group Name",name:"groupName",type:"text",maxlength:20},{label:"Permissions to Add",name:"addPermissions",type:"text",optional:!0,isArray:!0},{label:"Permissions to Remove",name:"removePermissions",type:"text",optional:!0,isArray:!0}],run:function(){d.a.post("/mod/groupPerms",e).then((function(){r.showAlert("Group permissions updated.","success"),t()})).catch(c)}},"Add User to Group":{perm:"giveGroup",args:[{label:"User",name:"userId",type:"user_search"},{label:"Group Name",name:"groupName",type:"text",maxlength:20}],run:function(){d.a.post("/mod/addToGroup",e).then((function(){r.showAlert("User added to group.","success"),t()})).catch(c)}},"Remove User from Group":{perm:"removeFromGroup",args:[{label:"User",name:"userId",type:"user_search"},{label:"Group Name",name:"groupName",type:"text",maxlength:20}],run:function(){d.a.post("/mod/removeFromGroup",e).then((function(){r.showAlert("User removed from group.","success"),t()})).catch(c)}},"Get Group Permissions":{perm:"viewPerms",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.get("/mod/groupPerms?name=".concat(e.name)).then((function(e){alert(e.data.join(", "),"success"),t()})).catch(c)}},"Get User Permissions":{perm:"viewPerms",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/userPerms?userId=".concat(e.userId)).then((function(e){alert(e.data.join(", "),"success"),t()})).catch(c)}},"Delete Forum Board":{perm:"deleteBoard",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.post("/forums/board/delete",e).then((function(){r.showAlert("Board deleted.","success"),t()})).catch(c)}},"Move Forum Thread":{perm:"moveThread",args:[{label:"Thread ID",name:"thread",type:"text"},{label:"Board Name",name:"board",type:"text"}],run:function(){d.a.post("/forums/thread/move",e).then((function(){r.showAlert("Thread moved.","success"),t()})).catch(c)}},"Create Chat Room":{perm:"createRoom",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Position",name:"position",type:"number",optional:!0},{label:"Rank",name:"rank",type:"number",optional:!0}],run:function(){d.a.post("/chat/room",e).then((function(){r.showAlert("Room created.","success"),t()})).catch(c)}},"Delete Chat Room":{perm:"deleteRoom",args:[{label:"Room Name",name:"name",type:"text"}],run:function(){d.a.post("/chat/room/delete",e).then((function(){r.showAlert("Room deleted.","success"),t()})).catch(c)}},"Forum Ban":{perm:"forumBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/forumBan",e).then((function(){r.showAlert("User forum banned.","success"),t()})).catch(c)}},"Chat Ban":{perm:"chatBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/chatBan",e).then((function(){r.showAlert("User chat banned.","success"),t()})).catch(c)}},"Game Ban":{perm:"gameBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/gameBan",e).then((function(){r.showAlert("User game banned.","success"),t()})).catch(c)}},"Host Ranked Ban":{perm:"hostRankedBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/hostRankedBan",e).then((function(){r.showAlert("User host ranked banned.","success"),t()})).catch(c)}},"Site Ban":{perm:"siteBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/siteBan",e).then((function(){r.showAlert("User site banned.","success"),t()})).catch(c)}},"Force Sign Out":{perm:"forceSignOut",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/logout",e).then((function(){r.showAlert("User logged out.","success"),t()})).catch(c)}},"Forum Unban":{perm:"forumUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/forumUnban",e).then((function(){r.showAlert("User forum unbanned.","success"),t()})).catch(c)}},"Chat Unban":{perm:"chatUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/chatUnban",e).then((function(){r.showAlert("User chat unbanned.","success"),t()})).catch(c)}},"Game Unban":{perm:"gameUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/gameUnban",e).then((function(){r.showAlert("User game unbanned.","success"),t()})).catch(c)}},"Site Unban":{perm:"siteUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/siteUnban",e).then((function(){r.showAlert("User site unbanned.","success"),t()})).catch(c)}},"Get Alt Accounts":{perm:"viewAlts",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/alts?userId=".concat(e.userId)).then((function(e){alert(e.data.map((function(e){return"".concat(e.name," (").concat(e.id,")")})).join(", ")),t()})).catch(c)}},"Get Bans":{perm:"viewBans",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/bans?userId=".concat(e.userId)).then((function(e){alert(e.data.map((function(e){return"Type: ".concat(e.type,", mod: ").concat(e.modId,", expires: ").concat(new Date(e.expires).toLocaleString())})).join("\n")),t()})).catch(c)}},"Clear Setup Name":{perm:"clearSetupName",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/mod/clearSetupName",e).then((function(){r.showAlert("Setup name cleared.","success"),t()})).catch(c)}},"Clear Bio":{perm:"clearBio",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearBio",e).then((function(){r.showAlert("Bio cleared.","success"),t()})).catch(c)}},"Clear Account Display":{perm:"clearAccountDisplay",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearAccountDisplay",e).then((function(){r.showAlert("Account display cleared.","success"),t()})).catch(c)}},"Clear Name":{perm:"clearName",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearName",e).then((function(){r.showAlert("Name cleared.","success"),t()})).catch(c)}},"Clear Avatar":{perm:"clearAvi",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearAvi",e).then((function(){r.showAlert("Avatar cleared.","success"),t()})).catch(c)}},"Clear All User Content":{perm:"clearAllUserContent",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearAllContent",e).then((function(){r.showAlert("User content cleared.","success"),t()})).catch(c)}},"Change Name":{perm:"changeName",args:[{label:"User",name:"userId",type:"user_search"},{label:"New Name",name:"name",type:"text"}],run:function(){d.a.post("/mod/changeName",e).then((function(){r.showAlert("Name changed.","success"),t()})).catch(c)}},"Give Coins":{perm:"giveCoins",args:[{label:"User",name:"userId",type:"user_search"},{label:"Amount",name:"amount",type:"number"}],run:function(){d.a.post("/mod/giveCoins",e).then((function(){r.showAlert("Coins given.","success"),t()})).catch(c)}},"Break Game":{perm:"breakGame",args:[{label:"Game Id",name:"gameId",type:"text"}],run:function(){d.a.post("/mod/breakGame",e).then((function(){r.showAlert("Game broken.","success"),t()})).catch(c)}},"Toggle Featured Setup":{perm:"featureSetup",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/setup/feature",e).then((function(){r.showAlert("Setup feature toggled.","success"),t()})).catch(c)}},"Clear All IPs":{perm:"clearAllIPs",args:[],run:function(){d.a.post("/mod/clearAllIPs",e).then((function(){r.showAlert("IPs cleared.","success"),t()})).catch(c)}},"Whitelist User":{perm:"whitelist",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/whitelist",e).then((function(){r.showAlert("User whitelisted.","success"),t()})).catch(c)}},"Schedule Restart":{perm:"scheduleRestart",args:[{label:"When",name:"when",type:"text"}],run:function(){d.a.post("/mod/scheduleRestart",e).then((function(){r.showAlert("Restart scheduled.","success"),t()})).catch(c)}}},Object(v.a)(a,"Delete Forum Board",{hidden:!0,args:[{label:"Name"}]}),Object(v.a)(a,"Update Board Description",{hidden:!0,args:[{label:"Name"}]}),Object(v.a)(a,"Delete Thread",{hidden:!0,args:[{label:"Thread ID"}]}),Object(v.a)(a,"Restore Thread",{hidden:!0,args:[{label:"Thread ID"}]}),Object(v.a)(a,"Toggle Forum Thread Pin",{hidden:!0,args:[{label:"Thread ID"}]}),Object(v.a)(a,"Toggle Forum Thread Lock",{hidden:!0,args:[{label:"Thread ID"}]}),Object(v.a)(a,"Delete Forum Reply",{hidden:!0,args:[{label:"Reply ID"}]}),Object(v.a)(a,"Restore Forum Reply",{hidden:!0,args:[{label:"Reply ID"}]}),Object(v.a)(a,"Restore Forum Reply",{hidden:!0,args:[{label:"Reply ID"}]}),a}function na(e){var t=Object(n.useState)(1),a=Object(i.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)([]),u=Object(i.a)(l,2),m=u[0],f=u[1],p=aa({},(function(){})),h=I();function v(e){var t=Z(e,c,m,"date");null!=t&&d.a.get("/mod/actions?".concat(t)).then((function(t){t.data.length>0&&(f(t.data),o(e))})).catch(h)}Object(n.useEffect)((function(){v(1)}),[]);var g=m.map((function(e){var t=p[e.name],a=e.args.map((function(e,a){var n=t.args[a].label;return"User"==n&&(e=r.a.createElement(s.b,{to:"/user/".concat(e)},e)),r.a.createElement("div",{className:"action-arg",key:a},n,": ",e)}));return r.a.createElement("div",{className:"action",key:e.id},r.a.createElement("div",{className:"top-row"},r.a.createElement(Le,{id:e.mod.id,name:e.mod.name,avatar:e.mod.avatar}),r.a.createElement("div",{className:"date"},r.a.createElement(B,{minSec:!0,millisec:Date.now()-e.date,suffix:" ago"}))),r.a.createElement("div",{className:"action-name"},e.name),r.a.createElement("div",{className:"action-args"},a))}));return r.a.createElement("div",{className:"box-panel"},r.a.createElement("div",{className:"heading"},"Mod Actions"),r.a.createElement("div",{className:"actions-wrapper"},r.a.createElement(X,{page:c,onNav:v}),g,r.a.createElement(X,{page:c,onNav:v})))}function ra(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{links:[{text:"Forums",path:"/community/forums"},{text:"Users",path:"/community/users"},{text:"Moderation",path:"/community/moderation"}]}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/community/forums",render:function(){return r.a.createElement(Ve,null)}}),r.a.createElement(u.b,{path:"/community/users",render:function(){return r.a.createElement(Xt,null)}}),r.a.createElement(u.b,{path:"/community/moderation",render:function(){return r.a.createElement(ea,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/community/forums"})}}))))}var ca=a(162),oa=a(23);function sa(){sa=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var c=t&&t.prototype instanceof d?t:d,o=Object.create(c.prototype),s=new k(r||[]);return n(o,"_invoke",{value:w(e,a,s)}),o}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,c,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,c)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,c){function o(){return new t((function(r,o){!function n(r,c,o,s){var i=u(e[r],e,c);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(m).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(i.arg)}(n,c,r,o)}))}return r=r?r.then(o,o):o()}})}function w(e,t,a){var n="suspendedStart";return function(r,c){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw c;return C()}for(a.method=r,a.arg=c;;){var o=a.delegate;if(o){var s=O(o,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var c=r.arg;return c?c.done?(t[e.resultName]=c.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):c:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,c){void 0===c&&(c=Promise);var o=new E(l(t,a,n,r),c);return e.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(b),i(b,s,"Generator"),i(b,c,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return o.type="throw",o.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r],o=c.completion;if("root"===c.tryLoc)return n("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),i=a.call(c,"finallyLoc");if(s&&i){if(this.prev<c.catchLoc)return n(c.catchLoc,!0);if(this.prev<c.finallyLoc)return n(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return n(c.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return n(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var c=r;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=t&&t<=c.finallyLoc&&(c=null);var o=c?c.completion:{};return o.type=e,o.arg=t,c?(this.method="next",this.next=c.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function ia(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),u=Object(i.a)(o,2),m=u[0],f=u[1],p=Object(n.useState)(!0),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(!1),y=Object(i.a)(b,2),E=y[0],w=y[1],O=Object(n.useState)(!1),j=Object(i.a)(O,2),k=j[0],S=j[1],C=Object(n.useContext)(N),x=I();function T(){return(T=Object(l.a)(sa().mark((function e(t){var n,r,c;return sa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!v){e.next=4;break}return e.abrupt("return");case 4:return w(!0),n=Object(oa.b)(),e.next=8,Object(oa.f)(n,a,m);case 8:return r=e.sent,e.next=11,r.user.getIdToken(!0);case 11:c=e.sent,d.a.post("/auth",{idToken:c}).then((function(){window.location.reload()})).catch((function(e){x(e),w(!1);try{e.response&&403==e.response.status&&Object(oa.d)(r.user)}catch(e){}})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),w(!1),-1!=e.t0.message.indexOf("(auth/wrong-password)")?x("Incorrect password."):-1!=e.t0.message.indexOf("(auth/invalid-email)")?x("Invalid email."):-1!=e.t0.message.indexOf("(auth/user-not-found)")?x("Account does not exist."):-1!=e.t0.message.indexOf("(auth/too-many-requests)")?x("Too many login attempts on this account. Please try again later."):x("Error logging in.");case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function L(e){return A.apply(this,arguments)}function A(){return(A=Object(l.a)(sa().mark((function e(t){var n;return sa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),S(!1),w(!0),n=Object(oa.b)(),e.next=7,Object(oa.e)(n,a);case 7:C.showAlert("Password reset email sent.","success"),w(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),x("Error resetting password."),w(!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}Object(n.useEffect)((function(){document.title="Log In | BeyondMafia"}),[]),Object(n.useEffect)((function(){g(0==a.length||0==m.length)}),[a,m]);var M=r.a.createElement("form",{className:"form",onSubmit:L},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return c(e.target.value)}}))),R=r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"reset btn btn-theme",onClick:L},"Reset"),r.a.createElement("div",{className:"cancel btn btn-theme-third",onClick:function(){return S(!1)}},"Cancel"));return E?r.a.createElement(oe,null):r.a.createElement("div",{className:"span-panel main login"},r.a.createElement("form",{className:"form",onSubmit:function(e){return T.apply(this,arguments)}},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Password"),r.a.createElement("input",{type:"password",value:m,onChange:function(e){return f(e.target.value)}})),r.a.createElement("a",{className:"forgot-pw",href:"#",onClick:function(){return S(!0)}},"Forgot password?"),r.a.createElement("input",{className:"auth-btn ".concat(v?"disabled":""),type:"submit",value:"Log In"})),r.a.createElement("div",{className:"legal"},"By logging in you agree to follow our ",r.a.createElement(s.b,{to:"/legal/tos"},"Terms of Service "),"and accept our ",r.a.createElement(s.b,{to:"/legal/privacy"},"Privacy Policy"),"."),r.a.createElement(Re,{className:"reset-pw",show:k,onBgClick:function(){return S(!1)},header:"Reset Password",content:M,footer:R}))}function la(){la=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var c=t&&t.prototype instanceof d?t:d,o=Object.create(c.prototype),s=new k(r||[]);return n(o,"_invoke",{value:w(e,a,s)}),o}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,c,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,c)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,c){function o(){return new t((function(r,o){!function n(r,c,o,s){var i=u(e[r],e,c);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(m).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(i.arg)}(n,c,r,o)}))}return r=r?r.then(o,o):o()}})}function w(e,t,a){var n="suspendedStart";return function(r,c){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw c;return C()}for(a.method=r,a.arg=c;;){var o=a.delegate;if(o){var s=O(o,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var c=r.arg;return c?c.done?(t[e.resultName]=c.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):c:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,c){void 0===c&&(c=Promise);var o=new E(l(t,a,n,r),c);return e.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(b),i(b,s,"Generator"),i(b,c,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return o.type="throw",o.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r],o=c.completion;if("root"===c.tryLoc)return n("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),i=a.call(c,"finallyLoc");if(s&&i){if(this.prev<c.catchLoc)return n(c.catchLoc,!0);if(this.prev<c.finallyLoc)return n(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return n(c.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return n(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var c=r;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=t&&t<=c.finallyLoc&&(c=null);var o=c?c.completion:{};return o.type=e,o.arg=t,c?(this.method="next",this.next=c.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function ua(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),m=Object(i.a)(o,2),d=m[0],f=m[1],p=Object(n.useState)(""),h=Object(i.a)(p,2),v=h[0],g=h[1],b=Object(n.useState)(!0),y=Object(i.a)(b,2),E=y[0],w=y[1],O=Object(n.useState)(!1),j=Object(i.a)(O,2),k=j[0],S=j[1],C=Object(n.useState)(!1),x=Object(i.a)(C,2),T=x[0],L=x[1],A=Object(n.useContext)(N),M=I();function R(){return(R=Object(l.a)(la().mark((function e(t){var n,r;return la().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!E){e.next=4;break}return e.abrupt("return");case 4:return S(!0),n=Object(oa.b)(),e.next=8,Object(oa.a)(n,a,d);case 8:return r=e.sent,e.next=11,Object(oa.d)(r.user);case 11:A.showAlert("Account created. Please click the verification link in your email before logging in. Be sure to check your spam folder.","success"),L(!0),S(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),S(!1),-1!=e.t0.message.indexOf("(auth/invalid-email)")?M("Invalid email."):-1!=e.t0.message.indexOf("(auth/weak-password)")?M("Password should be at least 6 characters."):-1!=e.t0.message.indexOf("(auth/email-already-in-use)")?M("Email already in use."):M("Error signing up.");case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){document.title="Sign Up | BeyondMafia"}),[]),Object(n.useEffect)((function(){w(0==a.length||0==d.length||d!=v)}),[a,d,v]),k?r.a.createElement(oe,null):T?r.a.createElement(u.a,{to:"/auth/login"}):r.a.createElement("div",{className:"span-panel main login"},r.a.createElement("form",{className:"form",onSubmit:function(e){return R.apply(this,arguments)}},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Password"),r.a.createElement("input",{type:"password",value:d,onChange:function(e){return f(e.target.value)}})),r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Confirm Password"),r.a.createElement("input",{type:"password",value:v,onChange:function(e){return g(e.target.value)}})),r.a.createElement("input",{className:"auth-btn ".concat(E?"disabled":""),type:"submit",value:"Sign Up"})),r.a.createElement("div",{className:"legal"},"By signing up you agree to follow our ",r.a.createElement(s.b,{to:"/legal/tos"},"Terms of Service "),"and accept our ",r.a.createElement(s.b,{to:"/legal/privacy"},"Privacy Policy"),", and that you are at least 13 years of age."))}a(444);function ma(){var e=Object(n.useContext)(O),t=Object(u.h)();return Object(n.useEffect)((function(){var e=new URLSearchParams(t.search);e.get("ref")&&window.localStorage.setItem("referrer",e.get("ref"));Object(ca.a)({apiKey:"AIzaSyCcrtFaLCKPxUti-qN0B6qmldXI9RpTurM",authDomain:"beyondmafia-cc1c9.firebaseapp.com",projectId:"beyondmafia-cc1c9",storageBucket:"beyondmafia-cc1c9.appspot.com",messagingSenderId:"115670726001",appId:"1:115670726001:web:b5afaa96f398060172b2d0",measurementId:"G-R5X90DK70Y"}),Object(oa.b)().setPersistence(oa.c)}),[]),e.loaded?e.loggedIn?r.a.createElement(u.a,{to:"/play"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{links:[{text:"Log In",path:"/auth/login",exact:!0},{text:"Sign Up",path:"/auth/signup",exact:!0}]}),r.a.createElement("div",{className:"auth inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/auth/login"},r.a.createElement(ia,null)),r.a.createElement(u.b,{exact:!0,path:"/auth/signup"},r.a.createElement(ua,null)),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/auth/login"})}})))):r.a.createElement(oe,null)}function da(){return Object(n.useEffect)((function(){document.title="Privacy Policy | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"Privacy Policy of BeyondMafia"),r.a.createElement("p",null,"BeyondMafia operates the BeyondMafia.org website, which provides the SERVICE."),r.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service, the BeyondMafia website."),r.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),"   ",r.a.createElement("p",null,"The terms used in this Privacy Policy have the same meanings as in our Terms and Conditions, which is accessible at BeyondMafia.org, unless otherwise defined in this Privacy Policy. Our Privacy Policy was created with the help of the ",r.a.createElement("a",{href:"https://www.privacypolicytemplate.net"},"Privacy Policy Template")," and the ",r.a.createElement("a",{href:"https://www.disclaimer-template.net"},"Disclaimer Template"),"."),r.a.createElement("h2",null,"Information Collection and Use"),r.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your email address and usernames on other services. You may also voluntarily upload any of your own personal information you wish for your profile, including but not limited to photos and textual data."),r.a.createElement("h2",null,"Log Data"),r.a.createElement("p",null,'We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol ("IP") address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics.'),r.a.createElement("h2",null,"Cookies"),r.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),r.a.createElement("p",null,'Our website uses these "cookies" to collection information and to improve our Service. You have the option to either accept or refuse these cookies by either loggin in or choosing not to log in. If you choose to refuse our cookies, you may not be able to use some portions of our Service, which includes any features that require a user to be signed in.'),r.a.createElement("h2",null,"Service Providers"),r.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),r.a.createElement("ul",null,r.a.createElement("li",null,"To facilitate our Service;"),r.a.createElement("li",null,"To provide the Service on our behalf;"),r.a.createElement("li",null,"To perform Service-related services; or"),r.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),r.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),r.a.createElement("h2",null,"Security"),r.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),r.a.createElement("h2",null,"Links to Other Sites"),r.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),r.a.createElement("p",null,"Children\u2019s Privacy"),r.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),r.a.createElement("h2",null,"Changes to This Privacy Policy"),r.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),r.a.createElement("h2",null,"Contact Us"),r.a.createElement("p",null,"If you have any questions or suggestions about our Privacy Policy, do not hesitate to contact us."))}function fa(){return Object(n.useEffect)((function(){document.title="Terms of Service | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"BeyondMafia Terms and Conditions of Use"),r.a.createElement("h2",null,"1. Terms"),r.a.createElement("p",null,"By accessing this Website, accessible from BeyondMafia.org, you are agreeing to be bound by these Website Terms and Conditions of Use and agree that you are responsible for the agreement with any applicable local laws. If you disagree with any of these terms, you are prohibited from accessing this site. The materials contained in this Website are protected by copyright and trade mark law. These Terms of Service has been created with the help of the ",r.a.createElement("a",{href:"https://www.termsofservicegenerator.net"},"Terms of Service Generator")," and the ",r.a.createElement("a",{href:"https://www.termsconditionsexample.com"},"Terms & Conditions Example"),"."),r.a.createElement("h2",null,"2. Use License"),r.a.createElement("p",null,"Permission is granted to temporarily download one copy of the materials on BeyondMafia's Website for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:"),r.a.createElement("ul",null,r.a.createElement("li",null,"modify or copy the materials;"),r.a.createElement("li",null,"use the materials for any commercial purpose or for any public display;"),r.a.createElement("li",null,"attempt to reverse engineer any software contained on BeyondMafia's Website;"),r.a.createElement("li",null,"remove any copyright or other proprietary notations from the materials; or"),r.a.createElement("li",null,'transferring the materials to another person or "mirror" the materials on any other server.')),r.a.createElement("p",null,"This will let BeyondMafia to terminate upon violations of any of these restrictions. Upon termination, your viewing right will also be terminated and you should destroy any downloaded materials in your possession whether it is printed or electronic format."),r.a.createElement("h2",null,"3. Disclaimer"),r.a.createElement("p",null,'All the materials on BeyondMafia\u2019s Website are provided "as is". BeyondMafia makes no warranties, may it be expressed or implied, therefore negates all other warranties. Furthermore, BeyondMafia does not make any representations concerning the accuracy or reliability of the use of the materials on its Website or otherwise relating to such materials or any sites linked to this Website.'),r.a.createElement("h2",null,"4. Limitations"),r.a.createElement("p",null,"BeyondMafia or its suppliers will not be hold accountable for any damages that will arise with the use or inability to use the materials on BeyondMafia\u2019s Website, even if BeyondMafia or an authorize representative of this Website has been notified, orally or written, of the possibility of such damage. Some jurisdiction does not allow limitations on implied warranties or limitations of liability for incidental damages, these limitations may not apply to you."),r.a.createElement("h2",null,"5. Revisions and Errata"),r.a.createElement("p",null,"The materials appearing on BeyondMafia\u2019s Website may include technical, typographical, or photographic errors. BeyondMafia will not promise that any of the materials in this Website are accurate, complete, or current. BeyondMafia may change the materials contained on its Website at any time without notice. BeyondMafia does not make any commitment to update the materials."),r.a.createElement("h2",null,"6. Links"),r.a.createElement("p",null,"BeyondMafia has not reviewed all of the sites linked to its Website and is not responsible for the contents of any such linked site. The presence of any link does not imply endorsement by BeyondMafia of the site. The use of any linked website is at the user\u2019s own risk."),r.a.createElement("h2",null,"7. Site Terms of Use Modifications"),r.a.createElement("p",null,"BeyondMafia may revise these Terms of Use for its Website at any time without prior notice. By using this Website, you are agreeing to be bound by the current version of these Terms and Conditions of Use."),r.a.createElement("h2",null,"8. Your Privacy"),r.a.createElement("p",null,"Please read ",r.a.createElement("a",{href:"/legal/privacy"},"our Privacy Policy"),"."),r.a.createElement("h2",null,"9. Governing Law"),r.a.createElement("p",null,"Any claim related to BeyondMafia's Website shall be governed by the laws of us without regards to its conflict of law provisions."))}a(445);function pa(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{links:[{text:"Terms of Service",path:"/legal/tos",exact:!0},{text:"Privacy Policy",path:"/legal/privacy",exact:!0}]}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/legal/tos",render:function(){return r.a.createElement(fa,null)}}),r.a.createElement(u.b,{exact:!0,path:"/legal/privacy",render:function(){return r.a.createElement(da,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/legal/tos"})}}))))}a(446);function ha(){var e=Object(n.useContext)(j),t=Object(n.useRef)(),a=Object(n.useRef)();return W([{current:e.boundingEl},t],(function(){e.loadingRef.current||(e.setVisible(!1),e.setBoundingEl(null))})),Object(n.useLayoutEffect)((function(){if(e.visible){var n=e.boundingEl.getBoundingClientRect(),r=t.current.getBoundingClientRect(),c=n.left+n.width,o=n.top-10+n.height/2+window.scrollY,s=n.left+n.width+10,i=n.top-r.height/2+n.height/2+window.scrollY,l=window.innerWidth-(s+r.width);i<window.scrollY&&(i=window.scrollY),l<0?s+l<0&&(l-=s+l):l=0,s+=l,c+=l,a.current.style.left=c+"px",a.current.style.top=o+"px",a.current.style.visibility="visible",t.current.style.top=i+"px",t.current.style.left=s+"px",t.current.style.visibility="visible"}})),e.visible&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"triangle triangle-left",ref:a}),r.a.createElement("div",{className:"popover-window",ref:t},r.a.createElement("div",{className:"popover-title"},e.title),!e.loading&&r.a.createElement("div",{className:"popover-content"},e.content)))}function va(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(),l=Object(i.a)(s,2),u=l[0],m=l[1],f=Object(n.useState)(""),p=Object(i.a)(f,2),h=p[0],v=p[1],g=Object(n.useState)(""),b=Object(i.a)(g,2),y=b[0],w=b[1],O=Object(n.useState)(!1),N=Object(i.a)(O,2),j=N[0],k=N[1],S=Object(n.useRef)(),C=I(e);function x(e,t){m(e),v(t),k(!0),o(!0),S.current=!0}function L(t,a){switch(a){case"setup":t=function(e,t){var a=[];if(a.push(r.a.createElement(ga,{title:"ID",content:e.id,key:-2})),e.creator){var n=r.a.createElement(Le,{small:!0,id:e.creator.id,name:e.creator.name,avatar:e.creator.avatar});a.push(r.a.createElement(ga,{title:"Created By",content:n,key:-1}))}a.push(r.a.createElement(ga,{title:"Players",content:e.total,key:0}));var c=[];c.push(r.a.createElement("div",{key:0},e.whispers?"Yes":"No")),e.whispers&&c.push(r.a.createElement("div",{key:1},e.leakPercentage,"% leak rate"));switch(a.push(r.a.createElement(ga,{title:"Whispers",content:c,key:1})),a.push(r.a.createElement(ga,{title:"Must Act",content:e.mustAct?"Yes":"No",key:2})),e.gameType){case"Mafia":a.push(r.a.createElement(ga,{title:"Starting State",content:r.a.createElement(gt,{state:e.startState}),key:3})),a.push(r.a.createElement(ga,{title:"Dawn",content:e.dawn?"Yes":"No",key:"dawn"})),a.push(r.a.createElement(ga,{title:"Last Will",content:e.lastWill?"Yes":"No",key:4})),a.push(r.a.createElement(ga,{title:"No Reveal",content:e.noReveal?"Yes":"No",key:5})),a.push(r.a.createElement(ga,{title:"Votes Invisible",content:e.votesInvisible?"Yes":"No",key:6}));break;case"Split Decision":a.push(r.a.createElement(ga,{title:"Initial Swap Amount",content:e.swapAmt,key:3})),a.push(r.a.createElement(ga,{title:"Round Amount",content:e.roundAmt,key:4}));break;case"Resistance":a.push(r.a.createElement(ga,{title:"First Team Size",content:e.firstTeamSize,key:3})),a.push(r.a.createElement(ga,{title:"Last Team Size",content:e.lastTeamSize,key:4})),a.push(r.a.createElement(ga,{title:"Number of Missions",content:e.numMissions,key:5})),a.push(r.a.createElement(ga,{title:"Team Formation Attempts",content:e.teamFailLimit,key:6}));break;case"One Night":a.push(r.a.createElement(ga,{title:"Votes Invisible",content:e.votesInvisible?"Yes":"No",key:3})),a.push(r.a.createElement(ga,{title:"Excess Roles",content:e.excessRoles,key:4}))}if(e.closed){a.push(r.a.createElement(ga,{title:"Unique Roles",content:e.unique?"Yes":"No",key:7}));var o=e.roles[0],s={};for(var i in o){var l,u=i.split(":")[0],m=Object(T.a)(t[e.gameType]);try{for(m.s();!(l=m.n()).done;){var d=l.value;if(d.name==u){var f=d.alignment;s[f]||(s[f]={}),s[f][i]=o[i]}}}catch(y){m.e(y)}finally{m.f()}}for(var p in s)a.push(r.a.createElement(ga,{title:"".concat(p," roles"),content:r.a.createElement(ht,{roles:s[p],gameType:e.gameType}),key:p}))}else{var h=[],v=e.roles.length>1?"Role Sets":"Roles";for(var g in e.roles){var b=e.roles[g];h.push(r.a.createElement(ht,{roles:b,gameType:e.gameType,key:g}))}a.push(r.a.createElement(ga,{title:v,content:h,key:7}))}return a}(t,e.roles);break;case"role":t=function(e){var t=[];t.push(r.a.createElement(ga,{title:"Alignment",content:e.alignment,key:0}));var a=[];for(var n in e.description)a.push(r.a.createElement("li",{key:n},e.description[n]));return t.push(r.a.createElement(ga,{title:"Description",content:r.a.createElement("ul",null,a),key:1})),t}(t);break;case"game":t=function(e){var t=[];e.settings.scheduled&&t.push(r.a.createElement(ga,{title:"Scheduled For",content:new Date(e.settings.scheduled).toLocaleString(),key:-1}));for(var a=[],n=0;n<e.players.length;n++)a.push(r.a.createElement(Le,{small:!0,id:e.players[n].id,name:e.players[n].name,avatar:e.players[n].avatar,key:e.players[n].id}));for(;a.length<e.totalPlayers;)a.push(r.a.createElement(Le,{small:!0,name:"[Guest]",key:a.length}));t.push(r.a.createElement(ga,{title:"Players",content:a,key:"players"}));var c,o=[],s=Object(T.a)(E[e.type]);try{for(s.s();!(c=s.n()).done;){var i=c.value;o.push(r.a.createElement("div",{key:i},i,": ",r.a.createElement(B,{millisec:e.settings.stateLengths[i]})))}}catch(u){s.e(u)}finally{s.f()}switch(t.push(r.a.createElement(ga,{title:"State Lengths",content:o,key:"stateLengths"})),t.push(r.a.createElement(ga,{title:"Ranked",content:e.settings.ranked?"Yes":"No",key:"ranked"})),t.push(r.a.createElement(ga,{title:"Spectating",content:e.settings.spectating?"Yes":"No",key:"spectating"})),t.push(r.a.createElement(ga,{title:"Guests Allowed",content:e.settings.guests?"Yes":"No",key:"guests"})),t.push(r.a.createElement(ga,{title:"Ready Check",content:e.settings.readyCheck?"Yes":"No",key:"readyCheck"})),e.type){case"Mafia":var l=e.settings.gameTypeOptions.extendLength||3;t.push(r.a.createElement(ga,{title:"Extension Length",content:r.a.createElement(B,{millisec:60*l*1e3}),key:"extendLength"}))}e.createTime&&t.push(r.a.createElement(ga,{title:"Created At",content:new Date(e.createTime).toLocaleString(),key:"createdAt"}));e.startTime&&t.push(r.a.createElement(ga,{title:"Started At",content:new Date(e.startTime).toLocaleString(),key:"startedAt"}));e.endTime&&t.push(r.a.createElement(ga,{title:"Ended At",content:new Date(e.endTime).toLocaleString(),key:"endedAt"}));return t}(t)}w(t),k(!1)}function A(e,t,a,n,r){x(a,n),d.a.get(e).then((function(e){r&&r(e.data),S.current=!1,L(e.data,t)})).catch(C)}return{visible:c,setVisible:o,boundingEl:u,setBoundingEl:m,title:h,setTitle:v,content:y,setContent:w,loading:j,setLoading:k,onClick:function(e,t,a,n,r){a==u?(o(!1),m(null)):A(e,t,a,n,r)},open:x,ready:L,load:A,loadingRef:S}}function ga(e){return r.a.createElement("div",{className:"info-row"},r.a.createElement("div",{className:"title"},e.title),r.a.createElement("div",{className:"content"},e.content))}a(447);function ba(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(0),s=Object(i.a)(o,2),l=s[0],u=s[1],m=Object(n.useState)(""),f=Object(i.a)(m,2),g=f[0],b=f[1],y=Object(n.useState)({}),E=Object(i.a)(y,2),w=E[0],N=E[1],j=Object(n.useReducer)((function(e,t){var a=e;switch(t.type){case"set":var n,r=t.chatInfo.notifs,c=0,o={rooms:0,directs:0},s={},i=Object(T.a)(r);try{for(i.s();!(n=i.n()).done;){var l=n.value;s[l.channelId]||(s[l.channelId]=0);var u=32==l.channelId.length?"directs":"rooms";c+=1,o[u]+=1,s[l.channelId]+=1}}catch(w){i.e(w)}finally{i.f()}a=Object(h.a)(Object(h.a)({},t.chatInfo),{},{notifs:e.notifs}),a=p()(a,{notifs:{all:{$set:c},byChannelType:{$set:o},byChannel:{$set:s}}});break;case"directs":a=p()(e,{directs:{$unshift:[t.channel]}});break;case"users":a=p()(e,{users:{$set:t.users}});break;case"remove":var m=e[t.channelType];m=m.filter((function(e){return e.id!=t.channelId})),a=p()(e,Object(v.a)({},t.channelType,{$set:m}));break;case"date":var d=e.directs.map((function(e){return e.id==t.channelId&&(e.lastMessageDate=t.date),e}));a=p()(e,{directs:{$set:d}});break;case"addNotif":var f=32==t.channelId.length?"directs":"rooms",g=e.notifs.all+1,b=e.notifs[f]?e.notifs[f]+1:1,y=e.notifs[t.channelId]?e.notifs[t.channelId]+1:1;a=p()(e,{notifs:{all:{$set:g},byChannelType:Object(v.a)({},f,{$set:b}),byChannel:Object(v.a)({},t.channelId,{$set:y})}});break;case"readNotifs":var E=e.notifs.byChannel[t.channelId]||0;f=32==t.channelId.length?"directs":"rooms",g=e.notifs.all-E,b=e.notifs.byChannelType[f]-E,a=p()(e,{notifs:{all:{$set:g},byChannelType:Object(v.a)({},f,{$set:b}),byChannel:Object(v.a)({},t.channelId,{$set:0})}})}return a}),{rooms:[],directs:[],users:[],notifs:{all:0,byChannelType:{},byChannel:{}}}),k=Object(i.a)(j,2),S=k[0],C=k[1],x=Object(n.useState)("rooms"),L=Object(i.a)(x,2),A=L[0],M=L[1],R=Object(n.useState)(),P=Object(i.a)(R,2),F=P[0],D=P[1],B=Object(n.useReducer)((function(e,t){var a=e;switch(t.type){case"set":a=t.channel;break;case"message":if(t.message.channel!=e.id)break;a=p()(e,{messages:{$push:[t.message]}});break;case"deleteMessage":var n=-1;for(var r in e.messages)if(e.messages[r].id==t.messageId){n=r;break}-1!=n&&(a=p()(e,{messages:{$splice:[[n,1]]}}));break;case"oldMessages":a=p()(e,{messages:{$unshift:t.messages}});break;case"clear":a={messages:[]}}return a}),{messages:[]}),U=Object(i.a)(B,2),G=U[0],_=U[1],W=Object(n.useState)({}),$=Object(i.a)(W,2),H=$[0],q=$[1],Y=Object(n.useState)(""),z=Object(i.a)(Y,2),J=z[0],Q=z[1],K=Object(n.useState)(!0),X=Object(i.a)(K,2),Z=X[0],ee=X[1],te=Object(n.useState)(""),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],ce=Object(n.useRef)(),oe=Object(n.useRef)(),se=Object(n.useContext)(O),ie=I();function le(e){M(e),"users"==e&&w.send("getUsers",ne)}Object(n.useLayoutEffect)((function(){return function(){if(ce.current)if(null==oe.current)oe.current=ce.current.scrollHeight;else if(oe.current!=ce.current.scrollHeight){if(0==ce.current.scrollTop){var e=ce.current.scrollHeight*(1-oe.current/ce.current.scrollHeight);ce.current.scrollTop=e-5}oe.current=ce.current.scrollHeight}Z&&ce.current&&(ce.current.scrollTop=ce.current.scrollHeight)}()})),Object(n.useEffect)((function(){!se.loggedIn&&g&&b("")}),[se.loggedIn]),Object(n.useEffect)((function(){if(g){var e;e="".concat("wss","://").concat("ujwcbfwxrqnp.beyondmafia.com","/chatSocket");var t=new jt(e);return t.on("connected",(function(){return u(l+1)})),t.on("disconnected",(function(){return u(l-1)})),N(t),function(){t&&t.clear()}}}),[g]),Object(n.useEffect)((function(){1==w.readyState?(w.send("auth",g),w.on("chatInfo",(function(e){if(C({type:"set",chatInfo:e}),e.rooms&&e.rooms.length>0&&!F){var t=e.rooms[0].id;D(t)}})),w.on("channel",(function(e){_({type:"set",channel:e})})),w.on("message",(function(e){_({type:"message",message:e})})),w.on("oldMessages",(function(e){_({type:"oldMessages",messages:e,messageListRef:ce})})),w.on("users",(function(e){C({type:"users",users:e})})),w.on("newDirectChannel",(function(e){C({type:"directs",channel:e.channel}),e.focus&&(M("directs"),D(e.channel.id),w.send("getChannel",e.channel.id))})),w.on("openDM",(function(e){M("directs"),D(e),w.send("getChannel",e)})),w.on("dateUpdate",(function(e){C({type:"date",channelId:e.channel,date:e.date})})),w.on("newNotif",(function(e){C({type:"addNotif",channelId:e.notif.channelId}),document.hidden&&-1==document.title.indexOf("\ud83d\udd34")&&(document.title=document.title+"\ud83d\udd34")})),w.on("messageDeleted",(function(e){_({type:"deleteMessage",messageId:e})})),w.on("error",(function(e){ie(e)}))):null!=w.readyState&&3!=w.readyState||d.a.get("/chat/connect").then((function(e){b(e.data)})).catch(ie)}),[l]),Object(n.useEffect)((function(){G.id&&(S.notifs.byChannel[G.id]&&w.send("readNotifsInChannel",G.id),C({type:"readNotifs",channelId:G.id}))}),[G]);var ue=S[A];"directs"==A&&(ue=ue.sort(wa)),ue=ue.reduce((function(e,t){if("users"==A&&t.id==se.id)return e;var a="channel";return("users"!=A&&t.id==F||"users"==A&&H[t.id])&&(a+=" sel"),e.push(r.a.createElement(V,{className:a,key:t.id,notifCount:S.notifs.byChannel[t.id],onClick:function(){return e=t.id,void("users"!=A?(w.send("getChannel",e),D(e),ee(!0)):H[e]?q(p()(H,{$unset:[e]})):q(p()(H,Object(v.a)({},e,{$set:!0}))));var e}},r.a.createElement(Ea,{short:!0,channelType:A,channel:t,user:se}))),e}),[]);var me=G.messages.map((function(e){return r.a.createElement(ya,{message:e,socket:w,key:e.id})}));return g&&r.a.createElement(V,{className:"chat-wrapper",notifCount:S.notifs.all},r.a.createElement("div",{className:"top-bar",onClick:function(){c(!a),ee(!0),a?w.send("closedChat"):(F&&w.send("getChannel",F),F&&(S.notifs.byChannel[F]&&w.send("readNotifsInChannel",F),C({type:"readNotifs",channelId:F})))}},r.a.createElement("i",{className:"fas fa-comment"}),r.a.createElement("div",{className:"label"},"Chat")),a&&r.a.createElement("div",{className:"window"},r.a.createElement("div",{className:"left-panel"},r.a.createElement("div",{className:"channel-type-nav"},r.a.createElement(V,{className:"channel-type ".concat("rooms"==A?"sel":""),notifCount:S.notifs.byChannelType.rooms,onClick:function(){return le("rooms")}},"Rooms"),r.a.createElement(V,{className:"channel-type ".concat("directs"==A?"sel":""),notifCount:S.notifs.byChannelType.directs,onClick:function(){return le("directs")}},"Directs"),r.a.createElement("div",{className:"channel-type ".concat("users"==A?"sel":""),onClick:function(){return le("users")}},"Users")),"users"==A&&r.a.createElement("input",{className:"user-search",value:ne,placeholder:"Search",onChange:function(e){var t=e.target.value;re(t),w.send("getUsers",t)}}),r.a.createElement("div",{className:"channel-list"},ue),"users"==A&&Object.keys(H).length>0&&r.a.createElement("div",{className:"create-dm-btn btn btn-theme",onClick:function(){var e=Object.keys(H);w.send("newDMChannel",e),q({})}},r.a.createElement("i",{className:"fas fa-plus"}),"Create DM (",Object.keys(H).length,")")),r.a.createElement("div",{className:"right-panel"},G.id&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"channel-top"},r.a.createElement("div",{className:"channel-name"},r.a.createElement(Ea,{channelType:G.public?"rooms":"directs",channel:G,user:se})),!G.public&&r.a.createElement("i",{className:"close-dm fas fa-times",onClick:function(){return e=G.id,w.send("closeDM",e),D(null),_({type:"clear"}),void C({type:"remove",channelType:A,channelId:e});var e}})),r.a.createElement("div",{className:"channel-messages",ref:ce,onScroll:function(){var e=ce.current;Math.round(e.scrollTop+e.clientHeight)>=Math.round(e.scrollHeight)?ee(!0):(ee(!1),0==e.scrollTop&&w.send("getOldMessages",G.messages[0].date))}},me),r.a.createElement("div",{className:"channel-input-wrapper"},r.a.createElement("input",{className:"channel-input",value:J,maxLength:240,onChange:function(e){return Q(e.target.value)},onKeyPress:function(e){if("Enter"==e.key&&J.length){var t=e.target.value;w.send("sendMessage",t),Q(""),ee(!0)}}}))))))}function ya(e){var t=e.message,a=e.socket,c=Object(n.useState)(!1),o=Object(i.a)(c,2),s=o[0],l=o[1],u=Object(n.useState)({}),m=Object(i.a)(u,2),d=m[0],f=m[1],p=Object(n.useRef)(),h=Object(n.useRef)(),v=Object(n.useContext)(O),g=t.sender.id==v.id,b=Date.now()-t.date;return W(p,(function(){return l(!1)})),Object(n.useEffect)((function(){if(h.current){var e=p.current.getBoundingClientRect();h.current.style.top=d.y-e.top+"px",g?h.current.style.right=e.right-d.x+"px":h.current.style.left=d.x-e.left+"px",h.current.style.visibility="visible"}}),[d]),r.a.createElement("div",{className:"message ".concat(g?"self":"")},r.a.createElement("div",{className:"info"},!g&&r.a.createElement(Le,{small:!0,id:t.sender.id,name:t.sender.name,avatar:t.sender.avatar,color:t.sender.settings&&t.sender.settings.nameColor}),b>6e4&&r.a.createElement("div",{className:"timestamp"},r.a.createElement(B,{millisec:b,suffix:" ago"}))),r.a.createElement("div",{className:"content",style:t.sender.settings&&t.sender.settings.textColor?{color:t.sender.settings.textColor}:{},onContextMenu:function(e){"contextmenu"==e.type&&(e.preventDefault(),l(!0),f({x:e.clientX,y:e.clientY}))},ref:p},r.a.createElement(U,{text:t.content,settings:v.settings,filterProfanity:!0,linkify:!0,emotify:!0})),s&&(v.id==t.sender.id||v.perms.deleteChatMessage)&&r.a.createElement("div",{className:"context",ref:h},r.a.createElement("div",{className:"item",onClick:function(){a.send("deleteMessage",t.id)}},"Delete")))}function Ea(e){var t=e.channelType,a=e.channel,n=e.user,c=e.short;switch(t){case"rooms":return a.name;case"directs":if(c){var o=a.members.filter((function(e){return e.id!=n.id})).map((function(e){return e.name})),s=o.join(", ");return o.length>1&&s.length>20&&(s=s.slice(0,17)+"..."),s}return a.members.filter((function(e){return e.id!=n.id})).map((function(e){return r.a.createElement(Le,{small:!0,id:e.id,name:e.name,avatar:e.avatar,key:e.id})}));case"users":return r.a.createElement(r.a.Fragment,null,r.a.createElement(Le,{small:!0,noLink:!0,id:a.id,name:a.name,avatar:a.avatar}),r.a.createElement(Ae,{status:a.status}))}}function wa(e,t){return t.lastMessageDate-e.lastMessageDate}a(448);function Oa(){Oa=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var c=t&&t.prototype instanceof d?t:d,o=Object.create(c.prototype),s=new k(r||[]);return n(o,"_invoke",{value:w(e,a,s)}),o}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,c,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==t&&a.call(g,c)&&(h=g);var b=p.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,c){function o(){return new t((function(r,o){!function n(r,c,o,s){var i=u(e[r],e,c);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(m).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(i.arg)}(n,c,r,o)}))}return r=r?r.then(o,o):o()}})}function w(e,t,a){var n="suspendedStart";return function(r,c){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw c;return C()}for(a.method=r,a.arg=c;;){var o=a.delegate;if(o){var s=O(o,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var c=r.arg;return c?c.done?(t[e.resultName]=c.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):c:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function S(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(E.prototype),i(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,c){void 0===c&&(c=Promise);var o=new E(l(t,a,n,r),c);return e.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(b),i(b,s,"Generator"),i(b,c,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return o.type="throw",o.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r],o=c.completion;if("root"===c.tryLoc)return n("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),i=a.call(c,"finallyLoc");if(s&&i){if(this.prev<c.catchLoc)return n(c.catchLoc,!0);if(this.prev<c.finallyLoc)return n(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return n(c.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return n(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var c=r;break}}c&&("break"===e||"continue"===e)&&c.tryLoc<=t&&t<=c.finallyLoc&&(c=null);var o=c?c.completion:{};return o.type=e,o.arg=t,c?(this.method="next",this.next=c.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),j(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;j(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function Na(e){var t=Object(n.useContext)(O);return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"nav-wrapper left"},r.a.createElement(Q,null,r.a.createElement(s.c,{to:"/play"},"Lobby"),r.a.createElement(s.c,{to:"/community"},"Community"))),r.a.createElement(s.b,{to:"/",className:"logo-wrapper"},r.a.createElement("div",{className:"logo"})),r.a.createElement("div",{className:"nav-wrapper right"},r.a.createElement(Q,null,r.a.createElement("a",{href:"https://beyondmafia.fandom.com",target:"_blank"},"Wiki"),!t.loggedIn&&r.a.createElement(s.c,{to:"/auth",className:"nav-link"},"Log In"),t.loggedIn&&r.a.createElement("div",{className:"user-wrapper"},r.a.createElement(ja,null),r.a.createElement(s.b,{to:"/user",className:"profile-link"},r.a.createElement(Te,{id:t.id,name:t.name,hasImage:t.avatar}))))))}function ja(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"add":var n=e.notifs.map((function(e){return e.id})),r=t.notifs.filter((function(e){return-1==n.indexOf(e.id)}));a=p()(e,{notifs:{$set:r.concat(e.notifs)},unread:{$set:e.unread+r.length}});break;case"viewed":a=p()(e,{unread:{$set:0}})}return a||e}),{notifs:[],unread:0}),l=Object(i.a)(o,2),m=l[0],f=l[1],h=Object(n.useState)(),v=Object(i.a)(h,2),g=v[0],b=v[1],y=Object(n.useContext)(N),E=Object(u.g)(),w=Object(n.useRef)(),O=Object(n.useRef)();function j(){d.a.get("/notifs").then((function(e){var t=e.data[0],a=e.data.slice(1);b(t),f({type:"add",notifs:a})})).catch((function(){}))}function k(){d.a.post("/notifs/viewed").then((function(){f({type:"viewed"})})).catch((function(){}))}W([w,O],(function(){return c(!1)})),Object(n.useEffect)((function(){j();var e=setInterval((function(){return j()}),1e4);return function(){return clearInterval(e)}}),[]),Object(n.useEffect)((function(){a&&k()}),[m.notifs]),Object(n.useEffect)((function(){if(g&&g>Date.now()){var e=Math.ceil((g-Date.now())/1e3/60);y.showAlert("The server will be restarting in ".concat(e," minutes."),"basic",!0)}}),[g]),Object(n.useLayoutEffect)((function(){if(a){var e=O.current.getBoundingClientRect(),t=e.left+e.width;t>window.innerWidth&&(O.current.style.left=window.innerWidth-t+"px"),O.current.style.visibility="visible"}}));var S=m.notifs.map((function(e){return r.a.createElement(s.b,{className:"notif",key:e.id,to:e.link,onClick:function(t){return function(e,t){t.link?window.location.pathname==t.link.split("?")[0]&&E.go(0):e.preventDefault()}(t,e)}},e.icon&&r.a.createElement("i",{className:"fas fa-".concat(e.icon)}),r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"time"},r.a.createElement(B,{millisec:Date.now()-e.date,suffix:" ago"})),r.a.createElement("div",{className:"content"},e.content)))}));return r.a.createElement("div",{className:"notifs-wrapper"},r.a.createElement(V,{lOffset:!0,notifCount:m.unread,onClick:function(){c(!a),!a&&m.unread>0&&k()},fwdRef:w},r.a.createElement("i",{className:"fas fa-bell"})),a&&r.a.createElement("div",{className:"notif-list",ref:O},S,0==S.length&&"No unread notifications"))}function ka(){var e=(new Date).getYear()+1900;return r.a.createElement("div",{className:"footer"},r.a.createElement("div",{className:"footer-inner"},r.a.createElement("p",null,"\xa9 ",e," BeyondMafia")))}var Sa=function(){var e=window.localStorage.getItem("cacheVal");e||(e=Date.now(),window.localStorage.setItem("cacheVal",e));var t=function(){var e=Object(n.useState)({loggedIn:!1,loaded:!1,perms:{},rank:0,blockedUsers:[],settings:{},itemsOwned:{}}),t=Object(i.a)(e,2),a=t[0],r=t[1];return Object(h.a)(Object(h.a)({},a),{},{state:a,set:r,blockUserToggle:function(e){var t=a.blockedUsers.indexOf(e);r(-1==t?p()(a,{blockedUsers:{$push:[e]}}):p()(a,{blockedUsers:{$splice:[[t,1]]}}))},updateSetting:function(e,t){r(p()(a,{settings:Object(v.a)({},e,{$set:t})}))},clear:function(){r({loggedIn:!1,loaded:!0,perms:{},rank:0,blockedUsers:[]})}})}(),a=S({alerts:[],cacheVal:e}),c=va(a),o=I(a);function m(e){d.a.post("/game/leave").then((function(){a.hideAlert(e)})).catch(o)}return Object(n.useEffect)((function(){function e(){return(e=Object(l.a)(Oa().mark((function e(){var n,c;return Oa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get("/user/info");case 3:return(n=e.sent).data.id?(d.a.defaults.headers.common["x-csrf"]=n.data.csrf,d.a.post("/user/online"),n.data.loggedIn=!0,n.data.loaded=!0,n.data.rank=Number(n.data.rank),t.set(n.data),(c=window.localStorage.getItem("referrer"))&&(d.a.post("/user/referred",{referrer:c}),window.localStorage.removeItem("referrer"))):t.clear(),0==n.data.nameChanged&&a.showAlert((function(){return r.a.createElement("div",null,"New account created, you can change your username once in your ",r.a.createElement(s.b,{to:"/user/settings"},"settings"),".")}),"basic",!0),n.data.inGame&&a.showAlert((function(e){return r.a.createElement("div",null,"Return to game ",r.a.createElement(s.b,{to:"/game/".concat(n.data.inGame)},n.data.inGame)," or ",r.a.createElement("a",{onClick:function(){return m(e)}},"leave"),".")}),"basic",!0),e.next=9,d.a.get("/roles/all");case 9:n=e.sent,a.update("roles",n.data),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),o(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}();var n=setInterval((function(){d.a.post("/user/online")}),3e4);return function(){clearInterval(n)}}),[]),r.a.createElement(O.Provider,{value:t},r.a.createElement(N.Provider,{value:a},r.a.createElement(j.Provider,{value:c},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/game"},r.a.createElement(St,null)),r.a.createElement(u.b,{path:"/"},r.a.createElement("div",{className:"site-wrapper"},r.a.createElement("div",{className:"main-container"},r.a.createElement(Na,null),r.a.createElement("div",{className:"inner-container"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/play",render:function(){return r.a.createElement(ut,null)}}),r.a.createElement(u.b,{path:"/community",render:function(){return r.a.createElement(ra,null)}}),r.a.createElement(u.b,{path:"/auth",render:function(){return r.a.createElement(ma,null)}}),r.a.createElement(u.b,{path:"/user",render:function(){return r.a.createElement(Ie,null)}}),r.a.createElement(u.b,{path:"/legal",render:function(){return r.a.createElement(pa,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/play"})}}))),r.a.createElement(ka,null),r.a.createElement(C,null),r.a.createElement(ba,null))))),r.a.createElement(ha,null))))};o.a.render(r.a.createElement(s.a,null,r.a.createElement(Sa,null)),document.getElementById("root"))},51:function(e,t,a){},66:function(e,t,a){}},[[165,1,2]]]);
//# sourceMappingURL=main.35a0714a.chunk.js.map