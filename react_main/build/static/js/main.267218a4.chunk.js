/*! For license information please see main.267218a4.chunk.js.LICENSE.txt */
(this.webpackJsonpreact_main=this.webpackJsonpreact_main||[]).push([[0],{119:function(e,t,a){},124:function(e,t,a){},165:function(e,t,a){},166:function(e,t,a){},177:function(e,t,a){e.exports=a(473)},198:function(e,t,a){},199:function(e,t,a){},229:function(e,t,a){},455:function(e,t,a){},456:function(e,t,a){},457:function(e,t,a){},458:function(e,t,a){},459:function(e,t,a){},460:function(e,t,a){},461:function(e,t,a){},462:function(e,t,a){},463:function(e,t,a){},464:function(e,t,a){},465:function(e,t,a){},466:function(e,t,a){},467:function(e,t,a){},468:function(e,t,a){},469:function(e,t,a){},470:function(e,t,a){},471:function(e,t,a){},472:function(e,t,a){},473:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(58),s=a.n(o),c=a(13),i=a(3),l=a(4),u=a(38),m=a(5),d=a.n(m),f=a(12),p=a.n(f),h=a(14),g=a(2),v=["Mafia","Split Decision","Resistance","One Night"],y=["Main","Sandbox","Competitive","Games"],b={Mafia:["Village","Mafia","Monsters","Independent"],"Split Decision":["Blue","Red","Independent"],Resistance:["Resistance","Spies"],"One Night":["Village","Werewolves","Independent"]},E={Mafia:["Day","Night"],"Split Decision":["Initial Round","Hostage Swap"],Resistance:["Team Selection","Team Approval","Mission"],"One Night":["Day","Night"]},w={reads:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5},survival:{S:.95,A:.9,B:.8,C:.7,D:.6,E:.5},wins:{}},O=r.a.createContext(),k=r.a.createContext(),N=r.a.createContext(),j=r.a.createContext();function S(e){var t=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"setProp":e[t.prop]!=t.value&&(a=p()(e,Object(g.a)({},t.prop,{$set:t.value})));break;case"showAlert":"function"==typeof t.text&&(t.text=t.text(e.alerts.length)),a=p()(e,{alerts:{$push:[{text:t.text,type:t.alertType||"",id:t.id}]}});break;case"hideAlert":a=p()(e,{alerts:{$splice:[[t.index,1]]}});break;case"hideAlertById":for(var n=0;n<e.alerts.length;n++)if(e.alerts[n].id==t.id){a=p()(e,{alerts:{$splice:[[n,1]]}});break}break;case"hideAllAlerts":a=p()(e,{alerts:{$set:[]}})}return a||e}),e),a=Object(i.a)(t,2),r=a[0],o=a[1];function s(e,t){o({type:"setProp",prop:e,value:t})}return Object(h.a)(Object(h.a)({},r),{},{update:s,showAlert:function(e,t,a){var n=Math.random();o({type:"showAlert",text:e,alertType:t,id:n}),a||setTimeout((function(){return function(e){var t=document.getElementById("alert-id-".concat(e));if(!t)return;t.style.opacity=0,setTimeout((function(){o({type:"hideAlertById",id:e})}),500)}(n)}),3e3)},hideAlert:function(e){o({type:"hideAlert",index:e})},hideAllAlerts:function(){o({type:"hideAllAlerts"})},clearCache:function(){var e=Date.now();s("cacheVal",e),window.localStorage.setItem("cacheVal",e)}})}a(198);function C(e){var t=Object(n.useContext)(k),a=t.alerts.map((function(e,a){return r.a.createElement(x,{id:e.id,index:a,text:e.text,type:e.type,onHide:t.hideAlert,key:e.id})}));return r.a.createElement("div",{className:"alert-list"},a)}function x(e){return r.a.createElement("div",{id:"alert-id-".concat(e.id),className:"alert alert-".concat(e.type)},r.a.createElement("i",{className:"hide-alert fa-times-circle fas",onClick:function(){return e.onHide(e.index)}}),e.text)}function I(e){var t=Object(n.useContext)(k);return e=e||t,function(t){var a;(a=t&&t.response?t.response.data:t&&t.message?t.message:"string"==typeof t?t:"Error loading data").length>200&&(a="Connection error"),e.showAlert(a,"error")}}var L,T=a(11);a(119);function A(e){var t=e.emote.toLowerCase(),a=F[t];return r.a.createElement("div",{className:"emote",title:a.name,style:{backgroundImage:"url('/images/emotes/".concat(a.name.toLowerCase(),".").concat(a.type,"')")}})}function M(e){if(null!=e){for(var t in Array.isArray(e)||(e=[e]),e){var a=e[t];if("string"==typeof a){var n=a.split(" ");for(var o in n){var s=n[o].toLowerCase();F[s]?n[o]=r.a.createElement(A,{emote:s}):n[o]=n[o]+" "}e[t]=n}}return 1==(e=e.flat()).length?e[0]:e}}var R,P,F=(L={"-_-":{name:"expressionless",type:"png"},"-@":{name:"jack",type:"png"},";_;":{name:"cry",type:"png"},";)":{name:"wink",type:"png"},":(":{name:"sad",type:"png"},":)":{name:"happy",type:"png"},":@":{name:"cthulhu",type:"png"},":|":{name:"neutral",type:"png"},":3":{name:"candy",type:"png"},":awoo:":{name:"awoo",type:"png"},":bats:":{name:"bats",type:"png"},":birb:":{name:"birb",type:"gif"},":boar:":{name:"boar",type:"png"},":bob:":{name:"bob",type:"gif"},":bub:":{name:"bub",type:"gif"},":bum:":{name:"bum",type:"gif"},":bump:":{name:"bump",type:"png"},":bunny:":{name:"bunny",type:"png"},":cake:":{name:"cake",type:"png"},":candycane:":{name:"candycane",type:"png"},":cat:":{name:"cat",type:"png"},":catjam:":{name:"catjam",type:"gif"},":cavebob:":{name:"cavebob",type:"png"},":chick:":{name:"chick",type:"png"},":christmas:":{name:"christmas",type:"png"},":clock:":{name:"clock",type:"png"},":cookie:":{name:"cookie",type:"png"},":couldyounot:":{name:"couldyounot",type:"gif"},":cupcake:":{name:"cupcake",type:"png"},":ditto:":{name:"ditto",type:"gif"},":doge:":{name:"doge",type:"png"},":eee:":{name:"eee",type:"png"},":ez:":{name:"EZ",type:"png"},":feelsdankman:":{name:"FeelsDankMan",type:"png"},":feelsokayman:":{name:"FeelsOkayMan",type:"png"},":fox:":{name:"fox",type:"png"},":fufu:":{name:"fufu",type:"png"},":gay:":{name:"gay",type:"png"},":ghost:":{name:"ghost",type:"png"},":hammer:":{name:"hammer",type:"png"},":hamster:":{name:"hamster",type:"gif"},":horse:":{name:"horse",type:"png"},":kapp:":{name:"Kapp",type:"png"},":kekm:":{name:"kekm",type:"png"},":knife:":{name:"knife",type:"png"},":lion:":{name:"lion",type:"png"},":lmao:":{name:"lmao",type:"png"},":mermaid:":{name:"mermaid",type:"png"},":monkagun:":{name:"MonkaGun",type:"png"},":monkahmm:":{name:"MonkaHmm",type:"png"},":monkas:":{name:"MonkaS",type:"png"},":monkfade:":{name:"monkfade",type:"gif"},":monkspin:":{name:"monkspin",type:"gif"},":nodders:":{name:"Nodders",type:"gif"},":nopers:":{name:"Nopers",type:"gif"},":o":{name:"surprised",type:"png"},":omegalul:":{name:"Omegalul",type:"png"},":omg:":{name:"omg",type:"png"},":p":{name:"tongue",type:"png"},":panda:":{name:"panda",type:"png"},":peepohappy:":{name:"PeepoHappy",type:"png"},":peeposad:":{name:"PeepoSad",type:"png"},":peepowtf:":{name:"PeepoWtf",type:"png"},":penguin:":{name:"penguin",type:"png"},":pepeawooga:":{name:"awooga128",type:"png"},":pepega:":{name:"Pepega",type:"png"},":pepegaaim:":{name:"PepegaAim",type:"gif"},":pepehands:":{name:"PepeHands",type:"png"},":pepelaugh:":{name:"PepeLaugh",type:"png"},":pepemeltdown:":{name:"PepeMeltdown",type:"gif"},":pepepains:":{name:"PepePains",type:"png"},":pepepls:":{name:"PepePls",type:"gif"},":pepereee:":{name:"reeeee1",type:"png"},":pepog:":{name:"PepoG",type:"png"},":pingu:":{name:"pingu",type:"gif"},":pizza:":{name:"pizza",type:"png"},":quiggle:":{name:"quiggle",type:"png"},":rainbow:":{name:"rainbow",type:"png"},":rainbowdoge:":{name:"rainbowdoge",type:"png"},":ratjam:":{name:"ratjam",type:"gif"},":rip:":{name:"rip",type:"png"},":roach:":{name:"roach",type:"gif"},":rose:":{name:"rose",type:"png"},":sadge:":{name:"Sadge",type:"png"},":sandbox:":{name:"sandbox",type:"png"},":santa:":{name:"santa",type:"png"},":sheep:":{name:"sheep",type:"png"},":shotgun:":{name:"shotgun",type:"png"},":snake:":{name:"snake",type:"png"},":snowman:":{name:"snowman",type:"png"},":star:":{name:"star",type:"png"},":swag:":{name:"swag",type:"gif"},":sy0a:":{name:"sy0a",type:"png"},":sy0b:":{name:"sy0b",type:"png"},":sy0c:":{name:"sy0c",type:"png"},":sy0d:":{name:"sy0d",type:"png"},":sy0e:":{name:"sy0e",type:"png"},":sy0f:":{name:"sy0f",type:"png"},":sy0g:":{name:"sy0g",type:"png"},":sy0h:":{name:"sy0h",type:"png"},":sy0i:":{name:"sy0i",type:"png"},":sy1a:":{name:"sy1a",type:"png"},":sy1b:":{name:"sy1b",type:"png"},":sy1c:":{name:"sy1c",type:"png"},":sy1d:":{name:"sy1d",type:"png"},":sy1e:":{name:"sy1e",type:"png"},":sy1f:":{name:"sy1f",type:"png"},":sy1g:":{name:"sy1g",type:"png"},":sy1h:":{name:"sy1h",type:"png"},":sy1i:":{name:"sy1i",type:"png"},":sy2a:":{name:"sy2a",type:"png"},":sy2b:":{name:"sy2b",type:"png"},":sy2c:":{name:"sy2c",type:"png"},":sy2d:":{name:"sy2d",type:"png"},":sy2e:":{name:"sy2e",type:"png"},":sy2f:":{name:"sy2f",type:"png"},":sy2g:":{name:"sy2g",type:"png"},":sy2h:":{name:"sy2h",type:"png"},":sy2i:":{name:"sy2i",type:"png"},":sy3a:":{name:"sy3a",type:"png"},":sy3b:":{name:"sy3b",type:"png"},":sy3c:":{name:"sy3c",type:"png"},":sy3d:":{name:"sy3d",type:"png"},":sy3e:":{name:"sy3e",type:"png"},":sy3f:":{name:"sy3f",type:"png"},":sy3g:":{name:"sy3g",type:"png"},":sy3h:":{name:"sy3h",type:"png"},":sy3i:":{name:"sy3i",type:"png"},":sy4a:":{name:"sy4a",type:"png"},":sy4b:":{name:"sy4b",type:"png"},":sy4c:":{name:"sy4c",type:"png"},":sy4d:":{name:"sy4d",type:"png"},":sy4e:":{name:"sy4e",type:"png"},":sy4f:":{name:"sy4f",type:"png"},":sy4g:":{name:"sy4g",type:"png"},":sy4h:":{name:"sy4h",type:"png"},":sy4i:":{name:"sy4i",type:"png"},":sy5a:":{name:"sy5a",type:"png"},":sy5b:":{name:"sy5b",type:"png"},":sy5c:":{name:"sy5c",type:"png"},":sy5d:":{name:"sy5d",type:"png"},":sy5e:":{name:"sy5e",type:"png"},":sy5f:":{name:"sy5f",type:"png"},":sy5g:":{name:"sy5g",type:"png"},":sy5h:":{name:"sy5h",type:"png"},":sy5i:":{name:"sy5i",type:"png"},":sy6a:":{name:"sy6a",type:"png"},":sy6b:":{name:"sy6b",type:"png"},":sy6c:":{name:"sy6c",type:"png"},":sy6d:":{name:"sy6d",type:"png"},":sy6e:":{name:"sy6e",type:"png"},":sy6f:":{name:"sy6f",type:"png"},":sy6g:":{name:"sy6g",type:"png"},":sy6h:":{name:"sy6h",type:"png"},":sy6i:":{name:"sy6i",type:"png"},":sy7a:":{name:"sy7a",type:"png"},":sy7b:":{name:"sy7b",type:"png"},":sy7c:":{name:"sy7c",type:"png"},":sy7d:":{name:"sy7d",type:"png"},":sy7e:":{name:"sy7e",type:"png"},":sy7f:":{name:"sy7f",type:"png"},":sy7g:":{name:"sy7g",type:"png"},":sy7h:":{name:"sy7h",type:"png"},":sy7i:":{name:"sy7i",type:"png"},":sy8a:":{name:"sy8a",type:"png"},":sy8b:":{name:"sy8b",type:"png"},":sy8c:":{name:"sy8c",type:"png"},":sy8d:":{name:"sy8d",type:"png"},":sy8e:":{name:"sy8e",type:"png"},":sy8f:":{name:"sy8f",type:"png"},":sy8g:":{name:"sy8g",type:"png"},":sy8h:":{name:"sy8h",type:"png"},":sy8i:":{name:"sy8i",type:"png"},":sy9a:":{name:"sy9a",type:"png"}},Object(g.a)(L,":sy9a:",{name:"sy9a",type:"png"}),Object(g.a)(L,":sy9b:",{name:"sy9b",type:"png"}),Object(g.a)(L,":sy9c:",{name:"sy9c",type:"png"}),Object(g.a)(L,":sy9d:",{name:"sy9d",type:"png"}),Object(g.a)(L,":sy9e:",{name:"sy9e",type:"png"}),Object(g.a)(L,":taco:",{name:"taco",type:"gif"}),Object(g.a)(L,":thomas:",{name:"thomasoface",type:"png"}),Object(g.a)(L,":thonk:",{name:"thonk",type:"png"}),Object(g.a)(L,":tiger:",{name:"tiger",type:"png"}),Object(g.a)(L,":tip:",{name:"tip",type:"gif"}),Object(g.a)(L,":tipb:",{name:"tipb",type:"gif"}),Object(g.a)(L,":tmnt:",{name:"tmnt",type:"gif"}),Object(g.a)(L,":turkey:",{name:"turkey",type:"png"}),Object(g.a)(L,":unicorn:",{name:"unicorn",type:"png"}),Object(g.a)(L,":werewolf:",{name:"werewolf",type:"png"}),Object(g.a)(L,":wink:",{name:"wink",type:"png"}),Object(g.a)(L,":wolf:",{name:"wolf",type:"png"}),Object(g.a)(L,":yum:",{name:"yum",type:"gif"}),Object(g.a)(L,":zzz:",{name:"zzz",type:"png"}),Object(g.a)(L,"<3",{name:"heart",type:"png"}),Object(g.a)(L,">:(",{name:"frown",type:"png"}),Object(g.a)(L,"o_o",{name:"confused",type:"png"}),Object(g.a)(L,"zzz",{name:"zzz",type:"png"}),L),D=(Object.keys(F),a(105));function B(e){return e.map((function(e){return e.split("").join(String.raw(R||(R=Object(D.a)(["+([^A-Z]|s)*"],["+([^A-Z]|\\s)*"])))).concat("+")})).map((function(e){return new RegExp(String.raw(P||(P=Object(D.a)(["\b[^A-Z]*((",")+s*)+[^A-Z]*\b"],["\\b[^A-Z]*((",")+s*)+[^A-Z]*\\b"])),e),"i")}))}var V=B(["abo","chink","coon","dago","fag","faggot","gook","jap","kike","mong","nazi","nigga","nigger","paki","retard","spastic","spic","trannie","tranny","wetback","wog"]),U=B(["ass","asshole","bitch","bitches","cock","cunt","dick","fuck","fucked","fucking","pussy","shit","slut","tit","wanker","whore"]),G={0:"o",1:"i",2:"z",3:"e",4:"a",5:"s",6:"g",7:"t",8:"b",9:"g"};function _(e,t,a){var n;switch(e){case"slurs":n=V;break;case"swears":n=U;break;default:return t}var r=t;for(var o in G)r=r.replaceAll(o,G[o]);var s,c=Object(T.a)(n);try{for(c.s();!(s=c.n()).done;)for(var i=s.value,l=i.exec(r);l;){var u=l.index+l[0].indexOf(l[1]),m=l[1].length;t=t.slice(0,u)+a.repeat(m)+t.slice(u+m),r=r.slice(0,u)+a.repeat(m)+r.slice(u+m),l=i.exec(r)}}catch(d){c.e(d)}finally{c.f()}return t}function W(e){var t=e.items.map(e.map);return r.a.createElement("div",{className:"item-list ".concat(e.className||"")},t)}function H(e){var t=e.panels.map((function(e,t){return r.a.createElement("div",{className:"box-panel",key:t},r.a.createElement("div",{className:"heading"},e.icon,r.a.createElement("div",{className:"heading-text"},e.name)),r.a.createElement("div",{className:"content"},e.text))}));return r.a.createElement("div",{className:"panel-grid"},t)}function $(e){for(var t="millisecond",a=e.millisec,n=e.suffix||"",r=e.minSec,o=[{name:"second",scale:1e3},{name:"minute",scale:60},{name:"hour",scale:60},{name:"day",scale:24},{name:"week",scale:7},{name:"year",scale:52}],s=0;s<o.length-1&&a>=o[s].scale;)a/=o[s].scale,t=o[s].name,s++;return r&&"millisecond"==t?"Less than a second".concat(n):((a=Math.floor(a))>1&&(t+="s"),"".concat(a," ").concat(t).concat(n))}function Y(e){var t=e.notifCount,a=e.onClick,n=e.lOffset;return r.a.createElement("div",{className:"notif-bound ".concat(e.className||""),onClick:a,ref:e.fwdRef},t>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-circle notif-icon ".concat(n?"l-offset":"")},r.a.createElement("div",{className:"notif-count"},t))),e.children)}function z(e){var t=Object(n.useState)(e.text),a=Object(i.a)(t,2),o=a[0],s=a[1];return Object(n.useEffect)((function(){if(null!=e.text){var t=e.text;e.filterProfanity&&(t=q(t,e.settings,e.profChar)),e.linkify&&(t=function(e){if(null==e)return;Array.isArray(e)||(e=[e]);var t=/http(s{0,1}):\/\/([\w.]+)\.(\w+)([^\s]*)/g;for(var a in e){for(var n=e[a],o=[],s=0,c=t.exec(n);c;)o.push(n.slice(s,c.index)),o.push(r.a.createElement("a",{href:c[0],target:"blank",key:s},c[0])),s=t.lastIndex,c=t.exec(n);o.push(n.slice(s,n.length)),e[a]=o}return 1==(e=e.flat()).length?e[0]:e}(t)),e.emotify&&(t=M(t)),e.iconUsername&&(t=function(e,t){if(null==e)return;Array.isArray(e)||(e=[e]);for(var a in e){var n=e[a];if("string"==typeof n){var o=n.trim().split(" ");for(var s in o){var c=o[s],i=!1;c.length>1&&"%"===c.charAt(0)&&function(){var e=c.substring(1),a=Object.values(t).find((function(t){return t.name===e}));a&&a.avatar&&(i=!0,o[s]=r.a.createElement(K,{url:"url(/uploads/".concat(a.userId,"_avatar.jpg)"),username:a.name}))}(),i||(o[s]=o[s]+" ")}e[a]=o}}return 1==(e=e.flat()).length?e[0]:e}(t,e.players)),s(t)}}),[e.text]),o}function q(e,t,a){if(null!=e){for(var n in Array.isArray(e)||(e=[e]),t=t||{},e){var r=e[n];"string"==typeof r&&(a=a||"*",t.disablePg13Censor||(r=_("swears",r,a)),t.disableAllCensors||(r=_("slurs",r,a)),e[n]=r)}return 1==(e=e.flat()).length?e[0]:e}}function K(e){return r.a.createElement("div",{className:"avatar small inline",title:e.username,style:{backgroundImage:e.url}})}function J(e,t){function a(a){var n,r=Object(T.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!o||!o.current||o.current.contains(a.target))return}}catch(s){r.e(s)}finally{r.f()}t()}Array.isArray(e)||(e=[e]),Object(n.useEffect)((function(){return document.addEventListener("click",a),document.addEventListener("contextmenu",a),function(){document.removeEventListener("click",a)}}),e)}function Q(e){var t=X(),a=Object(i.a)(t,4),n=a[0],o=a[1],s=a[2],c=a[3],l=e.options.filter((function(t){return t==e.value||t.id==e.value}))[0],u=l?l.label||l:"",m=e.options.map((function(t){return"divider"==t?r.a.createElement("div",{className:"dropdown-divider"}):("string"==typeof t&&(t={id:t,label:t}),r.a.createElement("div",{className:"dropdown-menu-option",key:t.id,onClick:function(){return a=t.id,o(!1),void e.onChange(a);var a}},t.label," ",t.placeholder))}));return r.a.createElement("div",{className:"dropdown ".concat(e.className||""),ref:s},r.a.createElement("div",{className:"dropdown-control",onClick:function(){o(!n)}},e.icon,u,e.caret&&r.a.createElement("i",{className:"fas fa-caret-down"})),n&&r.a.createElement("div",{className:"dropdown-menu",ref:c},m))}function X(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],o=Object(n.useRef)(),s=Object(n.useRef)();return J([s,o],(function(){return r(!1)})),Object(n.useLayoutEffect)((function(){if(a){var e=o.current.getBoundingClientRect(),t=s.current.getBoundingClientRect(),n=e.left,r=e.top+e.height+1+window.scrollY,c=window.innerWidith-(n+t.width);r+t.height-window.scrollY>window.innerHeight&&(r=e.top-t.height-2),c<0?n+c<0&&(c-=n+c):c=0,s.current.style.left=n+"px",s.current.style.top=r+"px",s.current.style.visibility="visible"}})),[a,r,o,s]}var Z=a(106);function ee(){ee=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),c=new j(r||[]);return n(s,"_invoke",{value:w(e,a,c)}),s}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(S([])));v&&v!==t&&a.call(v,o)&&(h=v);var y=p.prototype=d.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function s(){return new t((function(r,s){!function n(r,o,s,c){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(m).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(i.arg)}(n,o,r,s)}))}return r=r?r.then(s,s):s()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return C()}for(a.method=r,a.arg=o;;){var s=a.delegate;if(s){var c=O(s,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(E.prototype),i(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var s=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),i(y,c,"Generator"),i(y,o,(function(){return this})),i(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return s.type="throw",s.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(c&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),N(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;N(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function te(e){e=e.slice();for(var t=0;t<e.length;t++)" "==e[t]&&(e=e.replace(" ","-"));return e}function ae(e){var t=0,a="light",n=!1;if(0===document.documentElement.classList.length?n=!0:document.documentElement.classList.contains("light-mode")||(document.documentElement.classList.contains("dark-mode")?a="dark":n=!0),n&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(a="dark"),"light"===a){if((t=Object(Z.a)(e,"#ffffff"))<1.5)return"darkest";if(t<=2.5)return"darker";if(t<=4.5)return"dark"}else{if((t=Object(Z.a)(e,"#181a1b"))<1.5)return"brightest";if(t<=2.5)return"brighter";if(t<=4.5)return"bright"}return""}function ne(e){var t=function(e){void 0==e&&(e="#000000");var t=0,a=0,n=0;4==e.length?(t="0x"+e[1]+e[1],a="0x"+e[2]+e[2],n="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],a="0x"+e[3]+e[4],n="0x"+e[5]+e[6]),t/=255,a/=255,n/=255;var r=Math.min(t,a,n),o=Math.max(t,a,n),s=o-r,c=0,i=0;return c=0==s?0:o==t?(a-n)/s%6:o==a?(n-t)/s+2:(t-a)/s+4,(c=Math.round(60*c))<0&&(c+=360),i=(o+r)/2,c+","+ +(100*(0==s?0:s/(1-Math.abs(2*i-1)))).toFixed(1)+","+(i=+(100*i).toFixed(1))}(e),a=t.split(","),n=(a[0],a[1],a[2]),r="light",o=!1;if(0===document.documentElement.classList.length?o=!0:document.documentElement.classList.contains("light-mode")||(document.documentElement.classList.contains("dark-mode")?r="dark":o=!0),o&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(r="dark"),n>70&&"light"===r){var s=n-70;t=t.replace(/[0-9.]+(?!.*[0-9])/,String(parseInt(t.match(/[0-9.]+(?!.*[0-9])/)-s,10)))}else if(n<30&&"dark"===r){s=30-n;t=t.replace(/[0-9.]+(?!.*[0-9])/,String(s+parseInt(t.match(/[0-9.]+(?!.*[0-9])/),10)))}return function(e,t,a){t/=100,a/=100;var n=(1-Math.abs(2*a-1))*t,r=n*(1-Math.abs(e/60%2-1)),o=a-n/2,s=0,c=0,i=0;return 0<=e&&e<60?(s=n,c=r,i=0):60<=e&&e<120?(s=r,c=n,i=0):120<=e&&e<180?(s=0,c=n,i=r):180<=e&&e<240?(s=0,c=r,i=n):240<=e&&e<300?(s=r,c=0,i=n):300<=e&&e<360&&(s=n,c=0,i=r),s=Math.round(255*(s+o)).toString(16),c=Math.round(255*(c+o)).toString(16),i=Math.round(255*(i+o)).toString(16),1==s.length&&(s="0"+s),1==c.length&&(c="0"+c),1==i.length&&(i="0"+i),"#"+s+c+i}((a=t.split(","))[0],a[1],n=a[2])}function re(e){for(var t=e.toLowerCase().split(" "),a="",n=0;n<t.length;n++)a+=0==n?t[n]:t[n].charAt(0).toUpperCase()+t[n].substring(1);return a}function oe(e,t,a){for(;e.length<t;)e=a+e;return e}function se(e){if(!e)return"";if("string"==typeof e)return e;var t=(e=new Date(e)).toLocaleDateString(),a=e.toTimeString();return e=(t=oe((t=t.split("/"))[2],2,"0")+"-"+oe(t[0],2,"0")+"-"+oe(t[1],2,"0"))+"T"+(a=(a=a.split(":"))[0]+":"+a[1])}function ce(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(l.a)(ee().mark((function e(t){return ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){window.grecaptcha.ready(Object(l.a)(ee().mark((function n(){var r;return ee().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,window.grecaptcha.execute("6LcJmssjAAAAAGqiJjsxXLEP2zDjym__bmyTV9Xe",{action:t});case 3:return r=n.sent,n.next=6,d.a.post("/auth/verifyCaptcha",{token:r});case 6:e(r),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0),a(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,9]])}))))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e){var t=document.getElementsByClassName("grecaptcha-badge")[0];t&&(t.style.visibility=e?"visible":"hidden")}a(199);function ue(e){return r.a.createElement("div",{className:"nav"},e.children)}function me(e){var t=e.links.map((function(e,t){return!e.hide&&r.a.createElement(c.c,{exact:e.exact,to:e.path,key:e.path},e.text)}));return r.a.createElement("div",{className:"sub-nav"},t,e.showFilter&&r.a.createElement("div",{className:"filter"},r.a.createElement(Q,{value:e.filterSel,options:e.filterOptions,onChange:e.onFilter,icon:e.filterIcon,caret:!0})))}function de(e){var t=e.page,a=e.maxPage,o=e.range||5,s=e.onNav,c=e.inverted,l=null==a,u=Object(n.useReducer)((function(){if(l)return[t];for(var e=t<=a?t:1,n=e,r=e+1,s=[],c=!0;c;)c=!1,s.length<o&&n>=1&&(s.unshift(n--),c=!0),s.length<o&&r<=a&&(s.push(r++),c=!0);return s}),a,(function(e){if(l)return[1];for(var t=[],a=0;a<e;a++)t.push(a+1);return t})),m=Object(i.a)(u,2),d=m[0],f=m[1];function p(e){e>=1&&(l||e<=a)&&s(e)}Object(n.useEffect)((function(){f()}),[t,o,a]);var h=d.map((function(t){var a="page-num";return e.page==t&&(a+=" page-sel"),r.a.createElement("div",{className:a,onClick:function(){return p(t)},key:t},t)}));return r.a.createElement("div",{className:"page-nav ".concat(c?"inverted":"")},r.a.createElement("div",{className:"page-nav-left max",onClick:function(){return p(1)}},"\xab"),r.a.createElement("div",{className:"page-nav-left",onClick:function(){return p(t-1)}},"\u2039"),h,r.a.createElement("div",{className:"page-nav-right ".concat(l?"max":""),onClick:function(){return p(t+1)}},"\u203a"),!l&&r.a.createElement("div",{className:"page-nav-right max",onClick:function(){return p(a)}},"\xbb"))}function fe(e,t,a,n){var r;if(1==e)r="last=Infinity";else if(e<t&&0!=a.length)r="first=".concat(a[0][n]);else{if(!(e>t&&0!=a.length))return;r="last=".concat(a[a.length-1][n])}return r}function pe(e){return r.a.createElement("div",{className:"search-bar"},r.a.createElement("input",{type:"text",value:e.value,placeholder:e.placeholder,onChange:function(t){e.onInput(t.target.value)}}),r.a.createElement("div",{className:"search-icon"},r.a.createElement("i",{className:"fas fa-search"})))}var he=a(17),ge=a(108),ve=a.n(ge),ye=a(60),be=a.n(ye);function Ee(e){return r.a.createElement("div",{className:"loading-page ".concat(e.className||"")},r.a.createElement(be.a,{type:"bars",color:"#ffffff"}))}function we(){var e=Object(n.useContext)(j),t=e.history,a=e.updateHistory,o=(e.updatePlayers,e.stateViewing),s=e.updateStateViewing,c=e.self,i=e.players,l=e.isSpectator,u=Object(n.useRef)(!1),m=t.states[o]?t.states[o].meetings:{},d=(t.states[o]&&t.states[o].stateEvents,["gunshot"]),f=[!1],p=[!1],h=[1];return Object(n.useEffect)((function(){s({type:"current"})}),[t.currentState]),Object(n.useEffect)((function(){e.loadAudioFiles(d,f,p,h),e.review&&s({type:"first"})}),[]),ea((function(t){t.on("state",(function(t){u.current&&e.playAudio("bell"),u.current=!0})),t.on("winners",(function(e){})),t.on("gunshot",(function(){e.playAudio("gunshot")}))}),e.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(ta,{gameType:"Mafia",setup:e.setup,history:t,stateViewing:o,updateStateViewing:s,players:i,socket:e.socket,options:e.options,spectatorCount:e.spectatorCount,setLeave:e.setLeave,finished:e.finished,review:e.review,setShowSettingsModal:e.setShowSettingsModal,setRehostId:e.setRehostId,noLeaveRef:e.noLeaveRef,dev:e.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"M"),"afia"),timer:r.a.createElement(ya,{timers:e.timers,history:t})}),r.a.createElement(aa,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(ma,{players:i,history:t,gameType:"Mafia",stateViewing:o,activity:e.activity}),r.a.createElement(Oa,{filters:e.speechFilters,setFilters:e.setSpeechFilters,stateViewing:o})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(na,{socket:e.socket,history:t,updateHistory:a,players:i,stateViewing:o,settings:e.settings,filters:e.speechFilters,review:e.review,options:e.options,setTyping:e.setTyping,agoraClient:e.agoraClient,localAudioTrack:e.localAudioTrack,setActiveVoiceChannel:e.setActiveVoiceChannel,muted:e.muted,setMuted:e.setMuted,deafened:e.deafened,setDeafened:e.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(da,{socket:e.socket,meetings:m,players:i,self:c,history:t,stateViewing:o}),!e.review&&!l&&t.currentState>=0&&e.setup.lastWill&&r.a.createElement(ba,{lastWill:e.lastWill,socket:e.socket}),!e.review&&!l&&r.a.createElement(ka,{stateViewing:o}))}))}function Oe(e){var t=Object(n.useContext)(j),a=t.history,o=t.updateHistory,s=(t.updatePlayers,t.stateViewing),c=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[s]?a.states[s].meetings:{},f=(a.states[s]&&a.states[s].stateEvents,[]),p=[],h=[],g=[];return Object(n.useEffect)((function(){c({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,g),t.review&&c({type:"first"})}),[]),ea((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(ta,{gameType:"Split Decision",setup:t.setup,history:a,stateViewing:s,updateStateViewing:c,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"Split")," Decision"),timer:r.a.createElement(ya,{timers:t.timers,history:a})}),r.a.createElement(aa,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(ma,{players:l,history:a,gameType:"Split Decision",stateViewing:s,activity:t.activity}),r.a.createElement(Oa,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:s})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(na,{socket:t.socket,history:a,updateHistory:o,players:l,stateViewing:s,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(da,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:s}),!u&&r.a.createElement(ka,{stateViewing:s}))}))}a(124);function ke(e){var t=Object(n.useContext)(j),a=t.history,o=t.updateHistory,s=(t.updatePlayers,t.stateViewing),c=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[s]?a.states[s].meetings:{},f=(a.states[s]&&a.states[s].stateEvents,[]),p=[],h=[],g=[];return Object(n.useEffect)((function(){c({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,g),t.review&&c({type:"first"})}),[]),ea((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(ta,{gameType:"Resistance",setup:t.setup,history:a,stateViewing:s,updateStateViewing:c,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"R"),"esistance"),timer:r.a.createElement(ya,{timers:t.timers,history:a})}),r.a.createElement(aa,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(ma,{players:l,history:a,gameType:"Resistance",stateViewing:s,activity:t.activity}),r.a.createElement(Oa,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:s})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(na,{socket:t.socket,history:a,updateHistory:o,players:l,stateViewing:s,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne,{numMissions:t.setup.numMissions,history:a,stateViewing:s}),r.a.createElement(da,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:s}),!u&&r.a.createElement(ka,{stateViewing:s}))}))}function Ne(e){var t=e.numMissions,a=e.history,n=e.stateViewing;if(n<0)return r.a.createElement(r.a.Fragment,null);var o=a.states[n].extraInfo;return r.a.createElement(ia,{title:"Game Info",scrollable:!0,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(je,{numMissions:t}),r.a.createElement(Se,{score:null===o||void 0===o?void 0:o.score}),r.a.createElement(xe,{missionHistory:null===o||void 0===o?void 0:o.missionHistory}))})}function je(e){return r.a.createElement("div",{className:"rst"},r.a.createElement("div",{className:"rst-name"},"Total Missions"),e.numMissions)}function Se(e){var t=e.score||{rebels:0,spies:0};return r.a.createElement("div",{className:"rst-score"},r.a.createElement(Ce,{team:"rebels",scoreValue:t.rebels||0}),r.a.createElement(Ce,{team:"spies",scoreValue:t.spies||0}))}function Ce(e){return r.a.createElement("div",{className:"rst-score-box"},r.a.createElement("div",{className:"rst-score-box-name"},(t=e.team).charAt(0).toUpperCase()+t.slice(1)),r.a.createElement("div",{className:"rst-score-box-value rst-score-box-".concat(e.team||"")},e.scoreValue));var t}function xe(e){var t=(e.missionHistory||[]).map((function(e,t){var a=0===e.numFails?"success":"fail",n=e.team.join(" ");return-1===e.numFails?r.a.createElement("div",{className:"rst-mh-row"},r.a.createElement("div",{className:"rst-mh-status rst-mh-".concat(a)},"X"),r.a.createElement("div",{className:"rst-mh-team"},"rejected")):r.a.createElement("div",{className:"rst-mh-row"},r.a.createElement("div",{className:"rst-mh-status rst-mh-".concat(a)},e.numFails),r.a.createElement("div",{className:"rst-mh-team"},n))}));return r.a.createElement("div",{className:"rst"},r.a.createElement("div",{className:"rst-name"},"Mission History"),r.a.createElement("div",{className:"rst-mh-all-rows"},t))}function Ie(e){var t=Object(n.useContext)(j),a=t.history,o=t.updateHistory,s=(t.updatePlayers,t.stateViewing),c=t.updateStateViewing,i=t.self,l=t.players,u=t.isSpectator,m=Object(n.useRef)(!1),d=a.states[s]?a.states[s].meetings:{},f=(a.states[s]&&a.states[s].stateEvents,["gunshot"]),p=[!1],h=[!1],g=[1];return Object(n.useEffect)((function(){c({type:"current"})}),[a.currentState]),Object(n.useEffect)((function(){t.loadAudioFiles(f,p,h,g),t.review&&c({type:"first"})}),[]),ea((function(e){e.on("state",(function(e){m.current&&t.playAudio("bell"),m.current=!0})),e.on("winners",(function(e){})),e.on("gunshot",(function(){t.playAudio("gunshot")}))}),t.socket),r.a.createElement(r.a.Fragment,null,r.a.createElement(ta,{gameType:"One Night",setup:t.setup,history:a,stateViewing:s,updateStateViewing:c,players:l,socket:t.socket,options:t.options,spectatorCount:t.spectatorCount,setLeave:t.setLeave,finished:t.finished,review:t.review,setShowSettingsModal:t.setShowSettingsModal,setRehostId:t.setRehostId,dev:t.dev,gameName:r.a.createElement("div",{className:"game-name"},r.a.createElement("span",null,"One")," Night"),timer:r.a.createElement(ya,{timers:t.timers,history:a})}),r.a.createElement(aa,{leftPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(ma,{players:l,history:a,gameType:"One Night",stateViewing:s,activity:t.activity}),r.a.createElement(Oa,{filters:t.speechFilters,setFilters:t.setSpeechFilters,stateViewing:s})),centerPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(na,{socket:t.socket,history:a,updateHistory:o,players:l,stateViewing:s,settings:t.settings,filters:t.speechFilters,options:t.options,agoraClient:t.agoraClient,localAudioTrack:t.localAudioTrack,setActiveVoiceChannel:t.setActiveVoiceChannel,muted:t.muted,setMuted:t.setMuted,deafened:t.deafened,setDeafened:t.setDeafened})),rightPanelContent:r.a.createElement(r.a.Fragment,null,r.a.createElement(da,{socket:t.socket,meetings:d,players:l,self:i,history:a,stateViewing:s}),!u&&r.a.createElement(ka,{stateViewing:s}))}))}a(229);function Le(e){return r.a.createElement("div",{className:"span-panel main landing-page"},r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"logo"}),r.a.createElement("div",{className:"characters-circle"})),r.a.createElement("div",{className:"play-break"},r.a.createElement("div",{className:"play-btn-wrapper"},r.a.createElement(c.b,{to:"/auth/signup"},"Play Mafia"))),r.a.createElement("div",{className:"intro"},"BeyondMafia is the mafia site that is revolutionary in design, safety, and has a thriving community of users from all walks of life. With competitive and casual live mafia, and other gamemodes like Resistance, you're sure to find something that suits how YOU want to play."),r.a.createElement("div",{className:"mafia-features"},r.a.createElement("div",{className:"chat-mafia"},r.a.createElement("div",{className:"village-character"}),r.a.createElement("div",{className:"feature-title"},"Chat Mafia"),r.a.createElement("div",{className:"feature-desc"},"10-20 minute games with a variety of roles! Play with classic roles, or try out something different in the Sandbox lobby. You can create your own custom roles, too, using modifiers or by contributing to the open source codebase!")),r.a.createElement("div",{className:"forum-mafia"},r.a.createElement("div",{className:"cop-character"}),r.a.createElement("div",{className:"feature-title"},"Forum Mafia"),r.a.createElement("div",{className:"feature-desc"},"Play Mafia in the forums. More features are coming soon with the planned forum game engine!"))),r.a.createElement("div",{className:"other-games"},r.a.createElement("div",{className:"other-games-img"}),r.a.createElement("div",{className:"feature-title"},"Other Games"),r.a.createElement("div",{className:"feature-desc"},"Explore other Mafia-esque games like Resistance, One Night Ultimate Werewolf, and 2 Rooms and a Boom.")),r.a.createElement("div",{className:"play-break"},r.a.createElement("div",{className:"play-btn-wrapper"},r.a.createElement(c.b,{to:"/auth/signup"},"Play Mafia"))))}var Te=a(37),Ae=a.n(Te),Me=a(175),Re=a(173),Pe=a.n(Re),Fe=a(104),De=a.n(Fe);a(451),a(452),a(453),a(454),a(455),a(456);function Be(e){function t(t,a,n){var r=t.target.value;null!=a.min&&Number(r)<a.min?r=a.min:null!=a.max&&Number(r)>a.max&&(r=a.max),e.onChange({ref:a.ref,prop:"value",value:r,localOnly:n})}function a(t,a,n){var r=new Date(t);e.onChange({ref:a.ref,prop:"value",value:r,localOnly:n})}var n=e.fields.map((function(n,o){var s,c="function"==typeof n.disabled?n.disabled(e.deps):n.disabled,i="field-wrapper ".concat(c?"disabled":"");if(s="string"==typeof n.showIf?[n.showIf]:n.showIf,Array.isArray(s)){var l,u=Object(T.a)(s);try{for(u.s();!(l=u.n()).done;){var m=l.value,d="!"==m[0];d&&(m=m.slice(1));var f,p=Object(T.a)(e.fields);try{for(p.s();!(f=p.n()).done;){var h=f.value;if(h.ref==m&&"boolean"==h.type){if(0==(1==h.value^d))return;break}}}catch(y){p.e(y)}finally{p.f()}}}catch(y){u.e(y)}finally{u.f()}}else if("function"==typeof s&&!s(e.deps))return;var g="function"==typeof n.value?n.value(e.deps):n.value;switch(n.type){case"text":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement("input",{type:n.type,value:g||"",placeholder:n.placeholder,disabled:c,onChange:function(e){return!n.fixed&&t(e,n,n.saveBtn)},onClick:function(e){return n.highlight&&e.target.select()}}),n.saveBtn&&e.deps[n.saveBtnDiffer]!=n.value&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(a){(!n.confirm||window.confirm(n.confirm))&&(n.saveBtnOnClick?n.saveBtnOnClick(n.value,e.deps):t(a,n))}},n.saveBtn));case"number":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement("input",{type:"number",value:n.value||"0",min:n.min,max:n.max,step:n.step,disabled:c,onChange:function(e){return t(e,n)}}));case"boolean":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement("div",{className:"switch-wrapper"},r.a.createElement(Ve,{value:n.value||!1,disabled:c,onChange:function(e){return t(e,n)}})));case"select":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement("select",{value:n.value||n.options[0].ref,disabled:c,onChange:function(e){return t(e,n)}},n.options.map((function(e){return r.a.createElement("option",{value:e.value,key:e.value},e.label)}))));case"range":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement("div",{className:"range-wrapper"},r.a.createElement("input",{type:"range",min:n.min,max:n.max,step:n.step,value:n.value,disabled:c,onChange:function(e){return t(e,n)}})));case"color":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement(Ue,{value:n.value,default:n.default,alpha:n.alpha,disabled:c,onChange:function(e){return t(e,n)}}),!n.noReset&&n.value!=n.default&&n.value&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(){return t({target:{value:n.default}},n)}},"Reset"));case"date":"undefined"===n.value&&(n.value=void 0);var v=e.deps.user[n.ref];return"undefined"===v&&(v=void 0),r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement(Pe.a,{format:"MMMM dd",calendarAriaLabel:"Toggle calendar",clearAriaLabel:"Clear value",dayAriaLabel:"Day",monthAriaLabel:"Month",nativeInputAriaLabel:"Date",onChange:function(e){return a(e,n,!0)},value:n.value||v||new Date,maxDetail:"month"}),n.saveBtn&&!e.deps.user[n.saveBtnDiffer]&&r.a.createElement("div",{className:"btn btn-theme extra",onClick:function(t){(!n.confirm||window.confirm(n.confirm))&&(n.saveBtnOnClick?n.saveBtnOnClick(n.value||n.default,e.deps):a(t,n,!0))}},n.saveBtn));case"datetime-local":return r.a.createElement("div",{className:i,key:n.ref},r.a.createElement("div",{className:"label"},n.label),r.a.createElement("div",{className:"datetime-wrapper"},r.a.createElement("input",{type:"datetime-local",min:se(n.min),max:se(n.max),value:se(n.value),disabled:c,onChange:function(e){return t(e,n)}})))}}));return r.a.createElement("div",{className:"form"},n,e.submitText&&r.a.createElement("div",{className:"btn btn-theme-sec",onClick:e.onSubmit},e.submitText))}function Ve(e){return r.a.createElement("div",{className:"switch ".concat(e.value?"on":""),onClick:function(){return!e.disabled&&e.onChange({target:{value:!e.value}})}},r.a.createElement("div",{className:"track"}),r.a.createElement("div",{className:"thumb"}),r.a.createElement("input",{type:"hidden",value:e.value}))}function Ue(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useRef)(),l=e.value||e.default,u=e.disabled;return J(c,(function(){return s(!1)})),r.a.createElement("div",{className:"color-picker ".concat(u?"disabled":""),style:{backgroundColor:l},onClick:function(e){u||e.target!=c.current||s(!o)},ref:c},o&&r.a.createElement(Me.a,{color:l,disableAlpha:!e.alpha,onChangeComplete:function(t,a){e.onChange({target:{value:t.hex}})}}))}function Ge(e){var t=Object(n.useRef)();return r.a.createElement("div",{className:e.className,onClick:function(){var a=!0;e.onClick&&(a=e.onClick()),a&&t.current.click()}},e.children,r.a.createElement("input",{className:"hidden-upload",ref:t,type:"file",onChange:function(t){return e.onFileUpload(t.target.files,e.name)}}))}function _e(e){var t=Object(n.useState)(e),a=Object(i.a)(t,1)[0],r=Object(n.useReducer)((function(e,t){var a=Object(he.a)(e);for(var n in Array.isArray(t)||(t=[t]),a){var r,o=a[n],s=Object(h.a)({},o),c=Object(T.a)(t);try{for(c.s();!(r=c.n()).done;){var i=r.value;if(o.ref&&o.ref==i.ref){"string"==typeof i.value&&"boolean"==o.type&&(i.value="true"==i.value),s[i.prop]=i.value;break}}}catch(l){c.e(l)}finally{c.f()}a[n]=s}return a}),e),o=Object(i.a)(r,2),s=o[0],c=o[1];return[s,c,function(){var e,t=[],n=Object(T.a)(a);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push({ref:r.ref,prop:"value",value:r.value})}}catch(o){n.e(o)}finally{n.f()}c(t)}]}function We(e){var t=e.value,a=e.setValue,o=Object(n.useState)(""),s=Object(i.a)(o,2),c=s[0],l=s[1],u=Object(n.useState)(!1),m=Object(i.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),g=h[0],v=h[1],y=Object(n.useState)(e.options),b=Object(i.a)(y,2),E=b[0],w=b[1],O=Object(n.useRef)(),k=Object(n.useRef)();Object(n.useEffect)((function(){if(d){var e=O.current.getBoundingClientRect(),t=k.current.getBoundingClientRect(),a=e.top+e.height+1;a+t.height>window.innerHeight&&(a=e.top-t.height-2),k.current.style.top=a+"px",k.current.style.visibility="visible"}})),Object(n.useEffect)((function(){if(""==c)w(e.options);else{var t=e.options.filter((function(e){return e.toLowerCase().includes(c.toLowerCase())}));w(t)}}),[c,e.options]);var N=E.map((function(t){return r.a.createElement("div",{className:"option-row",onClick:function(){return function(t){a(t),l(""),f(!1),v(!1),e.onChange&&e.onChange(t)}(t)},key:t},t)}));return r.a.createElement("div",{className:"search-select",tabIndex:"0",onFocus:function(){f(!0)},onBlur:function(){g||(f(!1),l(""),w(e.options))},ref:O},r.a.createElement("input",{value:c,placeholder:t||e.placeholder,onChange:function(t){l(t.target.value),e.onInputChange&&e.onInputChange(t)},onKeyDown:function(t){"Enter"==t.key?(a(E[0]),l(""),f(!1),v(!1),e.onChange&&e.onChange(E[0])):d||f(!0)}}),r.a.createElement("div",{className:"icon-wrapper"},r.a.createElement("i",{className:"fas fa-chevron-down"})),d&&r.a.createElement("div",{className:"option-list",onMouseEnter:function(){v(!0)},onMouseLeave:function(){v(!1)},ref:k},N.length>0&&N,!N.length&&r.a.createElement("div",{className:"no-options"},"No Options")))}function He(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)({}),l=Object(i.a)(c,2),u=l[0],m=l[1],f=Object(n.useState)(""),p=Object(i.a)(f,2),h=p[0],g=p[1],v=Object(n.useState)(""),y=Object(i.a)(v,2),b=y[0],E=y[1];return Object(n.useEffect)((function(){0!=h.length&&d.a.get("/user/searchName?query=".concat(h)).then((function(e){var t,a={},n=Object(T.a)(e.data);try{for(n.s();!(t=n.n()).done;){var r=t.value;a[r.name]=r.id}}catch(o){n.e(o)}finally{n.f()}m(a),s(e.data.map((function(e){return e.name})))})).catch(I)}),[h]),r.a.createElement(We,Object.assign({},e,{options:o,value:b,setValue:function(t){E(t),e.setValue(u[t])},onInputChange:function(e){g(e.target.value)}}))}function $e(e){var t=Object(n.useState)("write"),a=Object(i.a)(t,2),o=a[0],s=a[1];return r.a.createElement(De.a,{value:e.value,onChange:e.onChange,selectedTab:o,onTabChange:s,classes:{preview:"md-content"},generateMarkdownPreview:function(e){return Promise.resolve(r.a.createElement(Ae.a,{source:e}))}})}a(165),a(457);function Ye(e){return r.a.createElement(r.a.Fragment,null,e.show&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"modal-bg",onClick:e.onBgClick}),r.a.createElement("div",{className:"modal ".concat(e.className?e.className:"")},r.a.createElement("div",{className:"modal-header"},e.header),r.a.createElement("div",{className:"modal-content"},e.content),r.a.createElement("div",{className:"modal-footer"},e.footer))))}function ze(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(),c=Object(i.a)(s,2),l=c[0],m=c[1],f=Object(n.useState)(),p=Object(i.a)(f,2),h=p[0],g=p[1],v=Object(n.useState)(),y=Object(i.a)(v,2),b=y[0],E=y[1],N=Object(n.useState)(""),j=Object(i.a)(N,2),S=j[0],C=j[1],x=Object(n.useState)(),L=Object(i.a)(x,2),A=L[0],M=L[1],R=Object(n.useState)(!1),P=Object(i.a)(R,2),F=P[0],D=P[1],B=Object(n.useState)(!1),V=Object(i.a)(B,2),U=V[0],G=V[1],_=Object(n.useState)({}),W=Object(i.a)(_,2),H=W[0],Y=W[1],z=Object(n.useState)({}),K=Object(i.a)(z,2),J=K[0],Q=K[1],X=Object(n.useState)([]),Z=Object(i.a)(X,2),ee=Z[0],te=Z[1],ae=Object(n.useState)([]),ne=Object(i.a)(ae,2),re=ne[0],oe=ne[1],se=Object(n.useState)(!1),ce=Object(i.a)(se,2),ie=ce[0],le=ce[1],ue=Object(n.useState)(1),me=Object(i.a)(ue,2),pe=me[0],he=me[1],ge=Object(n.useState)(1),ve=Object(i.a)(ge,2),ye=(ve[0],ve[1]),be=Object(n.useState)([]),we=Object(i.a)(be,2),Oe=we[0],ke=we[1],Ne=Object(n.useState)([]),je=Object(i.a)(Ne,2),Se=je[0],Ce=je[1],xe=Object(n.useState)(),Ie=Object(i.a)(xe,2),Le=Ie[0],Te=Ie[1],Me=Object(n.useState)([]),Re=Object(i.a)(Me,2),Pe=Re[0],Fe=Re[1],De=Object(n.useState)(!1),Be=Object(i.a)(De,2),Ve=Be[0],Ue=Be[1],_e=Object(n.useState)(""),We=Object(i.a)(_e,2),He=We[0],Ye=We[1],ze=Object(n.useState)(!1),Ke=Object(i.a)(ze,2),Je=Ke[0],Qe=Ke[1],Ze=Object(n.useContext)(O),at=Object(n.useContext)(k),rt=Object(u.g)(),ot=I(),st=Object(u.i)().userId,ct=st==Ze.id,it=!ct&&-1!=Ze.blockedUsers.indexOf(st);function lt(e,t){if(e.length){var a=new FormData;a.append("image",e[0]);var n,r=Object(T.a)(document.getElementsByClassName("hidden-upload"));try{for(r.s();!(n=r.n()).done;){n.value.value=""}}catch(o){r.e(o)}finally{r.f()}d.a.post("/user/".concat(t),a).then((function(e){switch(t){case"avatar":g(!0),at.clearCache();break;case"banner":E(!0),at.clearCache()}})).catch((function(e){null==e.response||413==e.response.status?ot("File too large, must be less than 2 MB."):ot(e)}))}}function ut(e){var t=fe(e,pe,Oe,"lastActive");null!=t&&d.a.get("/user/".concat(st,"/friends?").concat(t)).then((function(t){t.data.length&&(ke(t.data),he(e))})).catch(ot)}Object(n.useEffect)((function(){ie&&le(!1)}),[ie]),Object(n.useEffect)((function(){if(D(!1),st){o(!1);var e=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]{11}).*/;d.a.get("/user/".concat(st,"/profile")).then((function(t){if(o(!0),m(t.data.name),g(t.data.avatar),E(t.data.banner),C(q(t.data.bio,Ze.settings,"\\*")||""),G(t.data.isFriend),Y(t.data.settings),Q(t.data.accounts||{}),te(t.data.games),oe(t.data.setups),ye(t.data.maxFriendsPage),Ce(t.data.friendRequests),he(1),Te(t.data.stats),Fe(t.data.groups),Ye(""),Qe(!1),void 0!==t.data.settings.youtube){var a,n=null!==(a=t.data.settings.youtube.match(e))&&void 0!==a?a:"";n&&n.length>=7&&Ye(n[7]),Qe(t.data.settings.autoplay)}document.title="".concat(t.data.name,"'s Profile | BeyondMafia")})).catch((function(e){ot(e),rt.push("/play")})),d.a.get("/user/".concat(st,"/friends")).then((function(e){ke(e.data)})).catch(ot)}}),[st]);var mt={},dt={};H.backgroundColor&&(mt.backgroundColor=H.backgroundColor),b&&(dt.backgroundImage="url(/uploads/".concat(st,"_banner.jpg?t=").concat(at.cacheVal,")")),"stretch"==H.bannerFormat&&(dt.backgroundSize="100% 100%");var ft=[],ht=0;if(Le&&Le.Mafia&&Le.Mafia.all){var gt,yt,bt=Le.Mafia.all;ht=(null===bt||void 0===bt||null===(gt=bt.wins)||void 0===gt?void 0:gt.total)+(null===bt||void 0===bt||null===(yt=bt.abandons)||void 0===yt?void 0:yt.total)||0,ft=Object.keys(w).map((function(e){var t,a=bt[e];if(null==w[e])return r.a.createElement(r.a.Fragment,null);if(ht<1)a="-";else if("wins"==e)a="".concat(Math.round(a.count/ht*100),"%");else{var n="F",o=Object.keys(w[e]).reverse(),s=0;switch(e){case"reads":case"survival":a=a.total>0?a.count/a.total:"-"}if("-"!=a){for(;a>=w[e][o[s]]&&s<o.length;)n=o[s++];a=n}}return r.a.createElement("div",{className:"rating",key:e},r.a.createElement("div",{className:"name"},(t=e).charAt(0).toUpperCase()+t.substring(1)),r.a.createElement("div",{className:"score"},a))}))}var Et=ee.map((function(e){return r.a.createElement(vt,{game:e,type:e.status||"Finished",key:e.id,small:!0})})),wt=re.map((function(e){return r.a.createElement(Ut,{setup:e,key:e.id})})),Ot=Se.map((function(e){return r.a.createElement("div",{className:"friend-request",key:e.id},r.a.createElement(tt,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"btns"},r.a.createElement("i",{className:"fas fa-check",onClick:function(){return t=e.id,void d.a.post("/user/friend",{user:t}).then((function(e){var a=Se.slice().filter((function(e){return e.id!=t}));Ce(a),at.showAlert(e.data,"success")})).catch(ot);var t}}),r.a.createElement("i",{className:"fas fa-times",onClick:function(){return t=e.id,void d.a.post("/user/friend/reject",{user:t}).then((function(e){var a=Se.slice().filter((function(e){return e.id!=t}));Ce(a),at.showAlert(e.data,"success")})).catch(ot);var t}})))})),kt=Oe.map((function(e){return r.a.createElement("div",{className:"friend",key:e.id},r.a.createElement("div",{className:"friend-avatar"},r.a.createElement(tt,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"btns-wrapper"},r.a.createElement("i",{className:"fas fa-trash",onClick:(t=e.id,function(){window.confirm("Are you sure you wish to delete this friend?")&&d.a.post("/user/friend",{user:t}).then((function(e){G(!1),at.showAlert(e.data,"success")})).catch(ot)})}))),r.a.createElement("div",{className:"last-active"},r.a.createElement($,{minSec:!0,millisec:Date.now()-e.lastActive,suffix:" ago"})));var t}));return!Ze.loaded||Ze.loggedIn||st?Ze.loaded&&Ze.loggedIn&&!st?r.a.createElement(u.a,{to:"/user/".concat(Ze.id)}):a&&Ze.loaded?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"profile"},Le&&r.a.createElement(qe,{stats:Le,show:Ve,setShow:Ue}),r.a.createElement("div",{className:"main-panel",style:mt},r.a.createElement("div",{className:"banner",style:dt},ct&&r.a.createElement(Ge,{className:"edit",name:"banner",onClick:function(e,t){return!!Ze.itemsOwned.customProfile||(ot("You must purchase profile customization with coins from the Shop."),!1)},onFileUpload:lt},r.a.createElement("i",{className:"far fa-file-image"}))),r.a.createElement("div",{className:"user-info"},r.a.createElement("div",{className:"avi-name-row"},r.a.createElement("div",{className:"avi-name"},!ie&&r.a.createElement(et,{large:!0,id:st,hasImage:h,bustCache:ie,name:l,edit:ct,onUpload:lt}),r.a.createElement("div",{className:"name"},l))),r.a.createElement(nt,{groups:Pe}),!ct&&Ze.loggedIn&&r.a.createElement("div",{className:"options"},r.a.createElement("i",{className:"fas fa-user-plus ".concat(U?"sel":""),onClick:function(){if(U&&!window.confirm("Are you sure you wish to unfriend or cancel your friend request?"))return;d.a.post("/user/friend",{user:st}).then((function(e){G(!U),at.showAlert(e.data,"success")})).catch(ot)}}),r.a.createElement("i",{className:"fas fa-ban ".concat(it?"sel":""),onClick:function(){if(!it&&!window.confirm("Are you sure you wish to block this user?"))return;d.a.post("/user/block",{user:st}).then((function(){Ze.blockUserToggle(st),it?at.showAlert("User unblocked.","success"):at.showAlert("User blocked.","success")})).catch(ot)},title:"Block user"})),r.a.createElement("div",{className:"accounts"},J.discord&&H.showDiscord&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon discord-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},J.discord))),J.twitch&&H.showTwitch&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon twitch-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},J.twitch))),J.steam&&H.showSteam&&r.a.createElement("div",{className:"account-badge"},r.a.createElement("div",{className:"icon steam-icon"}),r.a.createElement("div",{className:"username-wrapper"},r.a.createElement("div",{className:"username"},J.steam)))),r.a.createElement("div",{className:"bio ".concat(ct&&!F?"edit":""),onClick:function(){D(ct),M(S)}},!F&&r.a.createElement("div",{className:"md-content"},r.a.createElement(Ae.a,{source:S})),F&&r.a.createElement(r.a.Fragment,null,r.a.createElement($e,{value:S,onChange:C}),r.a.createElement("div",{className:"buttons"},r.a.createElement("div",{className:"btn btn-theme",onClick:function(e){d.a.post("/user/bio",{bio:S}).then((function(){D(!1),C(q(S,Ze.settings,"\\*"))})).catch(ot)}},"Submit"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(e){e.stopPropagation(),D(!1),C(A)}},"Cancel")))))),r.a.createElement("div",{className:"side column"},r.a.createElement(Xe,{embedId:He,autoplay:Je}),ht>=1&&r.a.createElement("div",{className:"box-panel ratings",style:mt},r.a.createElement("div",{className:"heading"},"Mafia Ratings"),r.a.createElement("div",{className:"content"},ft,r.a.createElement("div",{className:"expand-icon-wrapper",onClick:function(){return Ue(!0)}},r.a.createElement("i",{className:"fas fa-expand-arrows-alt"})))),r.a.createElement("div",{className:"box-panel recent-games",style:mt},r.a.createElement("div",{className:"heading"},"Recent Games"),r.a.createElement("div",{className:"content"},Et,0==ee.length&&"No games")),Se.length>0&&r.a.createElement("div",{className:"box-panel friend-requests",style:mt},r.a.createElement("div",{className:"heading"},"Friend Requests"),r.a.createElement("div",{className:"content"},Ot)),r.a.createElement("div",{className:"box-panel friends",style:mt},r.a.createElement("div",{className:"heading"},"Friends"),r.a.createElement("div",{className:"content"},r.a.createElement(de,{inverted:!0,page:pe,onNav:ut}),kt,0==Oe.length&&"No friends yet",r.a.createElement(de,{inverted:!0,page:pe,onNav:ut}))),r.a.createElement("div",{className:"box-panel created-setups",style:mt},r.a.createElement("div",{className:"heading"},"Setups Created"),r.a.createElement("div",{className:"content"},wt,0==re.length&&"No setups")))),r.a.createElement(pt,{location:st})):r.a.createElement(Ee,null):r.a.createElement(u.a,{to:"/play"})}function qe(e){var t,a=Object(n.useState)("all"),o=Object(i.a)(a,2),s=o[0],c=o[1],l=Object(n.useState)(""),u=Object(i.a)(l,2),m=u[0],d=u[1],f={all:"All",bySetup:"Setup",byRole:"Role",byAlignment:"Alignment"},p={totalGames:"Total Games",wins:"Wins",abandons:"Abandons",reads:"Reads",survival:"Village Vote Survival"},h=e.stats.Mafia[s];null==h&&(h=[],t=[]),"all"==s?(h=[h],t=["All"]):(t=Object.keys(h).filter((function(e){return e.toLowerCase().includes(m)})),h=t.map((function(e){return h[e]})),t=t.map((function(e){return"".concat(f[s],": ").concat(e)})));var g=["all","bySetup","byRole","byAlignment"].map((function(e){return r.a.createElement("option",{key:e,value:e},f[e])})),v=h.map((function(e,a){e.totalGames;var n,o,s=(null===(n=e.wins)||void 0===n?void 0:n.total)+(null===e||void 0===e||null===(o=e.abandons)||void 0===o?void 0:o.total),c=Object.keys(e).map((function(t){var a=e[t];switch(t){case"totalGames":a=r.a.createElement("div",{className:"stat-data"},a);break;case"wins":case"abandons":a=r.a.createElement("div",{className:"stat-data"},a.count,"/",s);break;case"reads":case"survival":a=r.a.createElement("div",{className:"stat-data"},a.count,"/",a.total)}return r.a.createElement("div",{className:"stat",key:t},r.a.createElement("div",{className:"stat-name"},p[t]),a)}));return r.a.createElement("div",{className:"stats-row",key:t[a]},r.a.createElement("div",{className:"stats-row-name"},t[a]),r.a.createElement("div",{className:"stats-list"},c))})),y=r.a.createElement("div",{className:"stats-wrapper"},r.a.createElement("div",{className:"filter"},r.a.createElement("select",{value:s,onChange:function(e){return c(e.target.value)}},g),r.a.createElement("input",{type:"text",placeholder:"Query",onChange:function(e){return d(e.target.value.toLowerCase())}})),r.a.createElement("div",{className:"stats"},v)),b=r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"post btn btn-theme",onClick:function(){return e.setShow(!1)}},"Close"));return r.a.createElement(Ye,{className:"stats-modal",show:e.show,onBgClick:function(){e.setShow(!1)},header:"Ranked Stats",content:y,footer:b})}a(458);function Ke(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(!1),l=Object(i.a)(c,2),m=l[0],f=l[1],h=Object(n.useState)({}),g=Object(i.a)(h,2),v=g[0],y=g[1],b=Object(u.g)(),E=Object(n.useContext)(O),w=Object(n.useContext)(k),N=I(),j=_e([{label:"Referral URL",ref:"referralURL",type:"text",value:function(e){return"".concat("https://beyondmafia.com","/auth/login?ref=").concat(e.user.id)},fixed:!0,highlight:!0},{label:"DMs from Friends Only",ref:"onlyFriendDMs",type:"boolean"},{label:"Disable PG-13 Censor",ref:"disablePg13Censor",type:"boolean",showIf:"!disableAllCensors"},{label:"Disable All Censors",ref:"disableAllCensors",type:"boolean",showIf:function(e){return e.user.perms.disableAllCensors}},{label:"Hide Deleted Posts",ref:"hideDeleted",type:"boolean",showIf:function(e){return e.user.perms.viewDeleted}},{label:"Site Color Scheme",ref:"siteColorScheme",type:"select",options:[{label:"Auto",value:"auto"},{label:"Light",value:"light"},{label:"Dark",value:"dark"}]}]),S=Object(i.a)(j,2),C=S[0],x=S[1],L=_e([{label:"Name",ref:"username",type:"text",saveBtn:"Change",saveBtnDiffer:"name",saveBtnOnClick:function(e,t){var a="";-1!=Je.indexOf(e.toLowerCase())&&(a=window.prompt("This name is reserved, please enter your reservation code."));d.a.post("/user/name",{name:e,code:a}).then((function(a){t.siteInfo.showAlert("Username changed","success"),t.user.set(p()(t.user,{name:{$set:e},itemsOwned:{nameChange:{$set:t.user.itemsOwned.nameChange-1}}}))})).catch(t.errorAlert)},confirm:"Are you sure you wish to change your username?"},{label:"Birthday",ref:"birthday",type:"date",saveBtn:"Change",saveBtnDiffer:"bdayChanged",default:Date.now(),saveBtnOnClick:function(e,t){d.a.post("/user/birthday",{date:e}).then((function(a){t.siteInfo.showAlert("Birthday set","success"),t.user.set(p()(t.user,{birthday:{$set:e},bdayChanged:{$set:!0}}))})).catch(t.errorAlert)},confirm:"Are you sure you wish to change your birthday? Your birthday can only be changed ONCE per account."},{label:"Show Discord",ref:"showDiscord",type:"boolean",showIf:function(e){return e.accounts.discord&&e.accounts.discord.id}},{label:"Show Twitch",ref:"showTwitch",type:"boolean",showIf:function(e){return e.accounts.twitch&&e.accounts.twitch.id}},{label:"Show Steam",ref:"showSteam",type:"boolean",showIf:function(e){return e.accounts.steam&&e.accounts.steam.id}},{label:"Background Color",ref:"backgroundColor",type:"color",default:"#5357a5",disabled:function(e){return!e.user.itemsOwned.customProfile}},{label:"Youtube video",ref:"youtube",type:"text",saveBtn:"Change",saveBtnDiffer:"youtube",saveBtnOnClick:function(e,t){d.a.post("/user/youtube",{link:e}).then((function(a){t.siteInfo.showAlert("Profile video changed","success"),t.user.set(p()(t.user,{youtube:{$set:e}}))})).catch(t.errorAlert)},default:""},{label:"Autoplay video (will only work after playing once)",ref:"autoplay",type:"boolean",showIf:function(e){return null!=e.user.settings.youtube}},{label:"Banner Format",ref:"bannerFormat",type:"select",options:[{label:"Tile",value:"tile"},{label:"Stretch",value:"stretch"}],disabled:function(e){return!e.user.itemsOwned.customProfile}}]),T=Object(i.a)(L,2),A=T[0],M=T[1],R=_e([{label:"Name Color",ref:"nameColor",type:"color",default:"#000",disabled:function(e){return!e.user.itemsOwned.textColors}},{label:"Text Color",ref:"textColor",type:"color",default:"#000",disabled:function(e){return!e.user.itemsOwned.textColors}}]),P=Object(i.a)(R,2),F=P[0],D=P[1];function B(e,t){"value"!=e.prop||e.localOnly||d.a.post("/user/settings/update",{prop:e.ref,value:e.value}).then((function(){E.updateSetting(e.ref,e.value)})).catch(N),t(e)}return Object(n.useEffect)((function(){document.title="Settings | BeyondMafia"}),[]),Object(n.useEffect)((function(){E.loaded&&E.loggedIn&&(o||d.a.get("/user/settings/data").then((function(e){var t=[],a=[],n=[];for(var r in e.data)e.data[r]&&(t.push({ref:r,prop:"value",value:e.data[r]}),a.push({ref:r,prop:"value",value:e.data[r]}),n.push({ref:r,prop:"value",value:e.data[r]}));x(t),M(a),D(n),s(!0)})).catch(N),m||d.a.get("/user/accounts").then((function(e){y(e.data),f(!0)})).catch(N))}),[E]),E.loaded&&!E.loggedIn?r.a.createElement(u.a,{to:"/play"}):o&&m&&E.loaded?r.a.createElement("div",{className:"span-panel main settings"},r.a.createElement("div",{className:"heading"},"Site"),r.a.createElement(Be,{fields:C,deps:{user:E},onChange:function(e){return B(e,x)}}),r.a.createElement("div",{className:"heading"},"Profile"),r.a.createElement(Be,{fields:A,deps:{name:E.name,user:E,accounts:v,siteInfo:w,errorAlert:N},onChange:function(e){return B(e,M)}}),r.a.createElement("div",{className:"heading"},"Game"),r.a.createElement(Be,{fields:F,deps:{user:E},onChange:function(e){return B(e,D)}}),r.a.createElement("div",{className:"heading"},"Accounts"),r.a.createElement("div",{className:"accounts-row"},r.a.createElement("div",{className:"accounts-column"},r.a.createElement("div",{className:"btn btn-theme-sec logout",onClick:function(){d.a.post("/user/logout").then((function(e){E.clear(),le(!0),b.push("/")})).catch(N)}},"Sign Out"),r.a.createElement("div",{className:"btn delete-account",onClick:function(){window.confirm("Are you sure you wish to delete your account? This is irreversible.")&&d.a.post("/user/delete").then((function(e){E.clear(),b.push("/")})).catch(N)}},"Delete Account")))):r.a.createElement(Ee,null)}var Je=["Giga","Giga13","rend","croned","gameshowmaster","gayshowmaster","Golbolco","damiandaniel72","filko","elizachikorita","nyouhas","Thisinthat","jacobkrin","nirkbocaj","hima","Rutab","Nick","kidneybeans","emma","baabaa","DiSoRiEnTeD","DiSo","imasavage","ducky","Pranay7744","Hugo","Dasein","SpaceTimeJumpa","eadin","jingahegami","Kalakaua","GoldenOne","SamP4Palmer","sevenseas","GaryThompson","lemonsun","matt","Transcend","cozy","winx","Roxy","Dawn","mahugashaka","koba","DkKoba","DarkB","LeaderMafia","Validor","BrenTheDerg","juke","polly","eric","evolpz","BradLand","GoodQuestion","Torreador","Gamethroweador","monkney","monkey","Furry","Merlot","Winnie","arials","arials92","lesbian","gays","Mephistopheles","Facilier","MIKEISTKRIEG","MIKEISTKRlEG","JesseVentura","nomsterrpengi","kirbywithaknife","kirbywithagun","Super","shady","shady12","cowboy","Skittlez","Moldyches","Mizzmox","Fro30","Ngekop73","ivana","queen","catlady","mocha","Rapsician","Akari","Sonrio","Purple","GardeningPapa","davesprite","sunburst","RhaegarX","Jennings","ogwam","bono","Loser","Winner","talisker","rigby","CharlieBradbury","KingEvin","swan","dream","ERNurse","lain","jimmyjimjam","starry","muki","starrydash","Xinde","sl0nderman","starlysama","lena","nancy","komaeda","FLICKER","Donut","Mafia","Mafsided","PikachUwU","Vaporeon","marex","feickoo","DrSharky","shwartz99","gemrush","sidnee","MrSlipperyButt","MrsSlipperyButt","emsychum","verum","Disguiser","Ryan","CyanRyan","SinB","xray","ShaggyRogers","TheGreatCornholio","RedRanger","staypositivefriend","FruityPebbles","kimchi","LeChuck","Marty","Joe_","Kerry","Miki","Tristan117","GoodBoiSweater","Clair","Hibiki","viivii","TheTurningRAY","Frabel","Wolf","TheAsian","Achilles","ragefakar","jets","zoot","EllaSantos","Baya","MeteorNate","spookyaleks","ohnoitsrepo","Sona","NinetyNineGhost","ggnore2332","Danny","dannyred694","flashbar","emily","bluscone","Bebop","morgan","Zetonate","johnmiller","Reshoe7777777","Chicken","getdropkicked","JigglyBuff","ibeg","khs131","krista","ania","caitelatte","celebrelatte","Charge","powerofdeath","nightwing8782","weaversden","Valkyrie","alex","megan","lana","psy420","anya","SnowyB","aphelios","MasterCthulhu","XrCyclone","Cyclone","sakin","CooperD","idah09h","jeteon","wink","nicole","sofia","sofiiia","Senty","Sabi","KutiPls","Cream7","Giga96","arcbell","admin","administrator","mod","moderator","lucid","lucidrains"];a(459);function Qe(e){var t=Object(n.useState)({shopItems:[],balance:0}),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(!1),l=Object(i.a)(c,2),m=l[0],f=l[1],h=Object(n.useContext)(O),v=Object(n.useContext)(k),y=I();Object(n.useEffect)((function(){document.title="Shop | BeyondMafia"}),[]),Object(n.useEffect)((function(){h.loaded&&h.loggedIn&&d.a.get("/shop/info").then((function(e){s(e.data),f(!0)})).catch(y)}),[h.loaded]);var b=o.shopItems.map((function(e,t){return r.a.createElement("div",{className:"shop-item",key:t},r.a.createElement("div",{className:"name"},e.name),r.a.createElement("div",{className:"desc"},e.desc),r.a.createElement("div",{className:"bottom"},r.a.createElement("div",{className:"price"},r.a.createElement("i",{className:"fas fa-coins"}),e.price," coins"),r.a.createElement("div",{className:"owned"},"Owned:",r.a.createElement("div",{className:"amt"},h.itemsOwned[e.key],null!=e.limit&&" / ".concat(e.limit))),r.a.createElement("div",{className:"buy btn btn-theme",disabled:null!=e.limit&&h.itemsOwned[e.key]>=e.limit,onClick:function(){return function(e){var t=o.shopItems[e];window.confirm("Are you sure you wish to buy ".concat(t.name," for ").concat(t.price," coins?"))&&d.a.post("/shop/spendCoins",{item:e}).then((function(){v.showAlert("Item purchased.","success"),s(p()(o,{balance:{$set:o.balance-t.price}})),h.set(p()(h.state,{itemsOwned:Object(g.a)({},t.key,{$set:h.itemsOwned[t.key]+1})}))})).catch(y)}(t)}},"Buy")))}));return h.loaded&&!h.loggedIn?r.a.createElement(u.a,{to:"/play"}):m?r.a.createElement("div",{className:"span-panel main shop"},r.a.createElement("div",{className:"top-bar"},r.a.createElement("div",{className:"balance"},r.a.createElement("i",{className:"fas fa-coins"}),o.balance)),r.a.createElement("div",{className:"shop-items"},b)):r.a.createElement(Ee,null)}function Xe(e){var t=e.embedId,a="";return a=e.autoplay?1:0,null!==t&&""!==t?r.a.createElement("div",{id:"profile-video",className:"video-responsive"},r.a.createElement("iframe",{src:"https://www.youtube.com/embed/".concat(t,"?autoplay=").concat(a,"&mute=0"),allow:"accelerometer; autoplay; clipboard-write; encrypted-media;",allowFullScreen:!0})):null}function Ze(e){var t=Object(n.useContext)(O),a=[{text:"Profile",path:t.id?"/user/".concat(t.id):"/user",exact:!0,hide:!t.loggedIn},{text:"Settings",path:"/user/settings",hide:!t.loggedIn},{text:"Shop",path:"/user/shop",hide:!t.loggedIn}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(me,{links:a}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/user",render:function(){return r.a.createElement(ze,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/settings",render:function(){return r.a.createElement(Ke,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/shop",render:function(){return r.a.createElement(Qe,null)}}),r.a.createElement(u.b,{exact:!0,path:"/user/:userId",render:function(){return r.a.createElement(ze,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/user"})}}))))}function et(e){var t,a=e.small,o=e.large,s=e.id,c=e.name,i=e.hasImage,l=e.imageUrl,u=e.edit,m=e.onUpload,d=e.active,f=Object(n.useContext)(k),p={},h=["#fff59d","#ef9a9a","#9fa8da","#ce93d8","#a5d6a7","#f48fb1","#ffcc80","#90deea","#80cbc4"];if(t=a?"small":o?"large":"",i&&!l&&s)p.backgroundImage="url(/uploads/".concat(s,"_avatar.jpg?t=").concat(f.cacheVal,")");else if(i&&l)p.backgroundImage="url(".concat(l,")");else if(c){for(var g=0,v=0;v<c.length;v++)g^=c.charCodeAt(v);g^=c.charCodeAt(1),g^=g<<13,g^=g>>7,g^=g<<17,g=Math.abs(g)/Math.pow(2,31),p.backgroundColor=h[Math.floor(g*h.length)]}return r.a.createElement("div",{className:"avatar ".concat(t," ").concat(d?"active":""),style:p},u&&r.a.createElement(Ge,{className:"edit",name:"avatar",onFileUpload:m},r.a.createElement("i",{className:"far fa-file-image"})))}function tt(e){var t=e.id,a=e.name||"[deleted]",o=e.avatar,s=!e.name||e.noLink,i=e.color,l=e.newTab,u=e.small,m=e.active,d=e.groups,f=Object(n.useContext)(N),p="user-name ".concat(ae(i));return r.a.createElement(c.b,{className:"name-with-avatar ".concat(s?"no-link":""),to:"/user/".concat(t),target:l?"_blank":"",onClick:function(e){f.setVisible(!1),s&&e.preventDefault()}},r.a.createElement(et,{hasImage:o,id:t,name:a,small:u,active:m}),r.a.createElement("div",{className:p,style:i?{color:ne(i)}:{}},a),d&&r.a.createElement(nt,{groups:d,small:u}))}function at(e){return r.a.createElement("div",{className:"status-icon ".concat(e.status)})}function nt(e){var t=e.groups.filter((function(e){return e.badge})).sort((function(e,t){return e.rank-t.rank})).map((function(e){return r.a.createElement(rt,{icon:e.badge,color:e.badgeColor||"black",name:e.name,key:e.name})}));return r.a.createElement("div",{className:"badge-list ".concat(e.small?"small":"")},t)}function rt(e){return r.a.createElement("div",{className:"badge"},r.a.createElement("i",{className:"fas fa-".concat(e.icon),style:{color:e.color},title:e.name}))}function ot(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),o=a[0],s=a[1],l=Object(n.useState)(!1),u=Object(i.a)(l,2),m=u[0],f=u[1],p=I();function h(e,t){return e.position-t.position}Object(n.useEffect)((function(){document.title="Categories | BeyondMafia",e.updateForumNavInfo({action:"home"}),d.a.get("/forums/categories").then((function(t){var a,n=t.data.sort(h),r=Object(T.a)(n);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.boards=o.boards.sort(h)}}catch(c){r.e(c)}finally{r.f()}s(n),f(!0),e.updateForumNavInfo({type:"home"})})).catch(p)}),[]);var g=o.map((function(e){var t=e.boards.map((function(e){var t=e.newestThreads.map((function(e){return r.a.createElement("div",{className:"column-item",key:e.id},r.a.createElement("div",{className:"thread-link-wrapper"},r.a.createElement(c.b,{to:"/community/forums/thread/".concat(e.id)},e.title)),r.a.createElement(tt,{small:!0,id:e.author.id,name:e.author.name,avatar:e.author.avatar}),r.a.createElement("div",{className:"thread-counts"},r.a.createElement(ft,{viewCount:e.viewCount||0,replyCount:e.replyCount||0})))})),a=e.recentReplies.map((function(e){return r.a.createElement("div",{className:"column-item",key:e.id},r.a.createElement("div",{className:"thread-link-wrapper"},r.a.createElement(c.b,{to:"/community/forums/thread/".concat(e.thread.id,"?reply=").concat(e.id)},e.thread.title)),r.a.createElement(tt,{small:!0,id:e.author.id,name:e.author.name,avatar:e.author.avatar}),r.a.createElement("div",{className:"reply-age"},r.a.createElement($,{millisec:Date.now()-e.postDate})," ago"))}));return r.a.createElement("div",{className:"board",key:e.id},r.a.createElement("i",{className:"fas fa-".concat(e.icon||"comments"," board-icon")}),r.a.createElement(c.b,{className:"board-info",to:"/community/forums/board/".concat(e.id)},r.a.createElement("div",{className:"board-name"},e.name),r.a.createElement("div",{className:"board-desc"},e.description)),r.a.createElement("div",{className:"forum-column tall"},r.a.createElement("div",{className:"column-title"},"Newest Thread"),r.a.createElement("div",{className:"column-content ".concat(0==t.length?"center-content":"")},0==t.length&&r.a.createElement("div",{className:"column-item center-item"},"No threads yet"),t)),r.a.createElement("div",{className:"forum-column tall three"},r.a.createElement("div",{className:"column-title"},"Recent Replies"),r.a.createElement("div",{className:"column-content ".concat(0==a.length?"center-content":"")},0==a.length&&r.a.createElement("div",{className:"column-item center-item"},"No replies yet"),a)))}));return r.a.createElement("div",{className:"span-panel forum-category",key:e.id},r.a.createElement("div",{className:"title"},e.name),r.a.createElement("div",{className:"boards"},t))}));return m?g:r.a.createElement(Ee,null)}function st(e){var t=Object(n.useState)({}),a=Object(i.a)(t,2),o=a[0],s=a[1],l=Object(n.useState)(!1),m=Object(i.a)(l,2),f=m[0],p=m[1],h=Object(n.useState)(""),g=Object(i.a)(h,2),v=g[0],y=g[1],b=Object(n.useState)(""),E=Object(i.a)(b,2),w=E[0],k=E[1],N=Object(n.useState)(1),j=Object(i.a)(N,2),S=j[0],C=j[1],x=Object(n.useState)("bumpDate"),L=Object(i.a)(x,2),T=L[0],A=(L[1],Object(n.useState)(!1)),M=Object(i.a)(A,2),R=M[0],P=M[1],F=Object(n.useState)(),D=Object(i.a)(F,2),B=D[0],V=D[1],U=Object(u.i)().boardId,G=Object(n.useContext)(O),_=I();function W(e){var t=fe(e,S,o.threads,T);null!=t&&d.a.get("/forums/board/".concat(U,"?sortType=").concat(T,"&").concat(t)).then((function(t){t.data.threads.length>0&&(s(t.data),C(e))})).catch(_)}function H(e){var t=e.recentReplies.map((function(t){return r.a.createElement("div",{className:"column-item",key:t.id},r.a.createElement(tt,{small:!0,id:t.author.id,name:t.author.name,avatar:t.author.avatar}),r.a.createElement(c.b,{className:"reply-age",to:"/community/forums/thread/".concat(e.id,"?reply=").concat(t.id)},r.a.createElement($,{millisec:Date.now()-t.postDate})," ago"))}));return r.a.createElement("div",{className:"thread ".concat(e.deleted?"deleted":""),key:e.id},r.a.createElement(dt,{item:e,itemType:"thread",itemHolder:o,setItemHolder:s,itemKey:"threads"}),r.a.createElement("div",{className:"thread-info"},r.a.createElement(c.b,{className:"thread-title",to:"/community/forums/thread/".concat(e.id)},e.locked&&r.a.createElement("i",{className:"fas fa-lock"}),e.pinned&&r.a.createElement("i",{className:"fas fa-thumbtack"}),e.title),r.a.createElement(tt,{small:!0,id:e.author.id,avatar:e.author.avatar,name:e.author.name,groups:e.author.groups}),r.a.createElement("div",{className:"counts"},r.a.createElement(ft,{viewCount:e.viewCount||0,replyCount:e.replyCount||0}))),r.a.createElement("div",{className:"forum-column"},r.a.createElement("div",{className:"column-title"},"Post Date"),r.a.createElement("div",{className:"column-content"},r.a.createElement("div",{className:"column-item center-item"},r.a.createElement($,{millisec:Date.now()-e.postDate})," ago"))),r.a.createElement("div",{className:"forum-column three"},r.a.createElement("div",{className:"column-title"},"Recent Replies"),r.a.createElement("div",{className:"column-content ".concat(0==t.length?"center-content":"")},0==t.length&&r.a.createElement("div",{className:"column-item center-item"},"No replies yet"),t)))}if(Object(n.useEffect)((function(){document.title="Create Mafia Setup | BeyondMafia"}),[]),Object(n.useEffect)((function(){d.a.get("/forums/board/".concat(U)).then((function(t){s(t.data),P(!0),document.title="".concat(t.data.name," | BeyondMafia"),e.updateForumNavInfo({type:"board",id:U,name:t.data.name})})).catch((function(e){_(e),V("/community/forums")}))}),[U]),Object(n.useEffect)((function(){R&&e.updateForumNavInfo({action:"board",id:o.id,name:o.name})}),[R,o]),B)return r.a.createElement(u.a,{to:B});if(!R)return r.a.createElement(Ee,null);var Y=o.threads.map(H),z=o.pinnedThreads.map(H);return r.a.createElement("div",{className:"board-wrapper"},r.a.createElement(ct,{boardId:U,show:f,setShow:p,threadTitle:v,setThreadTitle:y,threadContent:w,setThreadContent:k,setRedirect:V}),r.a.createElement("div",{className:"board-info"},r.a.createElement("div",{className:"board-title-wrapper"},r.a.createElement("i",{className:"fas fa-".concat(o.icon||"comments"," board-icon")}),r.a.createElement("div",{className:"board-title"},o.name)),r.a.createElement("div",{className:"create-thread btn btn-theme",onClick:function(){p(!0)},disabled:!G.perms.createThread},r.a.createElement("i",{className:"fas fa-plus"}),"Create Thread")),z.length>0&&r.a.createElement("div",{className:"threads pinned-threads span-panel"},z),r.a.createElement(de,{inverted:!0,page:S,onNav:W}),r.a.createElement("div",{className:"threads span-panel"},Y.length>0&&Y,0==Y.length&&"No threads yet"),r.a.createElement(de,{inverted:!0,page:S,onNav:W}))}function ct(e){var t=I(),a=r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"field-wrapper thread-title"},r.a.createElement("div",{className:"label"},"Title"),r.a.createElement("input",{type:"text",value:e.threadTitle,onChange:function(t){e.setThreadTitle(t.target.value)}})),r.a.createElement($e,{value:e.threadContent,onChange:e.setThreadContent})),n=r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"post btn btn-theme",onClick:function(){d.a.post("/forums/thread",{board:e.boardId,title:e.threadTitle,content:e.threadContent}).then((function(t){e.setShow(!1),e.setRedirect("/community/forums/thread/".concat(t.data))})).catch(t)}},"Post"),r.a.createElement("div",{className:"cancel btn btn-theme-third",onClick:o},"Cancel"));function o(){e.setShow(!1)}return r.a.createElement(Ye,{className:"create-thread",show:e.show,onBgClick:o,header:"Create Thread",content:a,footer:n})}function it(e){var t=Object(n.useState)({}),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(!1),l=Object(i.a)(c,2),m=l[0],f=l[1],h=Object(n.useState)(),g=Object(i.a)(h,2),v=g[0],y=g[1],b=Object(n.useState)(!1),E=Object(i.a)(b,2),w=E[0],k=E[1],N=Object(n.useState)(""),j=Object(i.a)(N,2),S=j[0],C=j[1],x=Object(n.useState)(1),L=Object(i.a)(x,2),A=L[0],M=L[1],R=Object(n.useState)(!1),P=Object(i.a)(R,2),F=P[0],D=P[1],B=Object(n.useRef)(),V=Object(u.i)().threadId,U=Object(u.h)(),G=Object(n.useContext)(O),_=I(),W=new URLSearchParams(U.search);function H(e){if(!o.locked||G.perms.postInLocked){if(k(!0),e){for(var t="".concat(S,"\n\n> ##### @").concat(e.author.name,":\n"),a=e.content.split("\n"),n=0;n<a.length;n++)a[n]="> ".concat(a[n]);t="".concat(t).concat(a.join("\n"),"\n\n"),C(t)}w&&B.current.scrollIntoView()}}function $(e){d.a.get("/forums/thread/".concat(V,"?page=").concat(e)).then((function(t){t.data.content=q(t.data.content,G.settings,"\\*");var a,n=Object(T.a)(t.data.replies);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=q(r.content,G.settings,"\\*")}}catch(o){n.e(o)}finally{n.f()}M(e),s(t.data)})).catch(_)}if(Object(n.useEffect)((function(){document.title="Forums | BeyondMafia"}),[]),Object(n.useEffect)((function(){d.a.get("/forums/thread/".concat(V,"?reply=").concat(W.get("reply")||"")).then((function(t){t.data.content=q(t.data.content,G.settings,"\\*");var a,n=Object(T.a)(t.data.replies);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=q(r.content,G.settings,"\\*")}}catch(o){n.e(o)}finally{n.f()}s(t.data),M(t.data.page),f(!0),e.updateForumNavInfo({type:"thread",boardId:t.data.board.id,boardName:t.data.board.name,threadId:t.data.id,threadTitle:t.data.title})})).catch((function(e){_(e),y("/community/forums")}))}),[V]),Object(n.useEffect)((function(){if(m){if(e.updateForumNavInfo({action:"boardAndThread",boardId:o.board.id,boardName:o.board.name,threadId:o.id,threadTitle:o.title}),F||!W.get("reply"))return;var t=document.getElementById("reply-".concat(W.get("reply")));D(!0),t&&t.scrollIntoView()}}),[m,o]),Object(n.useEffect)((function(){w&&B.current.scrollIntoView()}),[w]),v)return r.a.createElement(u.a,{to:v});if(!m)return r.a.createElement(Ee,null);var Y=o.replies.map((function(e){return r.a.createElement(lt,{className:"reply ".concat(e.id==W.get("reply")?"sel":""),id:"reply-".concat(e.id),key:e.id,postInfo:e,itemType:"reply",voteItem:e,voteItemHolder:o,setVoteItemHolder:s,itemKey:"replies",locked:o.locked,permaLink:"/community/forums/thread/".concat(V,"?reply=").concat(e.id),onReplyClick:function(){return H(e)},onDelete:function(){return $(A)},onRestore:function(){return $(A)},onEdit:function(){return $(A)}})}));return r.a.createElement("div",{className:"thread-wrapper"},r.a.createElement(lt,{postInfo:o,itemType:"thread",voteItem:o,setVoteItemHolder:s,locked:o.locked,onReplyClick:function(){return H()},onDelete:function(){y("/community/forums/board/".concat(o.board.id))},onRestore:function(){return $(A)},onEdit:function(){return $(A)},onNotifyToggled:function(){s(p()(o,{replyNotify:{$set:!o.replyNotify}}))},onPinToggled:function(){s(p()(o,{pinned:{$set:!o.pinned}}))},onLockToggled:function(){s(p()(o,{locked:{$set:!o.locked}}))},hasTitle:!0}),r.a.createElement("div",{className:"reply-form-wrapper",ref:B},w&&r.a.createElement("div",{className:"reply-form span-panel"},r.a.createElement($e,{value:S,onChange:C}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme",onClick:function(){d.a.post("/forums/reply",{thread:o.id,content:S}).then((function(e){$(Number(e.data)),C(""),k(!1),document.body.scrollTop=document.body.scrollHeight})).catch(_)}},"Post"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){k(!1),C("")}},"Cancel")))),r.a.createElement("div",{className:"replies-wrapper"},r.a.createElement(de,{inverted:!0,page:A,maxPage:o.pageCount,onNav:$}),r.a.createElement("div",{className:"replies"},0==Y.length&&"No replies yet",Y),r.a.createElement(de,{inverted:!0,page:A,maxPage:o.pageCount,onNav:$})))}function lt(e){var t=e.id,a=e.postInfo,o=e.itemType,s=e.voteItem,l=e.voteItemHolder,u=e.setVoteItemHolder,m=e.itemKey,f=e.hasTitle,p=e.permaLink,h=e.locked,v=e.onReplyClick,y=e.onDelete,b=e.onRestore,E=e.onEdit,w=e.onNotifyToggled,k=e.onPinToggled,N=e.onLockToggled,j=Object(n.useState)(!1),S=Object(i.a)(j,2),C=S[0],x=S[1],L=Object(n.useState)(a.content),T=Object(i.a)(L,2),A=T[0],M=T[1],R=Object(n.useContext)(O),P=I();var F=a.content;return a.deleted&&R.settings.hideDeleted&&(F="*deleted*"),r.a.createElement("div",{className:"post span-panel ".concat(a.deleted?"deleted":""," ").concat(e.className),id:t},r.a.createElement("div",{className:"vote-wrapper"},r.a.createElement(dt,{item:s,itemType:o,itemHolder:l,setItemHolder:u,itemKey:m})),r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"heading-left"},f&&r.a.createElement("div",{className:"title"},h&&r.a.createElement("i",{className:"fas fa-lock"}),a.pinned&&r.a.createElement("i",{className:"fas fa-thumbtack"}),a.title),r.a.createElement("div",{className:"post-info"},r.a.createElement(tt,{id:a.author.id,name:a.author.name,avatar:a.author.avatar,groups:a.author.groups}),r.a.createElement("div",{className:"post-date"},r.a.createElement($,{minSec:!0,millisec:Date.now()-a.postDate})," ago"))),r.a.createElement("div",{className:"btns-wrapper"},!a.deleted&&r.a.createElement(r.a.Fragment,null,"thread"==o&&R.perms.pinThreads&&r.a.createElement("i",{className:"fas fa-thumbtack ".concat(a.pinned?"fa-rotate-180":""),onClick:function(){d.a.post("/forums/thread/togglePinned",{thread:a.id}).then(k).catch(P)}}),"thread"==o&&R.perms.lockThreads&&r.a.createElement("i",{className:"fas fa-lock".concat(a.locked?"-open":""),onClick:function(){d.a.post("/forums/thread/toggleLocked",{thread:a.id}).then(N).catch(P)}}),(R.perms.deleteAnyPost||R.perms.deleteOwnPost&&a.author.id==R.id)&&r.a.createElement("i",{className:"fas fa-trash",onClick:function(){window.confirm("Are you sure you wish to delete this?")&&d.a.post("/forums/".concat(o,"/delete"),Object(g.a)({},o,a.id)).then(y).catch(P)}}),R.perms.editPost&&a.author.id==R.id&&(!h||R.perms.postInLocked)&&r.a.createElement("i",{className:"fas fa-pencil-alt",onClick:function(){x(!0)}}),"thread"==o&&a.author.id==R.id&&r.a.createElement("i",{className:"fa".concat(a.replyNotify?"s":"r"," fa-bell"),onClick:function(){d.a.post("/forums/thread/notify",{thread:a.id}).then(w).catch((function(){}))}}),p&&r.a.createElement(c.b,{to:p,onClick:function(){navigator.clipboard.writeText(window.location.origin+p)}},r.a.createElement("i",{className:"fas fa-link"})),R.perms.postReply&&(!h||R.perms.postInLocked)&&r.a.createElement("i",{className:"reply-btn fas fa-reply",onClick:v})),a.deleted&&R.perms.restoreDeleted&&r.a.createElement("i",{className:"fas fa-trash-restore",onClick:function(){d.a.post("/forums/".concat(o,"/restore"),Object(g.a)({},o,a.id)).then(b).catch(P)}}))),!C&&r.a.createElement("div",{className:"md-content"},r.a.createElement(Ae.a,{source:F})),C&&r.a.createElement("div",{className:"edit-wrapper"},r.a.createElement($e,{value:A,onChange:M}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme-sec",onClick:function(){var e;d.a.post("/forums/".concat(o,"/edit"),(e={},Object(g.a)(e,o,a.id),Object(g.a)(e,"content",A),e)).then((function(){x(!1),E()})).catch(P)}},"Save"),r.a.createElement("div",{className:"btn btn-theme-third",onClick:function(){x(!1)}},"Cancel")))))}a(166);function ut(){var e=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"board":a={board:{id:t.id,name:t.name}};break;case"thread":a={board:{id:t.boardId,name:t.boardName},thread:{id:t.threadId,title:t.threadTitle}};break;case"home":a={}}return a||e}),{}),t=Object(i.a)(e,2),a=t[0],o=t[1];return r.a.createElement("div",{className:"forums"},r.a.createElement(mt,{forumNavInfo:a}),r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/community/forums",render:function(){return r.a.createElement(ot,{updateForumNavInfo:o})}}),r.a.createElement(u.b,{exact:!0,path:"/community/forums/board/:boardId",render:function(){return r.a.createElement(st,{updateForumNavInfo:o})}}),r.a.createElement(u.b,{exact:!0,path:"/community/forums/thread/:threadId",render:function(){return r.a.createElement(it,{updateForumNavInfo:o})}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/community/forums"})}})))}function mt(e){var t=e.forumNavInfo;return r.a.createElement("div",{className:"span-panel"},r.a.createElement("div",{className:"forum-nav"},r.a.createElement("div",{className:"path"},r.a.createElement(c.c,{to:"/community/forums"},r.a.createElement("i",{className:"fas fa-home home"}),"Forums"),t.board&&r.a.createElement(c.c,{to:"/community/forums/board/".concat(t.board.id)},r.a.createElement("i",{className:"fas fa-chevron-right separator"}),t.board.name),t.thread&&r.a.createElement(c.c,{to:"/community/forums/thread/".concat(t.thread.id)},r.a.createElement("i",{className:"fas fa-chevron-right separator"}),t.thread.title))))}function dt(e){var t=e.item,a=e.itemType,o=e.itemHolder,s=e.setItemHolder,c=e.itemKey,i=Object(n.useContext)(O),l=I();function u(e,n){i.perms.vote&&d.a.post("/forums/vote",{item:e,itemType:a,direction:n}).then((function(a){var r,i=Number(a.data),l=function(e,a){var n=t.voteCount;return 0==t.vote?n+=e:t.vote==e?n+=-1*e:n+=2*e,p()(t,{vote:{$set:a},voteCount:{$set:n}})}(n,i);if(null!=o){for(var u in r=c?o[c]:o)if(r[u].id==e){var m=r.slice();m[u]=l,s(c?p()(o,Object(g.a)({},c,{$set:m})):m);break}}else s(l)})).catch(l)}return r.a.createElement("div",{className:"vote-widget"},r.a.createElement("i",{className:"fas fa-arrow-up ".concat(1==t.vote&&"sel"),onClick:function(){return u(t.id,1)}}),t.voteCount||0,r.a.createElement("i",{className:"fas fa-arrow-down ".concat(-1==t.vote&&"sel"),onClick:function(){return u(t.id,-1)}}))}function ft(e){var t=e.viewCount,a=e.replyCount,n=1!=t,r=1!=a;return"".concat(t," view").concat(n?"s":"",", ").concat(a," repl").concat(r?"ies":"y")}a(460);function pt(e){var t=e.location,a=Object(n.useState)(1),o=Object(i.a)(a,2),s=o[0],c=o[1],l=Object(n.useState)([]),u=Object(i.a)(l,2),m=u[0],f=u[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),g=h[0],v=h[1],y=Object(n.useState)(""),b=Object(i.a)(y,2),E=b[0],w=b[1],k=Object(n.useState)(!1),N=Object(i.a)(k,2),j=N[0],S=N[1],C=Object(n.useContext)(O),x=I();function L(e){var a=fe(e,s,m,"date");null!=a&&d.a.get("/comment?location=".concat(t,"&").concat(a)).then((function(t){if(S(!0),t.data.length>0){var a,n=Object(T.a)(t.data);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.content=q(r.content,C.settings,"\\*")}}catch(o){n.e(o)}finally{n.f()}f(t.data),c(e)}})).catch(x)}Object(n.useEffect)((function(){f([]),L(1)}),[t]);var A=m.map((function(e){return r.a.createElement(ht,{location:t,comment:e,comments:m,setComments:f,onDelete:function(){return L(s)},onRestore:function(){return L(s)},key:e.id})}));return j?r.a.createElement("div",{className:"comments-wrapper thread-wrapper"},r.a.createElement("div",{className:"comments-input-wrapper"},!g&&C.loggedIn&&C.perms.postReply&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){return v(!0)}},"Post Comment"),g&&r.a.createElement("div",{className:"reply-form span-panel"},r.a.createElement($e,{value:E,onChange:w}),r.a.createElement("div",{className:"post-btn-wrapper"},r.a.createElement("div",{className:"post-reply btn btn-theme",onClick:function(){d.a.post("/comment",{content:E,location:t}).then((function(){L(1),w(""),v(!1)})).catch(x)}},"Post"),r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){v(!1)}},"Cancel")))),r.a.createElement("div",{className:"comments-page"},r.a.createElement(de,{inverted:!0,page:s,onNav:L}),0==m.length&&"No comments yet",A,r.a.createElement(de,{inverted:!0,page:s,onNav:L}))):r.a.createElement(Ee,{className:"under"})}function ht(e){var t=e.location,a=e.comment,o=e.comments,s=e.setComments,c=e.onDelete,i=e.onRestore,l=Object(n.useContext)(O),u=I();var m=a.content;return a.deleted&&l.settings.hideDeleted&&(m="*deleted*"),r.a.createElement("div",{className:"post ".concat(a.deleted?"deleted":""," ").concat(e.className||"")},r.a.createElement("div",{className:"vote-wrapper"},r.a.createElement(dt,{item:a,itemHolder:o,setItemHolder:s,itemType:"comment"})),r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"heading-left"},r.a.createElement("div",{className:"post-info"},r.a.createElement(tt,{id:a.author.id,name:a.author.name,avatar:a.author.avatar,groups:a.author.groups}),r.a.createElement("div",{className:"post-date"},r.a.createElement($,{minSec:!0,millisec:Date.now()-a.date})," ago"))),r.a.createElement("div",{className:"btns-wrapper"},!a.deleted&&(l.perms.deleteAnyPost||l.perms.deleteOwnPost&&a.author.id==l.id||t==l.id)&&r.a.createElement("i",{className:"fas fa-trash",onClick:function(){window.confirm("Are you sure you wish to delete this?")&&d.a.post("/comment/delete",{comment:a.id}).then(c).catch(u)}}),a.deleted&&l.perms.restoreDeleted&&r.a.createElement("i",{className:"fas fa-trash-restore",onClick:function(){d.a.post("/comment/restore",{comment:a.id}).then(i).catch(u)}}))),r.a.createElement("div",{className:"md-content"},r.a.createElement(Ae.a,{source:m}))))}a(461);function gt(e){var t=Object(n.useState)("All"),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(1),l=Object(i.a)(c,2),m=l[0],f=l[1],p=Object(n.useState)([]),h=Object(i.a)(p,2),g=h[0],v=h[1],b=Object(u.h)(),E=Object(u.g)(),w=Object(n.useContext)(O),k=I(),N=new URLSearchParams(b.search),j=Object(n.useState)(N.get("lobby")||localStorage.getItem("lobby")||"All"),S=Object(i.a)(j,2),C=S[0],x=S[1];function L(e,t){var a=fe(t,m,g,"endTime");null!=a&&(a+="&page=".concat(t),d.a.get("/game/list?list=".concat(re(e),"&lobby=").concat(C,"&").concat(a)).then((function(a){(a.data.length>0||1==t)&&(s(e),f(t),v(a.data))})).catch(k))}function T(e){x(e),C==e&&L(o,m)}return Object(n.useEffect)((function(){localStorage.setItem("lobby",C),N.get("lobby")!=C&&E.push(b.pathname+"?lobby=".concat(C)),document.title="Play (".concat(C,") | BeyondMafia"),L(o,1)}),[b.pathname,C]),"All"!=C&&-1==y.indexOf(C)&&x("All"),w.loaded?w.loaded&&!w.loggedIn?r.a.createElement(Le,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"span-panel main join"},r.a.createElement("div",{className:"left-panel"}),r.a.createElement("div",{className:"right-panel"},r.a.createElement("div",{className:"top-bar lobby-list"},r.a.createElement(Dt,{text:"All",sel:C,onClick:function(){return T("All")}}),r.a.createElement(Dt,{text:"Main",sel:C,onClick:function(){return T("Main")}}),r.a.createElement(Dt,{text:"Sandbox",sel:C,onClick:function(){return T("Sandbox")}}),r.a.createElement(Dt,{text:"Competitive",sel:C,onClick:function(){return T("Competitive")}}),r.a.createElement(Dt,{text:"Games",sel:C,onClick:function(){return T("Games")}})),r.a.createElement(W,{className:"games",items:g,map:function(e){return r.a.createElement(vt,{game:e,lobby:C,refresh:function(){return L(o,m)},odd:g.indexOf(e)%2==1,key:e.id})},empty:"No games"}),r.a.createElement(de,{page:m,onNav:function(e){return L(o,e)}}))),r.a.createElement("div",{className:"bottom-wrapper"},r.a.createElement(pt,{location:"Main"==C||"All"==C?"lobby":"lobby-".concat(C)}),r.a.createElement(bt,null))):r.a.createElement(Ee,null)}function vt(e){var t,a,o=Object(n.useState)(!1),s=Object(i.a)(o,2),l=s[0],m=s[1],f=Object(n.useState)(e.game.reserved),p=Object(i.a)(f,2),g=p[0],v=p[1],y=Object(n.useRef)(),b=Object(n.useContext)(O),E=Object(n.useContext)(N),w=Object(n.useContext)(k),j=I();var S="btn ";switch(e.small&&(S+="btn-small "),e.game.status){case"Open":t="/game/".concat(e.game.id),S+="btn-join ",e.game.scheduled<=Date.now()&&(a="Join");break;case"In Progress":e.game.spectating||b.perms.canSpectateAny?(t="/game/".concat(e.game.id),S+="btn-spectate ",a="Spectate"):(t="/play",S+="btn-in-progress ",a="In Progress");break;case"Finished":t="/game/".concat(e.game.id),S+="btn-review ",a="Review"}return l?r.a.createElement(u.a,{to:l}):e.game.setup?r.a.createElement("div",{className:"row ".concat(e.odd?"odd":""," game-row")},r.a.createElement("div",{className:"btns-wrapper"},(b.loggedIn||"Finished"==e.status)&&!e.game.broken&&!e.game.private&&r.a.createElement(c.b,{to:t,className:S,disabled:"In Progress"==e.status&&!e.game.spectating},a),b.loggedIn&&e.game.scheduled>Date.now()&&!g&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){d.a.post("/game/reserve",{gameId:e.game.id}).then((function(e){v(!g),w.showAlert(e.data,"success")})).catch(j)}},"Reserve"),b.loggedIn&&e.game.scheduled>Date.now()&&g&&r.a.createElement("div",{className:"btn btn-theme",onClick:function(){d.a.post("/game/unreserve",{gameId:e.game.id}).then((function(e){v(!g),w.showAlert(e.data,"success")})).catch(j)}},"Unreserve"),e.game.scheduled>Date.now()&&b.id==e.game.hostId&&r.a.createElement("div",{className:"btn btn-theme-sec",onClick:function(){d.a.post("/game/cancel",{gameId:e.game.id}).then((function(t){w.showAlert(t.data,"success"),e.refresh()})).catch(j)}},"Cancel"),e.game.broken&&r.a.createElement("i",{className:"fas fa-car-crash review-icon",title:"Broken"}),e.game.private&&r.a.createElement("i",{className:"fas fa-lock review-icon",title:"Private"})),r.a.createElement("div",{className:"player-count-wrapper"},r.a.createElement(yt,{game:e.game})),r.a.createElement("div",{className:"setup-wrapper"},r.a.createElement(Ut,{setup:e.game.setup,maxRolesCount:e.small?3:5})),!e.small&&r.a.createElement("div",{className:"setup-name"},e.game.setup.name),r.a.createElement("div",{className:"game-infos"},e.game.ranked&&r.a.createElement("i",{className:"ranked fas fa-chart-bar",title:"Ranked game"}),e.game.voiceChat&&r.a.createElement("i",{className:"voice-chat fas fa-microphone",title:"Voice chat game"}),"Finished"==e.game.status&&b.loggedIn&&!e.small&&r.a.createElement("i",{className:"rehost fas fa-redo",title:"Rehost",onClick:function(){var t={};for(var a in e.game.stateLengths)t[a]=e.game.stateLengths[a]/6e4;var n=e.lobby;"All"==n&&(n="Main"),d.a.post("/game/host",Object(h.a)({gameType:e.game.type,setup:e.game.setup.id,lobby:n,guests:e.game.guests,private:!1,ranked:e.game.ranked,spectating:e.game.spectating,voiceChat:e.game.voiceChat,readyCheck:e.game.readyCheck,stateLengths:t},JSON.parse(e.game.gameTypeOptions))).then((function(e){return m("/game/".concat(e.data))})).catch(j)}}),r.a.createElement("i",{className:"game-info fas fa-info-circle",ref:y,onClick:function(t){t.stopPropagation(),E.onClick("/game/".concat(e.game.id,"/info"),"game",y.current,"Game ".concat(e.game.id))}}))):r.a.createElement(r.a.Fragment,null)}function yt(e){for(var t=e.game,a=[],n=0;n<t.setup.total;n++)a.push(r.a.createElement("div",{className:"player-circle ".concat(n<t.players?"filled":""),key:n}));return r.a.createElement("div",{className:"player-count"},a)}function bt(){var e=Object(n.useState)(1),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)([]),c=Object(i.a)(s,2),l=c[0],u=c[1],m=I(),f=Object(n.useContext)(O);function p(e){var t=fe(e,a,l,"date");null!=t&&d.a.get("/mod/announcements?".concat(t)).then((function(t){t.data.length>0&&(u(t.data),o(e))})).catch(m)}Object(n.useEffect)((function(){p(1)}),[]);var h=l.map((function(e){return r.a.createElement("div",{className:"announcement",key:e.id},r.a.createElement("div",{className:"top-row"},r.a.createElement(tt,{id:e.mod.id,name:e.mod.name,avatar:e.mod.avatar}),r.a.createElement("div",{className:"date"},r.a.createElement($,{minSec:!0,millisec:Date.now()-e.date,suffix:" ago"}))),r.a.createElement("div",{className:"content"},r.a.createElement(z,{text:e.content,settings:f.settings,filterProfanity:!0,linkify:!0,emotify:!0})))}));return r.a.createElement("div",{className:"announcements box-panel"},r.a.createElement("div",{className:"heading"},"Announcements"),r.a.createElement(de,{page:a,onNav:p}),h,r.a.createElement(de,{page:a,onNav:p}))}a(57);function Et(e){e.gameType;var t=e.selSetup,a=e.setSelSetup,o=e.formFields,s=e.updateFormFields,c=e.onHostGame,l=Object(n.useState)("featured"),m=Object(i.a)(l,2),f=m[0],p=m[1],h=Object(n.useState)(1),g=Object(i.a)(h,2),v=g[0],y=g[1],b=Object(n.useState)(1),E=Object(i.a)(b,2),w=E[0],k=E[1],N=Object(n.useState)(""),j=Object(i.a)(N,2),S=j[0],C=j[1],x=Object(n.useState)([]),L=Object(i.a)(x,2),T=L[0],A=L[1],M=Object(u.h)(),R=Object(u.g)(),P=I(),F=Object(n.useContext)(O);function D(t,a,n){d.a.get("/setup/".concat(re(t),"?gameType=").concat(e.gameType,"&page=").concat(a,"&query=").concat(n||"")).then((function(e){p(t),y(a),A(e.data.setups),k(e.data.pages)}))}function B(e){d.a.post("/setup/favorite",{id:e.id}).catch(P);var t=Object(he.a)(T);for(var a in T)if(T[a].id==e.id){t[a].favorite=!T[a].favorite;break}A(t)}function V(e){R.push("/play/create?edit=".concat(e.id))}function U(e){d.a.post("/setup/delete",{id:e.id}).then((function(){D(f,v)})).catch(P)}Object(n.useEffect)((function(){var e=new URLSearchParams(M.search);e.get("setup")?(D("id",1,e.get("setup")),d.a.get("/setup/".concat(e.get("setup"))).then((function(e){e.data.name=q(e.data.name,F.settings),a(e.data)})).catch(P)):D(f,v)}),[]),Object(n.useEffect)((function(){s({ref:"setup",prop:"value",value:t.name})}),[t]);var G=["Featured","Popular","Ranked","Favorites","Yours"].map((function(e){return r.a.createElement(Dt,{text:e,sel:f,onClick:function(){return function(e){C(""),D(e,1)}(e)},key:e})}));return r.a.createElement("div",{className:"span-panel main host"},r.a.createElement("div",{className:"top-bar"},G,r.a.createElement(pe,{value:S,placeholder:"Setup Name",onInput:function(e){C(e),e.length?D("search",1,e):D("featured",1)}})),r.a.createElement(W,{items:T,map:function(e){return r.a.createElement(wt,{setup:e,sel:t,listType:f,onSelect:a,onFav:B,onEdit:V,onDel:U,odd:T.indexOf(e)%2==1,key:e.id})},empty:"No setups"}),r.a.createElement(de,{page:v,maxPage:w,onNav:function(e){var t=[f,e];S.length&&t.push(S),D.apply(void 0,t)}}),F.loggedIn&&r.a.createElement(Be,{fields:o,onChange:s,submitText:"Host",onSubmit:c}))}function wt(e){var t=Object(n.useContext)(O),a="far",o="far";return e.sel.id==e.setup.id&&(a="fas"),e.setup.favorite&&(o="fas"),r.a.createElement("div",{className:"row ".concat(e.odd?"odd":"")},t.loggedIn&&r.a.createElement("i",{className:"select-setup fa-circle ".concat(a),onClick:function(){return e.onSelect(e.setup)}}),r.a.createElement("div",{className:"setup-wrapper"},r.a.createElement(Ut,{setup:e.setup})),r.a.createElement("div",{className:"setup-name"},e.setup.name),t.loggedIn&&r.a.createElement("i",{className:"setup-btn fav-setup fa-star ".concat(o),onClick:function(){return e.onFav(e.setup)}}),t.loggedIn&&"Yours"==e.listType&&r.a.createElement("i",{className:"setup-btn edit-setup fa-pen-square fas",onClick:function(){return e.onEdit(e.setup)}}),t.loggedIn&&"Yours"==e.listType&&r.a.createElement("i",{className:"setup-btn del-setup fa-times-circle fas",onClick:function(){return e.onDel(e.setup)}}))}function Ot(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(i.a)(s,2),l=c[0],m=c[1],f=(Object(n.useContext)(k),JSON.parse(localStorage.getItem("mafiaHostOptions")||null)||{private:!1,guests:!1,ranked:!1,spectating:!1,voiceChat:!1,scheduled:!1,readyCheck:!1,dayLength:10,nightLength:2,extendLength:3}),p=I(),h=_e([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:y.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean",value:f.private,showIf:"!ranked"},{label:"Allow Guests",ref:"guests",type:"boolean",value:f.guests,showIf:"!ranked"},{label:"Ranked",ref:"ranked",type:"boolean",value:f.ranked,showIf:["!private","!spectating","!voiceChat","!guests"]},{label:"Spectating",ref:"spectating",type:"boolean",value:f.spectating,showIf:"!ranked"},{label:"Ready Check",ref:"readyCheck",value:f.readyCheck,type:"boolean"},{label:"Day Length (minutes)",ref:"dayLength",type:"number",value:f.dayLength,min:1,max:30},{label:"Night Length (minutes)",ref:"nightLength",type:"number",value:f.nightLength,min:1,max:10},{label:"Extension Length (minutes)",ref:"extendLength",type:"number",value:f.extendLength,min:1,max:5}]),g=Object(i.a)(h,2),v=g[0],b=g[1];function E(e){var t,a=Object(T.a)(v);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host Mafia | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(Et,{gameType:"Mafia",selSetup:a,setSelSetup:o,formFields:v,updateFormFields:b,onHostGame:function(){var e=E("lobby");"All"==e&&(e="Main"),a.id?(d.a.post("/game/host",{gameType:"Mafia",lobby:e,setup:a.id,private:E("private"),guests:E("guests"),ranked:E("ranked"),spectating:E("spectating"),readyCheck:E("readyCheck"),stateLengths:{Day:E("dayLength"),Night:E("nightLength")},extendLength:E("extendLength")}).then((function(e){m("/game/".concat(e.data))})).catch(p),f.private=E("private"),f.guests=E("guests"),f.ranked=E("ranked"),f.spectating=E("spectating"),f.readyCheck=E("readyCheck"),f.dayLength=E("dayLength"),f.nightLength=E("nightLength"),f.extendLength=E("extendLength"),localStorage.setItem("mafiaHostOptions",JSON.stringify(f))):p("You must choose a setup")}})}a(462);function kt(e){var t,a=e.gameType,o=e.formFields,s=e.updateFormFields,c=e.closedField,l=e.resetFormFields,m=e.formFieldValueMods,f=e.onCreateSetup,p=I(),g=Object(n.useState)(0),v=Object(i.a)(g,2),y=v[0],b=v[1],E=Object(n.useState)(""),w=Object(i.a)(E,2),N=w[0],j=w[1],S=Object(n.useState)(!1),C=Object(i.a)(S,2),x=C[0],L=C[1],A=Object(n.useState)("None"),M=Object(i.a)(A,2),R=M[0],P=M[1],F=Object(u.h)(),D=new URLSearchParams(F.search),B=Object(n.useContext)(k),V=Object(n.useReducer)((function(e,t){var a=Object(h.a)({},e);if("reset"!=t.type&&"setClosed"!=t.type)for(var n in a.roles=e.roles.slice(),e.roles)a.roles[n]=Object(h.a)({},e.roles[n]);switch(t.type){case"reset":a.roles=[{}];break;case"setClosed":a.closed=t.closed,t.closed&&(a.roles=a.roles.slice(0,1));break;case"addRole":(r=a.roles[y])[t.role]||(r[t.role]=0),r[t.role]++;break;case"removeRole":var r;(r=a.roles[y])[t.role]&&r[t.role]--,r[t.role]<1&&delete r[t.role];break;case"addRoleSet":a.roles.push({});break;case"removeRoleSet":a.roles.splice(t.index,1),t.index==y&&b(0);break;case"setFromSetup":a.closed=t.closed,a.roles=t.roles}return a}),{roles:[{}],closed:!1}),U=Object(i.a)(V,2),G=U[0],_=U[1],W=Object(n.useContext)(O);Object(n.useEffect)((function(){_({type:"setClosed",closed:c.value})}),[c.value]),Object(n.useEffect)((function(){D.get("edit")&&d.a.get("/setup/".concat(D.get("edit"))).then((function(e){var t=e.data;L(!0),_({type:"setFromSetup",roles:JSON.parse(t.roles),closed:t.closed});var a,n=[],r=Object(T.a)(o);try{for(r.s();!(a=r.n()).done;){var c=a.value;if(t[c.ref]){var i=t[c.ref];if(m[c.ref]){var l,u=Object(T.a)(m[c.ref]);try{for(u.s();!(l=u.n()).done;){i=(0,l.value)(i)}}catch(f){u.e(f)}finally{u.f()}}n.push({ref:c.ref,prop:"value",value:i})}}}catch(f){r.e(f)}finally{r.f()}if(t.closed)for(var d in t.count)n.push({ref:"count-".concat(d),prop:"value",value:t.count[d]});s(n)})).catch(p)}),[]),x&&!D.get("edit")&&(L(!1),l(),_({type:"reset"})),t=G.roles.map((function(e,t){var n=[],o=function(t){n.push(r.a.createElement(Bt,{role:t,count:e[t],gameType:a,onClick:function(){_({type:"removeRole",role:t})},key:t}))};for(var s in e)o(s);return r.a.createElement(Nt,{roles:n,index:t,sel:y,onClick:function(){return b(t)},onDelete:function(){_({type:"removeRoleSet",index:t})},key:t})}));var H=B.roles?B.roles.Modifiers[a]:[];return(H=H.map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))).unshift(r.a.createElement("option",{value:"None",key:"None"},"None")),D.get("edit")&&!x?r.a.createElement(Ee,null):r.a.createElement("div",{className:"span-panel main create-setup"},r.a.createElement(Vt,{onAddClick:function(e){_({type:"addRole",role:"".concat(e.name,":").concat("None"!=R?R:""),alignment:e.alignment})},gameType:a}),W.loggedIn&&r.a.createElement("div",{className:"creation-options"},r.a.createElement(Be,{fields:o,onChange:s,submitText:x?"Edit":"Create",onSubmit:function(){return f(G,x,j)}}),r.a.createElement("div",{className:"rolesets-wrapper"},r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Role Modifier"),r.a.createElement("select",{value:R,onChange:function(e){var t=e.target.value;P(t)}},H))),r.a.createElement("div",{className:"rolesets"},t,!G.closed&&G.roles.length<10&&r.a.createElement("i",{className:"add-roleset fa-plus-circle fas",onClick:function(){return _({type:"addRoleSet"})}})))),N&&r.a.createElement(u.a,{to:"/play/host/?setup=".concat(N)}))}function Nt(e){return r.a.createElement("div",{className:"roleset ".concat(e.sel==e.index?"sel":""),onClick:e.onClick},e.roles,e.index>0&&r.a.createElement("i",{className:"del-roleset fa-times-circle fas",onClick:e.onDelete}))}function jt(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=_e([{label:"Setup Name",ref:"name",type:"text"},{label:"Day Start",ref:"startState",type:"boolean"},{label:"Dawn",ref:"dawn",type:"boolean"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Last Wills",ref:"lastWill",type:"boolean"},{label:"Must Act",ref:"mustAct",type:"boolean"},{label:"No Reveal",ref:"noReveal",type:"boolean"},{label:"Votes Invisible",ref:"votesInvisible",type:"boolean"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Village Count",ref:"count-Village",type:"number",value:"7",min:"0",max:"50",showIf:"closed"},{label:"Mafia Count",ref:"count-Mafia",type:"number",value:"3",min:"0",max:"50",showIf:"closed"},{label:"Monsters Count",ref:"count-Monsters",type:"number",value:"0",min:"0",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"2",min:"0",max:"50",showIf:"closed"}]),s=Object(i.a)(o,3),c=s[0],l=s[1],m=s[2],f=Object(n.useContext)(k);return Object(n.useEffect)((function(){document.title="Create Mafia Setup | BeyondMafia"}),[]),r.a.createElement(kt,{gameType:"Mafia",formFields:c,updateFormFields:l,resetFormFields:m,closedField:c[9],formFieldValueMods:{startState:[function(e){return"Day"==e}]},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Mafia",roles:e.roles,closed:e.closed,name:c[0].value,startState:c[1].value?"Day":"Night",dawn:c[2].value,whispers:c[3].value,leakPercentage:Number(c[4].value),lastWill:c[5].value,mustAct:c[6].value,noReveal:c[7].value,votesInvisible:c[8].value,unique:c[10].value,count:{Village:Number(c[11].value),Mafia:Number(c[12].value),Monsters:Number(c[13].value),Independent:Number(c[14].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(c[0].value,"'"),"success"),r(e.data)})).catch(a)}})}a(73);function St(e){var t=[{name:"Armed",text:"Starts with a gun.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Armed"})},{name:"Explosive",text:"Starts with a bomb.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Explosive"})},{name:"Armored",text:"Starts with armor.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Armored"})},{name:"Exposed",text:"Starts revealed to everyone.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Exposed"})},{name:"Chameleon",text:"Appears as a Villager to investigative roles.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Chameleon"})},{name:"Humble",text:"Appears as Villager to self with no modifier.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Humble"})},{name:"Scatterbrained",text:"Appears as Visitor (if Village-aligned) or Trespasser (if Mafia-aligned) to self with no modifier.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Scatterbrained"})},{name:"Lone",text:"Does not attend the Mafia or Monsters meeting.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Lone"})},{name:"Solitary",text:"Does not attend the Cop or Templar meetings.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Solitary"})},{name:"Delayed",text:"Cannot attend secondary meetings for the first day and night.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Delayed"})},{name:"Even",text:"Can only attend secondary meetings on even days and nights.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Even"})},{name:"Odd",text:"Can only attend secondary meetings on odd days and nights.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Odd"})},{name:"One Shot",text:"Can only perform actions once.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-One-Shot"})},{name:"Bloodthirsty",text:"Needs to kill other players to stay alive.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Bloodthirsty"})},{name:"Loud",text:"All reports recieved are announced to everyone, with the player's role revealed.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Loud"})},{name:"Astral",text:"All actions done by this player do not appear as visits.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Astral"})},{name:"Unblockable",text:"All actions done by this player cannot be roleblocked or controlled.",icon:r.a.createElement("div",{className:"icon modifier modifier-Mafia-Unblockable"})}];return Object(n.useEffect)((function(){document.title="Learn Mafia | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Mafia is a game of social deception where an informed minority (the Mafia) compete against the uniformed majority (the Village). The Mafia choose one player to kill each night, and they win the game if they successfully outnumber the non-mafia players at any point. Everyone votes to execute one person during the day, with the Village aiming to eliminate all mafia members."),r.a.createElement("div",{className:"paragraph"},"In addition to the Village and the Mafia, there are two other alignments: Independent and Monsters. Independents are not aligned with a side and usually have their own unique win condition. Monsters meet together and win if they reach the majority just like the mafia, but they do not vote to kill someone each night."),r.a.createElement("div",{className:"paragraph"},"At the beginning of a game, each player is given a role. This role may grant the player special abilities, usually in the form of actions they can take to aid their side. A list of all roles and their abilities can be found below.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(Vt,{gameType:"Mafia"}),r.a.createElement("div",{className:"heading"},"Items"),r.a.createElement(H,{panels:[{name:"Gun",text:"Can be shot once during the day to kill a specific player."},{name:"Armor",text:"Saves a player from being killed one time, not including being executed."},{name:"Bomb",text:"When a player is killed while holding a bomb, the player who killed them will also die."},{name:"Crystal",text:"The holder of the crystal can choose a person each night and if they die, their target's role will be revealed."},{name:"Knife",text:"Can be used once during the day to stab a specific player, who will bleed out and die the following night."},{name:"Snowball",text:"Can be used once during the day to freeze a specific player, who will be roleblocked the following night."},{name:"Key",text:"Can be used once during the night to make the player untargetable. All actions on the player are cancelled"},{name:"Bread",text:"Given out by the baker. Counts as 1 ration for each phase in a famine."},{name:"Yuzu Orange",text:"Given out by the Capybara to invite players to relax at the hot springs. Counts as 1 ration for each phase in a famine."},{name:"Suit",text:"Given by the tailor, a suit determines what role a user will appear as once dead."},{name:"Gasoline",text:"Used by the arsonist to douse their victims in preparation for their ignition."},{name:"Match",text:"Used by the arsonist to ignite everyone doused with gasoline."}]}),r.a.createElement("div",{className:"heading"},"Mechanics"),r.a.createElement(H,{panels:[{name:"Whispers",text:"Allow players to privately contact another player in the town meeting. If the whisper leaks then everyone will see it."},{name:"Last Wills",text:"Allow players to write a message that will be revealed when they die."},{name:"Must Act",text:"Players cannot select 'no one' for their actions."},{name:"No Reveal",text:"The roles of dead players are not revealed."},{name:"Closed Roles",text:"Roles for each alignment are randomly chosen from the pool of roles in the setup."},{name:"Dawn",text:"No actions can be taken the first night."},{name:"Full Moon",text:"When a Lycan or Werewolf is present in the game, full moons will occur on odd nights."},{name:"Eclipse",text:"Occurs during the day due to certain roles, making all votes and speech anonymous."},{name:"Famine",text:"While active, each player consumes one item of food each day/night. Anyone who doesn't have food to consume dies."}]}),r.a.createElement("div",{className:"heading"},"Modifiers"),r.a.createElement(H,{panels:t})))}function Ct(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(i.a)(s,2),l=c[0],m=c[1],f=Object(n.useContext)(k),p=I(),h=_e([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:y.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Initial Round Length (minutes)",ref:"initRoundLength",type:"number",value:3,min:1,max:5},{label:"Hostage Swap Length (minutes)",ref:"hostageSwapLength",type:"number",value:.5,min:.1,max:1,step:.1}]),g=Object(i.a)(h,2),v=g[0],b=g[1];function E(e){var t,a=Object(T.a)(v);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host Split Decision | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(Et,{gameType:"Split Decision",selSetup:a,setSelSetup:o,formFields:v,updateFormFields:b,onHostGame:function(){var e=v[6].value;a.id?d.a.post("/game/host",{gameType:"Split Decision",setup:a.id,lobby:E("lobby"),private:E("private"),guests:E("guests"),ranked:E("ranked"),spectating:E("spectating"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{"Initial Round":E("initialRoundLength"),"Hostage Swap":E("hostageSwapLength")}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function xt(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=_e([{label:"Setup Name",ref:"name",type:"text"},{label:"Initial Swap Amount",ref:"swapAmt",type:"number",value:"1",min:"1",max:"24"},{label:"Round Amount",ref:"aroundAmt",type:"number",value:3,min:2,max:10},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Blue Count",ref:"count-Blue",type:"number",value:"4",min:"1",max:"50",showIf:"closed"},{label:"Red Count",ref:"count-Red",type:"number",value:"4",min:"1",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"1",min:"0",max:"50",showIf:"closed"}]),s=Object(i.a)(o,3),c=s[0],l=s[1],m=s[2],f=Object(n.useContext)(k);return Object(n.useEffect)((function(){document.title="Create Split Decision Setup | BeyondMafia"}),[]),r.a.createElement(kt,{gameType:"Split Decision",formFields:c,updateFormFields:l,resetFormFields:m,closedField:c[5],formFieldValueMods:{},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Split Decision",roles:e.roles,closed:e.closed,name:c[0].value,startState:"Round",swapAmt:Number(c[1].value),roundAmt:Number(c[2].value),whispers:c[3].value,leakPercentage:Number(c[4].value),unique:c[6].value,count:{Red:Number(c[7].value),Blue:Number(c[8].value),Independent:Number(c[9].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(c[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function It(e){return Object(n.useEffect)((function(){document.title="Learn Split Decision | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on the card game ",r.a.createElement("a",{href:"https://www.tuesdayknightgames.com/tworoomsandaboom",target:"_blank"},"2 Rooms and a Boom")," by Tudesday Knight Games."),r.a.createElement("div",{className:"paragraph"},"In Split Decision, all players are randomly a split among two rooms, as well as split among two teams: Red and Blue. One player is assigned the role of President, and another is the Bomber. The game plays over a series of rounds, and in each round each room will elect a leader. Those leaders will then meet together and choose one or more players (the hostages) to swap between the rooms for the next round."),r.a.createElement("div",{className:"paragraph"},"As the game progresses the rounds will get shorter and the number of players swapped between rooms will decrease. It is the goal of the Red team for the President and the Bomber to end up in the same room after the last round. It is the goal of the Blue team for them to end up in different rooms.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(Vt,{gameType:"Split Decision"})))}function Lt(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(i.a)(s,2),l=c[0],m=c[1],f=Object(n.useContext)(k),p=I(),h=_e([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:y.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Team Selection Length (minutes)",ref:"teamSelLength",type:"number",value:2,min:1,max:5},{label:"Team Approval Length (minutes)",ref:"teamApprovalLength",type:"number",value:.5,min:.1,max:2,step:.1},{label:"Mission Length (minutes)",ref:"missionLength",type:"number",value:.5,min:.1,max:1,step:.1}]),g=Object(i.a)(h,2),v=g[0],b=g[1];function E(e){var t,a=Object(T.a)(v);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host Resistance | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(Et,{gameType:"Resistance",selSetup:a,setSelSetup:o,formFields:v,updateFormFields:b,onHostGame:function(){var e=v[6].value;a.id?d.a.post("/game/host",{gameType:"Resistance",setup:a.id,lobby:E("lobby"),private:E("private"),guests:E("guests"),spectating:E("spectating"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{"Team Selection":E("teamSelLength"),"Team Approval":E("teamApprovalLength"),Mission:E("missionLength")}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function Tt(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=_e([{label:"Setup Name",ref:"name",type:"text"},{label:"First Team Size",ref:"firstTeamSize",type:"number",value:"2",min:"2",max:"49"},{label:"Last Team Size",ref:"lastTeamSize",type:"number",value:"4",min:"2",max:"49"},{label:"Number of Missions",ref:"numMissions",type:"number",value:"5",min:"2",max:"10"},{label:"Team Formation Attempts",ref:"teamFailLimit",type:"number",value:"5",min:"1",max:"49"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Resistance Count",ref:"count-Resistance",type:"number",value:"3",min:"2",max:"49",showIf:"closed"},{label:"Spies Count",ref:"count-Spies",type:"number",value:"2",min:"1",max:"49",showIf:"closed"}]),s=Object(i.a)(o,3),c=s[0],l=s[1],m=s[2],f=Object(n.useContext)(k);return Object(n.useEffect)((function(){document.title="Create Resistance Setup | BeyondMafia"}),[]),r.a.createElement(kt,{gameType:"Resistance",formFields:c,updateFormFields:l,resetFormFields:m,closedField:c[7],formFieldValueMods:{},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"Resistance",roles:e.roles,closed:e.closed,name:c[0].value,startState:"Team Selection",firstTeamSize:Number(c[1].value),lastTeamSize:Number(c[2].value),numMissions:Number(c[3].value),teamFailLimit:Number(c[4].value),whispers:c[5].value,leakPercentage:Number(c[6].value),unique:c[8].value,count:{Resistance:Number(c[9].value),Spies:Number(c[10].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(c[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function At(e){return Object(n.useEffect)((function(){document.title="Learn Resistance | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on the card game ",r.a.createElement("a",{href:"https://www.boardgamegeek.com/boardgame/41114/resistance",target:"_blank"},"The Resistance")," by Don Eskridge."),r.a.createElement("div",{className:"paragraph"},"In Resistance, a group of rebels is trying to overthrow the government by completing a series of missions. However, the government has caught word of the plan and has recruited spies to inflitrate the resistance and sabotage the missions."),r.a.createElement("div",{className:"paragraph"},"At the beginning of each mission a player is selected as the leader and must recruit several group members to the team. All players vote on the selected team and if the majority approve then the mission will proceed. Otherwise, a new leader is chosen to make a new team. If several leaders are unable to form a team then that mission automatically fails."),r.a.createElement("div",{className:"paragraph"},"During a mission the members of the teams who are spies can choose to either make the mission succeed or fail. If at least one team member opts for it to fail then the entire mission will fail, otherwise it will succeed. The game continues until a certain number of missions succeed or fail, with the Resistance and the Spies winning respectively.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(Vt,{gameType:"Resistance"})))}function Mt(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(i.a)(s,2),l=c[0],m=c[1],f=Object(n.useContext)(k),p=I(),h=_e([{label:"Setup",ref:"setup",type:"text",disabled:!0},{label:"Lobby",ref:"lobby",type:"select",value:localStorage.getItem("lobby")||"Main",options:y.map((function(e){return{label:e,value:e}}))},{label:"Private",ref:"private",type:"boolean"},{label:"Allow Guests",ref:"guests",type:"boolean"},{label:"Spectating",ref:"spectating",type:"boolean"},{label:"Scheduled",ref:"scheduled",type:"boolean"},{label:"Ready Check",ref:"readyCheck",type:"boolean"},{label:"Start Date",ref:"startDate",type:"datetime-local",showIf:"scheduled",value:Date.now()+36e4,min:Date.now()+36e4,max:Date.now()+24192e5},{label:"Day Length (minutes)",ref:"dayLength",type:"number",value:10,min:1,max:30},{label:"Night Length (minutes)",ref:"nightLength",type:"number",value:2,min:1,max:10}]),g=Object(i.a)(h,2),v=g[0],b=g[1];function E(e){var t,a=Object(T.a)(v);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ref==e)return n.value}}catch(r){a.e(r)}finally{a.f()}}return Object(n.useEffect)((function(){document.title="Host One Night | BeyondMafia"}),[]),l?r.a.createElement(u.a,{to:l}):r.a.createElement(Et,{gameType:"One Night",selSetup:a,setSelSetup:o,formFields:v,updateFormFields:b,onHostGame:function(){var e=v[6].value;a.id?d.a.post("/game/host",{gameType:"One Night",setup:a.id,lobby:E("lobby"),private:E("private"),guests:E("guests"),spectating:E("spectating"),scheduled:e&&new Date(E("startDate")).getTime(),readyCheck:E("readyCheck"),stateLengths:{Day:E("dayLength"),Night:E("nightLength")}}).then((function(t){e?(f.showAlert("Game scheduled.","success"),m("/")):m("/game/".concat(t.data))})).catch(p):p("You must choose a setup")}})}function Rt(){var e=Object(u.h)(),t=new URLSearchParams(e.search),a=I(),o=_e([{label:"Setup Name",ref:"name",type:"text"},{label:"Whispers",ref:"whispers",type:"boolean"},{label:"Whisper Leak Percentage",ref:"leakPercentage",type:"number",value:"5",min:"0",max:"100",showIf:"whispers"},{label:"Must Act",ref:"mustAct",type:"boolean"},{label:"Votes Invisible",ref:"votesInvisible",type:"boolean"},{label:"Excess Roles",ref:"excessRoles",type:"number",value:"3",min:"2",max:"10"},{label:"Closed Roles",ref:"closed",type:"boolean"},{label:"Unique Roles",ref:"unique",type:"boolean",showIf:"closed"},{label:"Village Count",ref:"count-Village",type:"number",value:"7",min:"0",max:"50",showIf:"closed"},{label:"Werewolves Count",ref:"count-Werewolves",type:"number",value:"0",min:"0",max:"50",showIf:"closed"},{label:"Independent Count",ref:"count-Independent",type:"number",value:"2",min:"0",max:"50",showIf:"closed"}]),s=Object(i.a)(o,3),c=s[0],l=s[1],m=s[2],f=Object(n.useContext)(k);return Object(n.useEffect)((function(){document.title="Create One Night Setup | BeyondMafia"}),[]),r.a.createElement(kt,{gameType:"One Night",formFields:c,updateFormFields:l,resetFormFields:m,closedField:c[6],formFieldValueMods:{startState:[function(e){return"Day"==e}]},onCreateSetup:function(e,n,r){d.a.post("/setup/create",{gameType:"One Night",roles:e.roles,closed:e.closed,name:c[0].value,whispers:c[1].value,leakPercentage:Number(c[2].value),mustAct:c[3].value,votesInvisible:c[4].value,excessRoles:c[5].value,unique:c[7].value,count:{Village:Number(c[8].value),Werewolves:Number(c[9].value),Independent:Number(c[10].value)},editing:n,id:t.get("edit")}).then((function(e){f.showAlert("".concat(n?"Edited":"Created"," setup '").concat(c[0].value,"'"),"success"),r(e.data)})).catch(a)}})}function Pt(e){return Object(n.useEffect)((function(){document.title="Learn One Night | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"learn"},r.a.createElement("div",{className:"heading"},"Synopsis"),r.a.createElement("div",{className:"paragraphs"},r.a.createElement("div",{className:"paragraph"},"Based on ",r.a.createElement("a",{href:"https://beziergames.com/collections/one-night-ultimate-werewolf",target:"_blank"},"One Night Ultimate Werewolf")," by Bezier Games."),r.a.createElement("div",{className:"paragraph"},"One Night is a game of logical deduction similar to Mafia, but with only one Night and one Day phase."),r.a.createElement("div",{className:"paragraph"},"The Village side must kill one of the Werewolves to win, and Werewolves must kill one of the village. The Village also loses if there are no Werewolves present but they kill a Village member. The one night is typically eventful; the role you are given at the beginning of the night may not be the card you end up with. Actions will all take place at once at the end of the night. The order of events is given by times in the role descriptions.")),r.a.createElement("div",{className:"heading"},"Roles"),r.a.createElement(Vt,{gameType:"One Night"})))}a(463);function Ft(e){var t=Object(n.useContext)(O),a=Object(u.h)(),o=Object(u.g)(),s=new URLSearchParams(a.search),c="/play"==a.pathname,l=Object(n.useState)(s.get("game")||localStorage.getItem("gameType")||"Mafia"),m=Object(i.a)(l,2),d=m[0],f=m[1],p=[{text:"Play",path:"/play",exact:!0},{text:"Host",path:"/play/host",hide:!t.loggedIn},{text:"Create Setup",path:"/play/create",hide:!t.loggedIn},{text:"Learn",path:"/play/learn"}];return Object(n.useEffect)((function(){localStorage.setItem("gameType",d),c||s.get("edit")||s.get("game")==d||o.push(a.pathname+"?game=".concat(d))}),[a.pathname,d]),r.a.createElement(r.a.Fragment,null,r.a.createElement(me,{links:p,showFilter:!c,filterSel:d,filterOptions:v,onFilter:function(e){f(e)},filterIcon:r.a.createElement("i",{className:"fas fa-gamepad"})}),r.a.createElement("div",{className:"inner-content play"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/play",render:function(){return r.a.createElement(gt,null)}}),r.a.createElement(u.b,{exact:!0,path:"/play/host",render:function(){switch(d){case"Mafia":return r.a.createElement(Ot,null);case"Split Decision":return r.a.createElement(Ct,null);case"Resistance":return r.a.createElement(Lt,null);case"One Night":return r.a.createElement(Mt,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{exact:!0,path:"/play/create",render:function(){switch(d){case"Mafia":return r.a.createElement(jt,null);case"Split Decision":return r.a.createElement(xt,null);case"Resistance":return r.a.createElement(Tt,null);case"One Night":return r.a.createElement(Rt,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{exact:!0,path:"/play/learn",render:function(){switch(d){case"Mafia":return r.a.createElement(St,null);case"Split Decision":return r.a.createElement(It,null);case"Resistance":return r.a.createElement(At,null);case"One Night":return r.a.createElement(Pt,null);default:return f("Mafia"),r.a.createElement(r.a.Fragment,null)}}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/play"})}}))))}function Dt(e){var t=e.sel.toLowerCase()==e.text.toLowerCase();return r.a.createElement("div",{className:"top-link ".concat(t?"active":""),onClick:e.onClick},e.text)}function Bt(e){var t,a,o=Object(n.useRef)(),s=Object(n.useContext)(N),c=e.isRolePrediction,i=e.makeRolePrediction;if("string"==typeof e.role?(t=e.role.split(":")[0],a=e.role.split(":")[1]):e.role&&(t=e.role.name,a=e.role.modifier),c&&(a="Unknown"),e.closed)return e.count>0||e.hideCount?r.a.createElement("div",{className:"role-count-wrap"},r.a.createElement("i",{className:"fas fa-question i-".concat(e.alignment),onClick:e.onClick}),!e.hideCount&&r.a.createElement("div",{className:"super"},e.count)):r.a.createElement(r.a.Fragment,null);var l=t?"".concat(te(e.gameType),"-").concat(te(t)):"null";return r.a.createElement("div",{className:"role-count-wrap"},r.a.createElement("div",{className:"role role-".concat(l," ").concat(e.small?"small":""," ").concat(e.bg?"bg":""),title:"".concat(t||""," ").concat(a?"(".concat(a,")"):""),onClick:function(){e.onClick&&e.onClick(),i?i(t):t&&e.showPopover&&"null"!==t&&s.onClick("/roles/".concat(e.gameType,"/").concat(t),"role",o.current,t)},onMouseEnter:function(a){e.onMouseEnter&&e.onMouseEnter(),t&&e.showSecondaryHover&&"null"!==t&&s.onHover("/roles/".concat(e.gameType,"/").concat(t),"role",o.current,t,null,a.clientY)},ref:o},a&&r.a.createElement("div",{className:"modifier modifier-".concat(e.gameType,"-").concat(te(a))})),e.count>0&&r.a.createElement("div",{className:"super"},e.count))}function Vt(e){var t=Object(n.useState)(b[e.gameType][0]),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(""),l=Object(i.a)(c,2),u=l[0],m=l[1],d=Object(n.useRef)([]),f=(I(),Object(n.useContext)(O)),p=Object(n.useContext)(k),h=Object(n.useContext)(N);var g=b[e.gameType].map((function(e){return r.a.createElement(Dt,{text:e,sel:o,onClick:function(){return t=e,m(""),void s(t);var t},key:e})}));if(!p.roles)return r.a.createElement(Ee,{className:"roles-loading"});var v=p.roles[e.gameType].map((function(t,a){if(!t.disabled&&(t.alignment==o||u.length>0&&-1!=t.name.toLowerCase().indexOf(u)))return r.a.createElement("div",{className:"role-cell",key:t.name},f.loggedIn&&e.onAddClick&&r.a.createElement("i",{className:"add-role fa-plus-circle fas",onClick:function(a){a.stopPropagation(),e.onAddClick(t)}}),r.a.createElement("div",{className:"role-cell-content",onClick:function(){return function(t,a){h.onClick("/roles/".concat(e.gameType,"/").concat(a.name),"role",t,a.name)}(d.current[a],t)},ref:function(e){return d.current[a]=e}},r.a.createElement(Bt,{role:t.name,gameType:e.gameType}),t.name))}));return r.a.createElement("div",{className:"role-list-container"},r.a.createElement("div",{className:"top-bar"},g,r.a.createElement(pe,{value:u,placeholder:"Role Name",onInput:function(t){m(t.toLowerCase()),""!=t&&o.length>0?s(""):""==t&&0==o.length&&s(b[e.gameType][0])}})),r.a.createElement("div",{className:"role-list"},v))}a(464),a(465);function Ut(e){var t,a,o=Object(n.useContext)(O),s=Object(n.useContext)(N),c=Object(n.useRef)(),i=e.maxRolesCount||5,l=!1;if("string"==typeof e.setup.roles&&(e.setup.roles=JSON.parse(e.setup.roles)),e.setup.closed){t=[];var u,m=Object(T.a)(b[e.setup.gameType]);try{for(m.s();!(u=m.n()).done;){var d=u.value;t.push(r.a.createElement(Bt,{closed:!0,alignment:d,count:e.setup.count[d],gameType:e.setup.gameType,key:d}))}}catch(p){m.e(p)}finally{m.f()}}else{var f=Object.keys(e.setup.roles[0]);a=e.setup.roles.length>1,(t=f.map((function(t){return r.a.createElement(Bt,{small:!0,role:t,count:e.setup.roles[0][t],gameType:e.setup.gameType,key:t})}))).length>i&&(t=t.slice(0,i),l=!0)}return r.a.createElement("div",{className:"setup",ref:c,onClick:function(){s.onClick("/setup/".concat(e.setup.id),"setup",c.current,q(e.setup.name,o.settings),(function(e){return e.roles=JSON.parse(e.roles)}))}},r.a.createElement(_t,{gameType:e.setup.gameType}),a&&r.a.createElement("i",{className:"multi-setup-icon fas fa-list-alt"}),t,l&&r.a.createElement("i",{className:"fas fa-ellipsis-h"}))}function Gt(e){var t;return t=Array.isArray(e.roles)?e.roles.map((function(t){return r.a.createElement(Bt,{small:!0,role:t,makeRolePrediction:e.makeRolePrediction,key:t||"null",showSecondaryHover:!0,gameType:e.gameType})})):Object.keys(e.roles).map((function(t){return r.a.createElement(Bt,{role:t,count:e.roles[t],small:!0,gameType:e.gameType,showSecondaryHover:!0,key:t})})),r.a.createElement("div",{className:"small-role-list"},t)}function _t(e){var t=te(e.gameType);return r.a.createElement("div",{className:"game-icon ".concat(t)})}function Wt(e){var t;return"Day"==e.state?t="sun":"Night"==e.state&&(t="moon"),r.a.createElement("i",{className:"fa-".concat(t," fas state-icon")})}var Ht=a(35),$t=a(21),Yt=a(15),zt=a(16),qt=a(8),Kt=a(9),Jt=function(e){Object(Yt.a)(a,e);var t=Object(zt.a)(a);function a(e,n){var r;return Object(qt.a)(this,a),(r=t.call(this,new WebSocket(e))).path=e,r.persistent=n,r.configurePing(),r.configureClose(),r}return Object(Kt.a)(a,[{key:"reconnect",value:function(){Object(Ht.a)(Object($t.a)(a.prototype),"setSocket",this).call(this,new WebSocket(this.path)),this.heartbeat(),this.configureClose()}},{key:"configurePing",value:function(){var e=this;this.heartbeat(),this.on("p",(function(){return e.heartbeat()}))}},{key:"heartbeat",value:function(){var e=this;clearTimeout(this.pingTimeout),this.send("p"),this.pingTimeout=setTimeout((function(){e.socket.close()}),11e3)}},{key:"configureClose",value:function(){var e=this;this.socket.addEventListener("close",(function(){e.persistent&&e.reconnect()}))}},{key:"clear",value:function(){clearTimeout(this.pingTimeout),this.persistent=!1,this.listeners={},this.sendQueue=[],this.socket&&this.socket.close(),this.socket=null}}]),a}(function(){function e(t){Object(qt.a)(this,e),this.listeners={},this.sendQueue=[],this.received=[],this.setSocket(t)}return Object(Kt.a)(e,[{key:"setSocket",value:function(e){var t=this;this.socket=e,this.configureListeners(),this.socket.addEventListener("open",(function(){t.received=[];var e,a=Object(T.a)(t.sendQueue);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.socket.send(n)}}catch(r){a.e(r)}finally{a.f()}})),this.socket.addEventListener("close",(function(){t.triggerEvent("disconnected")})),this.socket.addEventListener("error",(function(){t.terminate()}))}},{key:"configureListeners",value:function(){var e=this;this.socket.addEventListener("message",(function(t){var a=function(e){var t=e.split(/:([\s\S]*)/),a=t[0];if(t.length<2)return[a];if((t=t[1].split(/:([\s\S]*)/)).length<2)return;var n=t[0],r=t[1];switch(n){case"number":r=Number(r);break;case"boolean":r="false"!=r;break;case"object":try{r=JSON.parse(r)}catch(o){return}}return[a,r]}(t.data),n=Object(i.a)(a,2),r=n[0],o=n[1];e.triggerEvent(r,o),e.received.push({eventName:r,data:o})}))}},{key:"triggerEvent",value:function(e,t){var a=this.listeners[e];if(a)for(var n=0;n<a.length;n++)a[n](t)}},{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),t=t.bind(this),this.listeners[e].push(t);var a,n=Object(T.a)(this.received);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.eventName==e&&t(r.data)}}catch(o){n.e(o)}finally{n.f()}}},{key:"send",value:function(e,t){var a=function(e,t){var a=typeof t;if("undefined"==a)return e;"object"==a?t=JSON.stringify(t):"string"!=a&&(t=String(t));return"".concat(e,":").concat(a,":").concat(t)}(e,t);0==this.socket.readyState?this.sendQueue.push(a):1==this.socket.readyState&&this.socket.send(a)}},{key:"clearListeners",value:function(){var e={};e.p=this.listeners.p,this.listeners=e}},{key:"terminate",value:function(){this.socket.close()}},{key:"readyState",get:function(){return this.socket?this.socket.readyState:3}}]),e}());function Qt(){Qt=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),c=new j(r||[]);return n(s,"_invoke",{value:w(e,a,c)}),s}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(S([])));v&&v!==t&&a.call(v,o)&&(h=v);var y=p.prototype=d.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function s(){return new t((function(r,s){!function n(r,o,s,c){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(m).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(i.arg)}(n,o,r,s)}))}return r=r?r.then(s,s):s()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return C()}for(a.method=r,a.arg=o;;){var s=a.delegate;if(s){var c=O(s,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(E.prototype),i(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var s=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),i(y,c,"Generator"),i(y,o,(function(){return this})),i(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return s.type="throw",s.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(c&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),N(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;N(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function Xt(){return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/game/:gameId",render:function(e){return r.a.createElement(Zt,{key:e.match.params.gameId})}}),r.a.createElement(u.b,{exact:!0,path:"/game/:gameId/review",render:function(){return r.a.createElement(Zt,{review:!0})}}),r.a.createElement(u.a,{to:"/play"}))}function Zt(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(!1),m=Object(i.a)(c,2),f=m[0],v=m[1],y=Object(n.useState)(!1),b=Object(i.a)(y,2),E=b[0],w=b[1],O=Object(n.useState)(),S=Object(i.a)(O,2),C=S[0],x=S[1],L=Object(n.useState)(),A=Object(i.a)(L,2),M=A[0],R=A[1],P=Object(n.useState)(),F=Object(i.a)(P,2),D=F[0],B=F[1],V=Object(n.useState)({}),U=Object(i.a)(V,2),G=U[0],_=U[1],W=Object(n.useState)(0),H=Object(i.a)(W,2),$=H[0],Y=H[1],z=Object(n.useState)(),q=Object(i.a)(z,2),K=q[0],J=q[1],Q=Object(n.useState)({}),X=Object(i.a)(Q,2),Z=X[0],ee=X[1],te=Object(n.useState)({}),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],oe=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"set":var n=Object.keys(t.history).sort((function(e,t){return e-t}));a={states:t.history},-2==n[0]?a.currentState=-2:a.currentState=n[n.length-1];break;case"addState":var r;e.states[t.state.id]?a=e:(r=-2!=t.state.id?t.state.id-1:Object.keys(e.states).sort((function(e,t){return t-e}))[0],a=p()(e,{states:Object(g.a)({},t.state.id,{$set:{name:t.state.name,meetings:{},alerts:[],stateEvents:[],roles:Object(h.a)({},e.states[r].roles),dead:Object(h.a)({},e.states[r].dead),extraInfo:Object(h.a)({},t.state.extraInfo)}}),currentState:{$set:t.state.id}}));break;case"addMeeting":(s=e.states[e.currentState])&&(s.meetings||(a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:{$set:{}}})})),a=p()(a||e,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.meeting.id,{$set:t.meeting})})}));break;case"meetingMembers":e.states[e.currentState]&&e.states[e.currentState].meetings[t.meetingId]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.meetingId,{members:{$set:t.members}})})}));break;case"removeMeeting":e.states[e.currentState]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:{$unset:[t.meetingId]}})})).states[e.currentState].selTab==t.meetingId&&(a=p()(a,{states:Object(g.a)({},e.currentState,{$unset:["selTab"]})}));break;case"addMessage":e.states[e.currentState]&&(t.message.meetingId?e.states[e.currentState].meetings[t.message.meetingId]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.message.meetingId,{messages:{$push:[t.message]}})})})):a=p()(e,{states:Object(g.a)({},e.currentState,{alerts:{$push:[t.message]}})}));break;case"addQuote":e.states[e.currentState]&&e.states[e.currentState].meetings[t.quote.toMeetingId]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.quote.toMeetingId,{messages:{$push:[t.quote]}})})}));break;case"vote":var o=t.vote.target;(c=(s=e.states[e.currentState])&&s.meetings[t.vote.meetingId])&&(c.multi&&(o=[].concat(Object(he.a)(c.votes[t.vote.voterId]||[]),[o])),a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.vote.meetingId,{votes:Object(g.a)({},t.vote.voterId,{$set:o})})})}),t.vote.noLog||(a=p()(a,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.vote.meetingId,{voteRecord:{$push:[{type:"vote",voterId:t.vote.voterId,target:t.vote.target,time:Date.now()}]}})})})));break;case"unvote":var s,c;o=void 0,(c=(s=e.states[e.currentState])&&s.meetings[t.info.meetingId])&&(c.multi&&(o=(c.votes[t.info.voterId]||[]).filter((function(e){return e!=t.info.target}))),a=p()(e,{states:Object(g.a)({},e.currentState,{meetings:Object(g.a)({},t.info.meetingId,{votes:Object(g.a)({},t.info.voterId,{$set:o}),voteRecord:{$push:[{type:"unvote",voterId:t.info.voterId,time:Date.now()}]}})})}));break;case"stateEvents":e.states[e.currentState]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{stateEvents:{$set:t.stateEvents}})}));break;case"selTab":e.states[t.state]&&(a=p()(e,{states:Object(g.a)({},t.state,{selTab:{$set:t.meetingId}})}));break;case"reveal":e.states[e.currentState]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{roles:Object(g.a)({},t.playerId,{$set:t.role})})}));break;case"death":e.states[e.currentState]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{dead:Object(g.a)({},t.playerId,{$set:!0})})}));break;case"revival":e.states[e.currentState]&&(a=p()(e,{states:Object(g.a)({},e.currentState,{dead:Object(g.a)({},t.playerId,{$set:!1})})}))}return a||e}),{states:{}}),se=Object(i.a)(oe,2),ce=se[0],ie=se[1],le=function(e){return Object(n.useReducer)((function(t,a){var n;switch(a.type){case"backward":n=t>-2?t-1:Math.max.apply(Math,Object(he.a)(Object.keys(e.states)));break;case"forward":n=e.states[t+1]?t+1:-2;break;case"current":n=e.currentState;break;case"first":n=-1;break;default:n=t}return e.states[n]?n:t}),e.currentState)}(ce),ue=Object(i.a)(le,2),me=ue[0],de=ue[1],fe=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"set":a=t.players;break;case"add":a=e[t.player.id]?p()(e,Object(g.a)({},t.player.id,{$unset:["left"]})):p()(e,Object(g.a)({},t.player.id,{$set:t.player}));break;case"remove":a=p()(e,Object(g.a)({},t.playerId,{left:{$set:!0}}));break;case"setProp":a=p()(e,Object(g.a)({},t.playerId,Object(g.a)({},t.propName,{$set:t.propVal})))}return a||e}),{}),pe=Object(i.a)(fe,2),ge=pe[0],ye=pe[1],be=Object(n.useState)(0),Ne=Object(i.a)(be,2),je=Ne[0],Se=Ne[1],Ce=Object(n.useState)(!1),xe=Object(i.a)(Ce,2),Le=xe[0],Te=xe[1],Ae=Object(n.useState)(),Me=Object(i.a)(Ae,2),Re=Me[0],Pe=Me[1],Fe=Object(n.useState)(""),De=Object(i.a)(Fe,2),Be=De[0],Ve=De[1],Ue=Object(n.useReducer)((function(e,t){var a=Object(h.a)({},e);switch(t.type){case"create":a[t.timer.name]={delay:t.timer.delay,time:0};break;case"clear":delete a[t.name];break;case"update":a[t.name].time=t.time;break;case"updateAll":for(var n in a)a[n].time+=1e3;var r=a.pregameCountdown||a.secondary||a.main;if(!r)break;var o=Math.round((r.delay-r.time)/1e3);o<16&&o>0&&t.playAudio("tick")}return a}),{}),Ge=Object(i.a)(Ue,2),_e=Ge[0],We=Ge[1],He=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"load":try{a=window.localStorage.getItem("gameSettings"),a=JSON.parse(a)}catch(n){a=e}break;case"set":a=t.settings,window.localStorage.setItem("gameSettings",JSON.stringify(a));break;case"setProp":a=p()(e,Object(g.a)({},t.propName,{$set:t.propval})),window.localStorage.setItem("gameSettings",JSON.stringify(a))}return a||e}),{votingLog:!0,timestamps:!0,sounds:!0,volume:1}),$e=Object(i.a)(He,2),Ye=$e[0],ze=$e[1],qe=Object(n.useState)(!1),Ke=Object(i.a)(qe,2),Je=Ke[0],Qe=Ke[1],Xe=Object(n.useState)(!1),Ze=Object(i.a)(Xe,2),et=Ze[0],tt=Ze[1],at=Object(n.useState)({from:"",contains:""}),nt=Object(i.a)(at,2),rt=nt[0],ot=nt[1],st=Object(n.useState)(!1),ct=Object(i.a)(st,2),it=ct[0],lt=ct[1],ut=Object(n.useState)(new Set),mt=Object(i.a)(ut,2),dt=mt[0],ft=mt[1],pt=Object(n.useState)({}),ht=Object(i.a)(pt,2),gt=ht[0],vt=ht[1],yt=Object(n.useState)(),bt=Object(i.a)(yt,2),Et=bt[0],wt=bt[1],Ot=Object(n.useState)(!1),kt=Object(i.a)(Ot,2),Nt=kt[0],jt=kt[1],St=Object(n.useState)(!1),Ct=Object(i.a)(St,2),xt=Ct[0],It=Ct[1],Lt=Object(n.useState)(),Tt=Object(i.a)(Lt,2),At=Tt[0],Mt=Tt[1],Rt=Object(n.useState)(!1),Pt=Object(i.a)(Rt,2),Ft=Pt[0],Dt=Pt[1],Bt=Object(n.useRef)(),Vt=Object(n.useRef)(),Ut=Object(n.useRef)(),Gt=Object(n.useRef)(),_t=Object(n.useRef)(),Wt=function(e,t){var a=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"typing":a=p()(e,{typing:Object(g.a)({},t.playerId,{$set:t.meetingId})});break;case"speaking":var n=t.players.reduce((function(e,t){return e[t]=!0,e}),{});a=p()(e,{speaking:{$set:n}})}return a||e}),{typing:{},speaking:{}}),r=Object(i.a)(a,2),o=r[0],s=r[1];return Object(n.useEffect)((function(){var a=setInterval((function(){if(e.current){var a=[];t.current&&t.current.getVolumeLevel()>.001&&a.push(e.current.uid),e.current.remoteUsers.forEach((function(e){e.audioTrack&&e.audioTrack.getVolumeLevel()>.001&&a.push(e.uid)})),s({type:"speaking",players:a})}}),50);return function(){return clearInterval(a)}})),[o,s]}(Ut,Gt),Ht=Object(i.a)(Wt,2),$t=Ht[0],Yt=Ht[1],zt=function(e){var t=Object(n.useRef)({}),a=Object(n.useReducer)((function(a,n){var r;switch(n.type){case"play":if(!e.sounds)return a;if(a.overrides[n.audioName])for(var o in a.overrides)a.overrides[o]&&t.current[o]&&t.current[o].pause();t.current[n.audioName]&&(t.current[n.audioName].currentTime=0,t.current[n.audioName].play().catch((function(e){})));break;case"load":for(var s in r={overrides:Object(h.a)({},a.overrides),volumes:Object(h.a)({},a.volumes)},n.files){var c=n.files[s];t.current[c]||(t.current[c]=new Audio("/audio/".concat(c,".mp3")),t.current[c].load(),t.current[c].loop=n.loops[s]),r.overrides[c]=n.overrides[s],r.volumes[c]=n.volumes[s]}break;case"volume":for(var i in t.current)a.volumes[i]&&(t.current[i].volume=a.volumes[i]*n.volume)}return r||a}),{overrides:{},volumes:{}}),r=Object(i.a)(a,2),o=r[0],s=r[1];return Object(n.useEffect)((function(){s({type:"volume",volume:e.volume})}),[e.volume,o]),[function(e){s({type:"play",audioName:e})},function(e,t,a,n){s({type:"load",files:e,loops:t,overrides:a,volumes:n})},function(){for(var e in t.current)t.current[e].pause()},function(e){var a,n=Object(T.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;t.current[r].pause()}}catch(o){n.e(o)}finally{n.f()}},function(e){s({type:"volume",volume:e})}]}(Ye),qt=Object(i.a)(zt,5),Kt=qt[0],Xt=qt[1],Zt=qt[2],ea=qt[3],ta=(qt[4],Object(n.useContext)(k)),aa=(Object(n.useContext)(N),I()),na=Object(u.i)().gameId,ra=["bell","ping","tick"],oa=[!1,!1,!1],sa=[!1,!1,!1],ca=[1,1,1];function ia(e){return function(t){var a=gt;a[e]=t,null===t&&delete a[e],vt(a)}}function la(){Ut.current||(Ut.current=ve.a.createClient({mode:"rtc",codec:"vp8"}),Ut.current.on("user-published",function(){var e=Object(l.a)(Qt().mark((function e(t,a){return Qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("audio"==a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ut.current.subscribe(t,a);case 4:xt&&t.audioTrack.setVolume(0),t.audioTrack.play();case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Ut.current.on("user-unpublished",(function(e){var t=document.getElementById(e.uid);t&&t.remove()})))}function ua(){return(ua=Object(l.a)(Qt().mark((function e(t,a){return Qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Ut.current){e.next=5;break}la(),e.next=7;break;case 5:return e.next=7,ma();case 7:return e.next=9,Ut.current.join("f366ac8a8daa4be5bd04700e89b5e1ac",t,a,Re);case 9:if(Gt.current){e.next=14;break}return e.next=12,ve.a.createMicrophoneAudioTrack();case 12:Gt.current=e.sent,Nt&&Gt.current.setVolume(0);case 14:return e.next=16,Ut.current.publish([Gt.current]);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function ma(){return da.apply(this,arguments)}function da(){return(da=Object(l.a)(Qt().mark((function e(){return Qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ut.current){e.next=2;break}return e.abrupt("return");case 2:return Ut.current.remoteUsers.forEach((function(e){var t=document.getElementById(e.uid);t&&t.remove()})),e.next=5,Ut.current.leave();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(Object(n.useEffect)((function(){if(null!=D){var e;e="".concat("wss","://").concat("beyondmafia.com","/").concat(C);var t=new Jt(e);return t.on("connected",(function(){return Y($+1)})),t.on("disconnected",(function(){return Y($-1)})),_(t),function(){t&&t.clear()}}}),[D]),Object(n.useEffect)((function(){E&&(G.clear(),_({send:function(){}}))}),[E]),Object(n.useEffect)((function(){if(ze({type:"load"}),!e.review){var t=function(){var e=document.getElementById("speechInput"),t=document.activeElement.tagName;e&&"INPUT"!=t&&"TEXTAREA"!=t&&e.focus()};document.title="Game ".concat(na," | BeyondMafia"),Xt(ra,oa,sa,ca),function(){Na.apply(this,arguments)}();var a=setInterval((function(){We({type:"updateAll",playAudio:Kt})}),1e3);return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t),clearInterval(a),Zt(),ma(),Gt.current&&Gt.current.close()}}document.title="Review Game ".concat(na," | BeyondMafia"),d.a.get("/game/".concat(na,"/review/data")).then((function(e){var t=e.data;if(t.broken)return v(!0),void aa("Game not found.");R(t.type),J(t.setup),ee({ranked:t.ranked,spectating:t.spectating,private:!1}),ie({type:"set",history:JSON.parse(t.history)});var a={};for(var n in t.players)a[t.players[n]]={id:t.players[n],name:t.names[n],userId:t.users[n]?t.users[n].id:"",avatar:!!t.users[n]&&t.users[n].avatar,textColor:t.users[n]&&t.users[n].settings.textColor,nameColor:t.users[n]&&t.users[n].settings.nameColor,left:-1!=t.left.indexOf(t.players[n])};ye({type:"set",players:a}),s(!0)})).catch((function(e){v(!0),aa(e)}))}),[]),Object(n.useEffect)((function(){Vt.current=Re}),[Re]),Object(n.useEffect)((function(){null==me&&de({type:"current"})}),[ce.currentState]),Object(n.useEffect)((function(){Bt.current=ge}),[ge]),Object(n.useEffect)((function(){if(Z.voiceChat&&!e.review)if(Et){var t=ce.states[ce.currentState],a=t&&t.meetings[Et],n=a&&a.vcToken;n&&function(e,t){ua.apply(this,arguments)}(Et,n)}else ma()}),[Et]),Object(n.useEffect)((function(){1==G.readyState?(D?G.send("auth",D):G.send("join",{gameId:na,guestId:window.localStorage.getItem("cacheVal")}),G.on("authSuccess",(function(){G.send("join",{gameId:na,isBot:"?bot"==window.location.search})})),G.on("loaded",(function(){s(!0)})),G.on("setup",(function(e){J(e)})),G.on("options",(function(e){ee(e)})),G.on("emojis",(function(e){re(e)})),G.on("state",(function(e){ie({type:"addState",state:e})})),G.on("history",(function(e){ie({type:"set",history:e})})),G.on("players",(function(e){ye({type:"set",players:e})})),G.on("playerJoin",(function(e){ye({type:"add",player:e})})),G.on("playerLeave",(function(e){ye({type:"remove",playerId:e})})),G.on("spectatorCount",(function(e){Se(e)})),G.on("self",(function(e){Pe(e)})),G.on("reveal",(function(e){ia(e.playerId)(null),ie({type:"reveal",playerId:e.playerId,role:e.role})})),G.on("death",(function(e){ie({type:"death",playerId:e})})),G.on("revival",(function(e){ie({type:"revival",playerId:e})})),G.on("meeting",(function(e){ie({type:"addMeeting",meeting:e})})),G.on("members",(function(e){ie({type:"meetingMembers",meetingId:e.meetingId,members:e.members})})),G.on("leftMeeting",(function(e){ie({type:"removeMeeting",meetingId:e})})),G.on("stateEvents",(function(e){ie({type:"stateEvents",stateEvents:e})})),G.on("message",(function(e){ie({type:"addMessage",message:e});var t=e.content.match(/@[\w-]*/gm)||[];Vt.current&&Bt.current[Vt.current]&&(-1!=t.indexOf("@"+Bt.current[Vt.current].name)||-1!=t.indexOf("@everyone"))&&Kt("ping")})),G.on("quote",(function(e){ie({type:"addQuote",quote:e})})),G.on("vote",(function(e){ie({type:"vote",vote:e})})),G.on("unvote",(function(e){ie({type:"unvote",info:e})})),G.on("lastWill",(function(e){Ve(e)})),G.on("firstGame",(function(){tt(!0)})),G.on("timerInfo",(function(e){We({type:"create",timer:e}),"pregameCountdown"==e.name&&Notification&&"granted"==Notification.permission&&!document.hasFocus()&&new Notification("Your game is starting!")})),G.on("clearTimer",(function(e){We({type:"clear",name:e})})),G.on("time",(function(e){We({type:"update",name:e.name,time:e.time})})),G.on("typing",(function(e){Yt({type:"typing",playerId:e.playerId,meetingId:e.meetingId})})),G.on("isSpectator",(function(){Te(!0)})),G.on("left",(function(){_t.current||(v(!0),ta.hideAllAlerts())})),G.on("finished",(function(){w(!0)})),G.on("error",(function(e){v(!0),aa(e)})),G.on("dev",(function(){Dt(!0)}))):null!=G.readyState&&3!=G.readyState||f||E||e.review||d.a.get("/game/".concat(na,"/connect")).then((function(e){R(e.data.type),x(e.data.port),B(e.data.token||!1)})).catch((function(e){"Game not found."==(e&&e.response&&e.response.data)?v("review"):(v(!0),aa(e))}))}),[$]),"review"==f)return r.a.createElement(u.a,{to:"/game/".concat(na,"/review")});if(f)return r.a.createElement(u.a,{to:"/play"});if(At)return r.a.createElement(u.a,{to:"/game/".concat(At)});if(o&&null!=me){var fa={socket:G,review:e.review,setup:K,history:ce,updateHistory:ie,stateViewing:me,updateStateViewing:de,self:Re,isSpectator:Le,players:ge,updatePlayers:ye,timers:_e,options:Z,spectatorCount:je,lastWill:Be,emojis:ne,setLeave:v,finished:E,settings:Ye,updateSettings:ze,setShowSettingsModal:Qe,speechFilters:rt,setSpeechFilters:ot,isolationEnabled:it,setIsolationEnabled:lt,isolatedPlayers:dt,togglePlayerIsolation:function(e){var t=new Set(dt);t.has(e)?t.delete(e):t.add(e),ft(t)},rolePredictions:gt,toggleRolePrediction:ia,loadAudioFiles:Xt,playAudio:Kt,stopAudio:Zt,stopAudios:ea,setRehostId:Mt,agoraClient:Ut,localAudioTrack:Gt,setActiveVoiceChannel:wt,activity:$t,muted:Nt,setMuted:jt,deafened:xt,setDeafened:It,noLeaveRef:_t,dev:Ft};return r.a.createElement(j.Provider,{value:fa},r.a.createElement("div",{className:"game no-highlight"},r.a.createElement(Ea,{showModal:Je,setShowModal:Qe,settings:Ye,updateSettings:ze}),r.a.createElement(wa,{showModal:et,setShowModal:tt}),"Mafia"==M&&r.a.createElement(we,null),"Resistance"==M&&r.a.createElement(ke,null),"Split Decision"==M&&r.a.createElement(Oe,null),"One Night"==M&&r.a.createElement(Ie,null)))}return r.a.createElement("div",{className:"game"},r.a.createElement(Ee,null))}function ea(e,t){Object(n.useEffect)((function(){t.on&&e(t)}),[t])}function ta(e){var t=Object(u.i)().gameId,a=Object(n.useRef)(),o=I(),s=Object(n.useContext)(k),c=Object(n.useContext)(N);return r.a.createElement("div",{className:"top"},r.a.createElement("div",{className:"game-name-wrapper",onClick:function(){window.open("https://beyondmafia.com","_blank")}},e.gameName),r.a.createElement("div",{className:"state-wrapper"},r.a.createElement(ca,{history:e.history,stateViewing:e.stateViewing,updateStateViewing:e.updateStateViewing}),e.timer),r.a.createElement("div",{className:"misc-wrapper"},r.a.createElement("div",{className:"misc-left"},r.a.createElement("div",{className:"misc-buttons"},e.options.voiceChat&&r.a.createElement("i",{className:"misc-icon fas fa-microphone"}),r.a.createElement("i",{className:"misc-icon fas fa-info-circle",ref:a,onClick:function(e){e.stopPropagation(),c.onClick("/game/".concat(t,"/info"),"game",a.current,"Game ".concat(t))}}),r.a.createElement("i",{className:"misc-icon fas fa-cog",onClick:function(){e.setShowSettingsModal(!0)}}),e.dev&&r.a.createElement("i",{className:"misc-icon fas fa-vial",onClick:function(){for(var t=0;t<e.setup.total-1;t++)window.open(window.location+"?bot")}})),r.a.createElement("div",{className:"options"},!e.options.private&&!e.review&&r.a.createElement("i",{className:"fas fa-lock-open"}),e.options.private&&!e.review&&r.a.createElement("i",{className:"fas fa-lock"}),!e.review&&r.a.createElement("div",{className:"player-count"},r.a.createElement("i",{className:"fas fa-users"}),Object.values(e.players).filter((function(e){return!e.left})).length," / ",e.setup.total),!e.options.spectating&&!e.review&&r.a.createElement("div",{className:"no-spectator"},r.a.createElement("i",{className:"fas fa-eye-slash"})),e.options.spectating&&!e.review&&r.a.createElement("div",{className:"spectator-count"},r.a.createElement("i",{className:"fas fa-eye"}),e.spectatorCount))),e.setup&&r.a.createElement(Ut,{setup:e.setup}),r.a.createElement("div",{className:"btn btn-theme leave-game",onClick:function(){(e.finished||e.review||window.confirm("Are you sure you wish to leave?"))&&(e.finished&&s.hideAllAlerts(),e.socket.on?e.socket.send("leave"):e.setLeave(!0))}},"Leave"),!e.review&&-2==e.history.currentState&&r.a.createElement("div",{className:"btn btn-theme-sec rehost-game",onClick:function(){e.noLeaveRef.current=!0,e.socket.on&&e.socket.send("leave"),setTimeout((function(){var a={};for(var n in e.options.stateLengths)a[n]=e.options.stateLengths[n]/6e4;d.a.post("/game/host",Object(h.a)({rehost:t,gameType:e.gameType,setup:e.setup.id,lobby:e.options.lobby,private:e.options.private,spectating:e.options.spectating,guests:e.options.guests,ranked:e.options.ranked,stateLengths:a},e.options.gameTypeOptions)).then((function(t){return e.setRehostId(t.data)})).catch((function(t){e.noLeaveRef.current=!1,o(t)}))}),500)}},"Rehost")))}function aa(e){return r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"left-panel panel"},e.leftPanelContent),r.a.createElement("div",{className:"center-panel panel"},e.centerPanelContent),r.a.createElement("div",{className:"right-panel panel"},e.rightPanelContent))}function na(e){var t=Object(n.useContext)(j),a=t.isolationEnabled,o=t.isolatedPlayers,s=e.history,c=e.players,l=e.stateViewing,u=e.updateHistory,m=e.setActiveVoiceChannel,d=s.states[l],f=d?d.meetings:{},p=d?d.alerts:[],h=d&&d.selTab,g=Object(n.useState)(!0),v=Object(i.a)(g,2),y=v[0],b=v[1],E=Object(n.useState)(!1),w=Object(i.a)(E,2),O=w[0],k=w[1],N=Object(n.useRef)(),S=Object.values(f).filter((function(e){return e.speech}));function C(){y&&N.current&&(N.current.scrollTop=N.current.scrollHeight)}function x(t){e.review||"server"==t.senderId||t.isQuote||!t.quotable||e.socket.send("quote",{messageId:t.id,toMeetingId:s.states[s.currentState].selTab,fromMeetingId:t.meetingId,fromState:l})}Object(n.useLayoutEffect)((function(){return C()})),Object(n.useEffect)((function(){null!=l&&!h&&S.length&&u({type:"selTab",state:l,meetingId:S[0].id})}),[l,S]),Object(n.useEffect)((function(){l==s.currentState?b(!0):b(!1)}),[l]),Object(n.useEffect)((function(){function e(){k(!0),document.removeEventListener("mousemove",e)}return document.addEventListener("mousemove",e),function(){return document.removeEventListener("mousemove",e)}}),[]),Object(n.useEffect)((function(){h&&f[h]&&f[h].vcToken||m(null),m(h)}),[h,f]);var I=S.map((function(e){return r.a.createElement("div",{className:"tab ".concat(h==e.id?"sel":""),key:e.id,onClick:function(){return t=e.id,u({type:"selTab",state:l,meetingId:t}),void b(!0);var t}},e.name)})),L=function(e,t,a,n,r,o){var s;s=a?Object(he.a)(e[a].messages):[];o&&(o.from||o.contains)&&(s=s.filter((function(e){var t,a=-1!=(e.content||"").toLowerCase().indexOf(o.contains.toLowerCase()),r=(null===(t=n[e.senderId])||void 0===t?void 0:t.name)||"";return a=a&&-1!=r.toLowerCase().indexOf(o.from.toLowerCase())})));var c,i,l=Object(T.a)(t);try{for(l.s();!(c=l.n()).done;)for(var u=c.value,m=0;m<=s.length;m++){if(m==s.length){s.push(u);break}if(u.time<s[m].time){s.splice(m,0,u);break}}}catch(O){l.e(O)}finally{l.f()}if(!r.votingLog)return s;i=a?e[a].voteRecord:[];for(var d in e)e[d].speech||(i=i.concat(e[d].voteRecord));var f,p=Object(T.a)(i);try{for(p.s();!(f=p.n()).done;){var h=f.value,g="unvote"==h.type,v=n[h.voterId],y=v?v.name:"Anonymous",b=h.target;g||("*"!=b&&n[b]?b=n[b].name:"*"==b&&(b="no one"));for(var E={senderId:"vote",content:"".concat(y," ").concat(g?"unvotes":"votes"," ").concat(g?"":b),time:h.time},w=0;w<=s.length;w++){if(w==s.length){s.push(E);break}if(h.time<s[w].time){s.splice(w,0,E);break}}}}catch(O){p.e(O)}finally{p.f()}return s}(f,p,h,c,e.settings,e.filters);L=L.map((function(t,n){var i="server"!==t.senderId,l=a&&i&&o.size&&!o.has(t.senderId);return r.a.createElement(ra,{message:t,history:s,players:c,key:t.id||t.messageId+t.time||n,onMessageQuote:x,settings:e.settings,unfocusedMessage:l})}));var A=h;return A=(A=A&&(f[h].members.length>1||-1==s.currentState))&&l==s.currentState&&f[h].amMember&&f[h].canTalk,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"meeting-tabs"},I.length>0&&I,0==I.length&&r.a.createElement("div",{className:"tab sel"},d&&d.name)),r.a.createElement("div",{className:"speech-wrapper"},r.a.createElement("div",{className:"speech-display",onScroll:function(){if(O){var e=N.current;Math.round(e.scrollTop+e.clientHeight)>=Math.round(e.scrollHeight)?b(!0):b(!1)}else C()},ref:N},L),A&&r.a.createElement(sa,{meetings:f,selTab:h,players:c,options:e.options,socket:e.socket,setAutoScroll:b,agoraClient:e.agoraClient,localAudioTrack:e.localAudioTrack,muted:e.muted,setMuted:e.setMuted,deafened:e.deafened,setDeafened:e.setDeafened})))}function ra(e){var t,a,o,s=e.history,c=e.players,i=Object(n.useContext)(O),l=e.message,u="content ",m=!1,d=e.history.currentState,f=s.states[d].meetings;if("server"!=l.senderId&&"vote"!=l.senderId&&"anonymous"!=l.senderId&&(a=c[l.senderId]),l.isQuote){var p=s.states[l.fromState];if(!p)return r.a.createElement(r.a.Fragment,null);var g=p.meetings[l.fromMeetingId];if(!g)return r.a.createElement(r.a.Fragment,null);var v,y=Object(T.a)(g.messages);try{for(y.s();!(v=y.n()).done;){var b=v.value;if(b.id==l.messageId){(o=Object(h.a)({},b)).meetingName=g.name,"anonymous"==b.senderId?o.senderName="Anonymous":o.senderName=c[b.senderId].name;break}}}catch(N){y.e(N)}finally{y.f()}}if(l.isQuote&&!o)return r.a.createElement(r.a.Fragment,null);void 0!==f[l.meetingId]&&"Party!"===f[l.meetingId].name&&(u+="party "),!a&&"anonymous"!=l.senderId||l.isQuote||(u+="clickable "),l.isQuote||0!=l.content.indexOf("/me ")||(m=!0,(l=Object(h.a)({},l)).content=l.content.replace("/me ","")),l.isQuote?u+="quote ":"server"==l.senderId?u+="server ":"vote"==l.senderId?u+="vote-record ":m&&(u+="me ");var E,w,k={};return e.unfocusedMessage&&(k.opacity="0.2"),void 0!==a&&void 0!==a.birthday&&(E=Date.now(),w=a.birthday,E=new Date(E),w=new Date(w),E.setYear(0),w.setYear(0),E.getMonth()===w.getMonth()&&E.getDate()===w.getDate()&&(u+=" party ")),(null===(t=l.content)||void 0===t?void 0:t.startsWith(">"))&&(u+="greentext "),void 0!==a&&void 0!==a.textColor&&(u+="".concat(ae(a.textColor))),r.a.createElement("div",{className:"message",onDoubleClick:function(){return e.onMessageQuote(l)},style:k},r.a.createElement("div",{className:"sender"},e.settings.timestamps&&r.a.createElement(oa,{time:l.time}),a&&r.a.createElement(tt,{id:a.userId,name:a.name,avatar:a.avatar,color:a.nameColor,noLink:!0,small:!0}),"anonymous"==l.senderId&&r.a.createElement("div",{className:"name-with-avatar"},"Anonymous")),r.a.createElement("div",{className:u,style:a&&a.textColor?{color:ne(a.textColor)}:{}},!l.isQuote&&r.a.createElement(r.a.Fragment,null,l.prefix&&r.a.createElement("div",{className:"prefix"},"(",l.prefix,")"),r.a.createElement(z,{text:l.content,settings:i.settings,players:c,filterProfanity:!0,linkify:!0,emotify:!0,iconUsername:!0})),l.isQuote&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-quote-left"}),r.a.createElement(oa,{time:o.time}),r.a.createElement("div",{className:"quote-info"},"".concat(o.senderName," in ").concat(o.meetingName,": ")),r.a.createElement("div",{className:"quote-content"},r.a.createElement(z,{text:o.content,settings:i.settings,players:c,filterProfanity:!0,linkify:!0,emotify:!0,iconUsername:!0})),r.a.createElement("i",{className:"fas fa-quote-right"}))))}function oa(e){var t=new Date(e.time),a=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");return r.a.createElement("div",{className:"time"},a,":",n,":",o)}function sa(e){var t,a=e.socket,o=e.meetings,s=e.selTab,c=e.players,l=e.options,u=e.agoraClient,m=e.localAudioTrack,d=e.muted,f=e.setMuted,p=e.deafened,h=e.setDeafened,g=Object(n.useState)(""),v=Object(i.a)(g,2),y=v[0],b=v[1],E=Object(n.useState)([]),w=Object(i.a)(E,2),O=w[0],k=w[1],N=Object(n.useState)("Say"),j=Object(i.a)(N,2),S=j[0],C=j[1],x=Object(n.useState)(0),I=Object(i.a)(x,2),L=I[0],A=I[1],M=Object(n.useState)(),R=Object(i.a)(M,2),P=R[0],F=R[1],D=Object(n.useState)(),B=Object(i.a)(D,2),U=B[0],_=B[1],W="",H=Object(T.a)(O);try{for(H.s();!(t=H.n()).done;){var $=t.value;if(S==$.id){W=$.placeholder||"";break}}}catch(Y){H.e(Y)}finally{H.f()}return Object(n.useEffect)((function(){if(!s)return r.a.createElement(r.a.Fragment,null);var e,t=o[s].speechAbilities,a=[{label:"Say",id:"Say",placeholder:"to everyone"}],n=Object(T.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a.push("divider");var l,u=Object(T.a)(i.targets);try{for(u.s();!(l=u.n()).done;){var m=l.value,d=m;"player"==i.targetType&&(d=c[m].name),a.push({label:i.name,placeholder:"".concat(i.verb," ").concat(d),id:"".concat(i.name,":").concat(m)})}}catch(Y){u.e(Y)}finally{u.f()}}}catch(Y){n.e(Y)}finally{n.f()}k(a)}),[s]),Object(n.useEffect)((function(){L>0?(clearTimeout(U),_(setTimeout((function(){return A(0)}),1e3)),P!=s&&(F(s),null!=P&&a.send("typing",{meetingId:P,isTyping:!1}),a.send("typing",{meetingId:s,isTyping:!0}))):null!=P&&(F(null),a.send("typing",{meetingId:P,isTyping:!1}))}),[L]),r.a.createElement("div",{className:"speech-input-area"},r.a.createElement("div",{className:"speech-input-wrapper"},r.a.createElement(Q,{className:"speech-dropdown",options:O,onChange:function(e){C(e)},value:S}),r.a.createElement("input",{id:"speechInput",className:"speech-input",type:"text",autoComplete:"off",value:y,placeholder:W,maxLength:240,onChange:function(e){b(e.target.value),e.target.value.length>0&&("/"!=e.target.value[0]||"/me "==e.target.value.slice(0,4))&&!o[s].anonymous&&"Say"==S&&A(Date.now())},enterKeyHint:"done",onKeyDown:function(t){if("Enter"===t.key&&s&&y.length){var n=S.split(":"),r=n[0],o=n[1];"Say"==r&&(r=null),!function(e){for(var t in G)e=e.replace(t,G[t]);var a,n=Object(T.a)(V);try{for(n.s();!(a=n.n()).done;){if(a.value.test(e))return!0}}catch(Y){n.e(Y)}finally{n.f()}return!1}(y)?(a.send("speak",{content:y,meetingId:s,abilityName:r,abilityTarget:o}),e.setAutoScroll(!0)):a.send("slurDetected"),b("")}else if("Tab"===t.key){var i=function(){t.preventDefault();var e=y.split(" "),a=e.pop(),n=a.match(/[^\w-]?([\w-]*)$/)[1].toLowerCase(),r=a.substring(0,a.length-n.length);if(!n.length)return{v:void 0};var o=Object.values(c).map((function(e){return e.name})),s=o.map((function(e){return e.toLowerCase().substring(0,n.length)})),i=[];for(var l in s)s[l]===n&&i.push(o[l]);i.length?(1===i.length?e.push(r+i[0]):function(){for(var t=1;i.every((function(e){return e[t]===i[0][t]}));)t+=1;e.push(r+i[0].substring(0,t))}(),b(e.join(" "))):a.toLowerCase()==="@everyone".substring(0,a.length)&&(e.push("@everyone"),b(e.join(" ")))}();if("object"===typeof i)return i.v}}})),l.voiceChat&&r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-microphone ".concat(d?"disabled":""),onClick:function(){if(m.current){var e=d?100:0;m.current.setVolume(e),f(!d)}}}),r.a.createElement("i",{className:"fas fa-headphones ".concat(p?"disabled":""),onClick:function(){if(u.current){var e=p?100:0;u.current.remoteUsers.forEach((function(t){t.audioTrack&&t.audioTrack.setVolume(e)})),h(!p)}}})))}function ca(e){var t=e.history,a=e.stateViewing,n=t.states[a]?t.states[a].name:"",o=-1!=e.stateViewing,s=e.stateViewing<t.currentState||-2==t.currentState&&e.stateViewing!=t.currentState;return r.a.createElement("div",{className:"state-nav"},r.a.createElement("i",{className:"hist-arrow fas fa-caret-left ".concat(o?"":"invisible"),onClick:function(){return e.updateStateViewing({type:"backward"})}}),r.a.createElement("div",{className:"state-name",onClick:function(){e.updateStateViewing({type:"current"})}},n.toUpperCase()),r.a.createElement("i",{className:"hist-arrow fas fa-caret-right ".concat(s?"":"invisible"),onClick:function(){return e.updateStateViewing({type:"forward"})}}))}function ia(e){return r.a.createElement("div",{className:"side-menu ".concat(e.scrollable?"scrollable":"")},r.a.createElement("div",{className:"side-menu-title"},e.title),r.a.createElement("div",{className:"side-menu-content"},e.content))}function la(e){var t=Object(n.useRef)(),a=Object(n.useContext)(N),o=Object(n.useContext)(j),s=o.toggleRolePrediction,c=e.playerId;return r.a.createElement("div",{className:"role-marker",onClick:function(){e.onClick&&e.onClick(),a.onClick("/setup/".concat(o.setup.id),"rolePrediction",t.current,"Mark Role as",(function(e){e.roles=JSON.parse(e.roles)[0],e.toggleRolePrediction=s(c)}))},ref:t},r.a.createElement("i",{className:"fas fa-user-edit"}))}function ua(e){var t=Object(n.useContext)(j),a=t.isolationEnabled,o=t.togglePlayerIsolation,s=t.isolatedPlayers,c=t.rolePredictions,i=e.history,l=e.players,u=e.activity,m=i.states[e.stateViewing],d=m&&m.selTab;return l.map((function(t){var n,i=a&&r.a.createElement("input",{type:"checkbox",checked:(n=t.id,s.has(n)),onChange:function(){return o(t.id)}}),l=c[t.id],f=l||m.roles[t.id],p=!1,h="black";return 0===document.documentElement.classList.length?p=!0:document.documentElement.classList.contains("light-mode")?h="black":document.documentElement.classList.contains("dark-mode")?h="white":p=!0,p&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(h="white"),r.a.createElement("div",{className:"player ".concat(e.className?e.className:""),key:t.id},i,-1!=e.stateViewing&&r.a.createElement(la,{playerId:t.id}),-1!=e.stateViewing&&r.a.createElement(Bt,{role:f,isRolePrediction:void 0!==l,gameType:e.gameType,showPopover:!0}),r.a.createElement(tt,{id:t.userId,name:t.name,avatar:t.avatar,color:t.nameColor,active:u.speaking[t.id],newTab:!0}),d&&u.typing[t.id]==d&&r.a.createElement(be.a,{className:"typing-icon ".concat(-1!=e.stateViewing?"has-role":""),type:"bubbles",color:h,width:"20",height:"20"}))}))}function ma(e){var t=e.history,a=t.states[e.stateViewing],n=Object.values(e.players).filter((function(e){return!a.dead[e.id]&&!e.left})),o=Object.values(e.players).filter((function(e){return a.dead[e.id]&&!e.left}));return r.a.createElement(ia,{title:"Players",scrollable:!0,content:r.a.createElement("div",{className:"player-list"},r.a.createElement(ua,{players:n,history:t,gameType:e.gameType,stateViewing:e.stateViewing,activity:e.activity}),o.length>0&&r.a.createElement("div",{className:"section-title"},r.a.createElement("i",{className:"fas fa-skull"}),"Graveyard"),r.a.createElement(ua,{players:o,history:t,gameType:e.gameType,stateViewing:e.stateViewing,activity:e.activity,className:"dead"}))})}function da(e){var t=Object.values(e.meetings).reduce((function(t,a){if(a.voting){var n;switch(a.inputType){case"player":case"boolean":case"role":case"alignment":case"custom":case"select":n=r.a.createElement(fa,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing});break;case"button":n=r.a.createElement(pa,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing});break;case"text":n=r.a.createElement(ha,{key:a.id,socket:e.socket,meeting:a,players:e.players,self:e.self,history:e.history,stateViewing:e.stateViewing})}t.push(n)}return t}),[]);return r.a.createElement(r.a.Fragment,null,t.length>0&&r.a.createElement(ia,{scrollable:!0,title:"Actions",content:r.a.createElement("div",{className:"action-list"},t)}))}function fa(e){var t=ga(e),a=Object(i.a)(t,6),n=a[0],o=(a[1],a[2],a[3],a[4]),s=a[5],c=X(),l=Object(i.a)(c,4),u=l[0],m=l[1],d=l[2],f=l[3],p=n.targets.map((function(t){var a=va(t,n,e.players);return r.a.createElement("div",{className:"target dropdown-menu-option",key:t,onClick:function(){return g(t)}},a)})),h=Object.values(n.members).map((function(t){var a=n.votes[t.id],o=e.players[t.id];return a=va(a,n,e.players),r.a.createElement("div",{className:"vote ".concat(n.multi?"multi":""),key:t.id},r.a.createElement("div",{className:"voter",onClick:function(){return g(t.id)}},o&&o.name||"Anonymous"),!t.canVote&&r.a.createElement("div",{className:"selection"},"does not vote"),t.canVote&&a.length>0&&r.a.createElement("div",{className:"italic"},"votes"),t.canVote&&r.a.createElement("div",{className:"selection"},a.join(", ")))}));function g(e){m(!1),s(e)}return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name dropdown-control ".concat(o?"not-clickable":""),ref:d,onClick:function(){o||m(!u)}},n.actionName,r.a.createElement("i",{className:"fas fa-angle-down dropdown-arrow"})),u&&r.a.createElement("div",{className:"targets dropdown-menu",ref:f},p),r.a.createElement("div",{className:"votes"},h))}function pa(e){var t=ga(e),a=Object(i.a)(t,6),n=a[0],o=(a[1],a[2],a[3],a[4]),s=a[5];if(o)return null;var c=Object(h.a)({},n.votes);for(var l in c)c[l]=va(c[l],n,e.players);var u=n.targets.map((function(t){var a=va(t,n,e.players);return r.a.createElement("div",{className:"btn btn-theme ".concat(c[e.self]==a?"sel":""),key:t,disabled:c[e.self]&&!n.canUnvote,onClick:function(){return s(t)}},a)}));return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name"},n.actionName),u)}function ha(e){var t=e.meeting,a=e.self,o=t.textOptions||{},s=o.minLength||0,c=o.maxLength||100,l=Object(n.useState)(""),u=Object(i.a)(l,2),m=u[0],d=u[1];return r.a.createElement("div",{className:"action"},r.a.createElement("div",{className:"action-name"},t.actionName),r.a.createElement("textarea",{value:m,onChange:function(e){var t=e.target.value;t=t.replace(/\n/g," "),o.alphaOnly&&(t=t.replace(/[^a-z]/gi,"")),o.toLowerCase&&(t=t.toLowerCase()),t=t.substring(0,c),d(t)}}),r.a.createElement("div",{className:"btn btn-theme",onClick:function(n){m.length<s||(t.votes[a]=m,e.socket.send("vote",{meetingId:t.id,selection:m}))}},o.submit||"Submit"),t.votes[a])}function ga(e){var t=e.meeting,a=e.history,n=e.stateViewing,r=n==a.currentState,o=!r||!t.amMember||!t.canVote||t.instant&&t.votes[e.self];return[t,a,n,r,o,function(a){(Array.isArray(t.votes[e.self])?-1!=t.votes[e.self].indexOf(a):a==t.votes[e.self])?e.socket.send("unvote",{meetingId:t.id,selection:a}):e.socket.send("vote",{meetingId:t.id,selection:a})}]}function va(e,t,a){for(var n in e=!Array.isArray(e)&&e?[e]:e?Object(he.a)(e):[]){var r=e[n];switch(t.inputType){case"player":r="*"==r?"no one":r?a[r].name:"";break;case"boolean":"*"==r?r="No":r||(r="");default:"*"==r?r="None":r||(r="")}e[n]=r}return e}function ya(e){var t;t=-1==e.history.currentState?"pregameCountdown":-2==e.history.currentState?"postgame":e.timers.secondary?"secondary":e.timers.vegKick?"vegKick":"main";var a=e.timers[t];if(!a)return r.a.createElement("div",{className:"state-timer"});var n=a.delay-a.time;if(e.timers.secondary){var o=e.timers.main;if(o){var s=o.delay-o.time;n=Math.min(n,s)}}return n=function(e){e=e>0?Math.round(e/1e3):0;var t=String(Math.floor(e/60)).padStart(2,"0"),a=String(e%60).padStart(2,"0");return"".concat(t,":").concat(a)}(n),"vegKick"===t?r.a.createElement("div",{className:"state-timer"},"Kicking in ",n):r.a.createElement("div",{className:"state-timer"},n)}function ba(e){var t=Object(n.useState)(e.lastWill),a=Object(i.a)(t,2),o=a[0],s=a[1];return r.a.createElement(ia,{title:"Last Will",content:r.a.createElement("div",{className:"last-will-wrapper"},r.a.createElement("textarea",{className:"last-will-entry",value:o,onChange:function(t){var a=t.target.value.slice(0,100);s(a),e.socket.send("lastWill",a)}}))})}function Ea(e){var t=e.settings,a=e.updateSettings,n=e.showModal,o=e.setShowModal,s=_e([{label:"Voting Log",ref:"votingLog",type:"boolean",value:t.votingLog},{label:"Timestamps",ref:"timestamps",type:"boolean",value:t.timestamps},{label:"Sounds",ref:"sounds",type:"boolean",value:t.sounds},{label:"Volume",ref:"volume",type:"range",min:0,max:1,step:.1,value:t.volume}]),c=Object(i.a)(s,2),l=c[0],u=c[1],m=r.a.createElement(Be,{fields:l,onChange:u}),d=r.a.createElement("div",{className:"settings-control"},r.a.createElement("div",{className:"settings-save btn btn-theme",onClick:function(){var e,t={},n=Object(T.a)(l);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r.ref]=r.value}}catch(s){n.e(s)}finally{n.f()}a({type:"set",settings:t}),o(!1)}},"Save"),r.a.createElement("div",{className:"settings-cancel btn btn-theme-third",onClick:f},"Cancel"));function f(){var e,a=Object(T.a)(l);try{for(a.s();!(e=a.n()).done;){var n=e.value;u({ref:n.ref,prop:"value",value:t[n.ref]})}}catch(r){a.e(r)}finally{a.f()}o(!1)}return r.a.createElement(Ye,{className:"settings",show:n,header:"Settings",content:m,footer:d,onBgClick:f})}function wa(e){var t=e.showModal,a=e.setShowModal,n=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"paragraph"},"To keep games fun and competitive for all, please don't:"),r.a.createElement("div",{className:"paragraph"},r.a.createElement("div",null,"- Communicate with other players using anything which isn't part of the game."),r.a.createElement("div",null,"- Form alliances or other out-of-game arrangements with other users."),r.a.createElement("div",null,"- Attempt to play a game using more than one account."),r.a.createElement("div",null,'- Send screenshots or "prove" anything with images or video.'),r.a.createElement("div",null,"- Copy exactly any system messages you recieve (blue text)."),r.a.createElement("div",null,"- Try to lose the game on purpose."),r.a.createElement("div",null,"- Give up or leave partway through the game."),r.a.createElement("div",null,"- Issue out-of-game bribes or threats to sway other players, including threatening to leave.")),r.a.createElement("div",{className:"paragraph"},"Breaking game conduct may result in necessary action being taken against your account."),r.a.createElement("div",{className:"paragraph"},"A full description of these rules as well as site and community rules is found ",r.a.createElement("a",{href:"/community/forums/board/-2z5mOHaYp"},"here"),"."),r.a.createElement("div",{className:"paragraph"},"You can also find tutorials, tips, and strategy guides ",r.a.createElement("a",{href:"/community/forums/board/ht4TEuL6lG"},"here"),". Good luck, and have fun!")),o=r.a.createElement("div",{className:"btn btn-theme",onClick:s},"Close");function s(){a(!1)}return r.a.createElement(Ye,{className:"first-game",show:t,header:"Welcome to BeyondMafia",content:n,footer:o,onBgClick:s})}function Oa(e){var t=Object(n.useContext)(j),a=t.isolationEnabled,o=t.setIsolationEnabled,s=e.filters,c=e.setFilters;function i(e,t){c(p()(s,Object(g.a)({},e,{$set:t})))}return e.stateViewing<0?r.a.createElement(r.a.Fragment,null):r.a.createElement(ia,{title:"Speech Filters",content:r.a.createElement("div",{className:"speech-filters"},r.a.createElement("div",{style:{marginBottom:"10px"}},r.a.createElement("input",{id:"isolateMessagesCheckbox",type:"checkbox",value:a,onChange:function(){return o(!a)}}),r.a.createElement("label",{htmlFor:"isolateMessagesCheckbox"}," Isolate messages")),r.a.createElement("input",{type:"text",placeholder:"From user",value:s.from,onChange:function(e){return i("from",e.target.value)},style:{marginBottom:"10px"}}),r.a.createElement("input",{type:"text",placeholder:"Contains",value:s.contains,onChange:function(e){return i("contains",e.target.value)}}))})}function ka(e){var t=e.stateViewing,a=Object(n.useState)(""),o=Object(i.a)(a,2),s=o[0],c=o[1],l=Object(u.i)().gameId;return Object(n.useEffect)((function(){var e=window.localStorage.getItem("notesData");e&&((e=JSON.parse(e)).game!=l?window.localStorage.removeItem("notesData"):c(e.notes))}),[]),t<0?r.a.createElement(r.a.Fragment,null):r.a.createElement(ia,{title:"Notes",content:r.a.createElement("div",{className:"notes-wrapper"},r.a.createElement("textarea",{className:"notes-entry",value:s,onChange:function(e){return t=e.target.value,c(t),void window.localStorage.setItem("notesData",JSON.stringify({game:l,notes:t}));var t}}))})}function Na(){return(Na=Object(l.a)(Qt().mark((function e(){return Qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Notification){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Notification.requestPermission();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(466);function ja(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(""),l=Object(i.a)(c,2),u=l[0],m=l[1],f=Object(n.useContext)(O);Object(n.useEffect)((function(){document.title="Users | BeyondMafia"}),[]),Object(n.useEffect)((function(){u.length>0?d.a.get("/user/searchName?query=".concat(u)).then((function(e){s(e.data)})).catch(I):d.a.get("/user/online").then((function(e){s(e.data)})).catch(I)}),[u]);var p=o.map((function(e){return r.a.createElement("div",{className:"user-cell"},r.a.createElement(tt,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement(at,{status:e.status}))}));return r.a.createElement("div",{className:"user-search-page"},r.a.createElement("div",{className:"span-panel main"},r.a.createElement("div",{className:"form"},r.a.createElement("input",{type:"text",placeholder:"Username",value:u,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",{className:"users"},p)),r.a.createElement("div",{className:"user-lists"},r.a.createElement(Sa,null),f.perms.viewFlagged&&r.a.createElement(Ca,null)))}function Sa(e){var t=Object(n.useState)(1),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)([]),l=Object(i.a)(c,2),u=l[0],m=l[1],f=I();function p(e){var t=fe(e,o,u,"joined");null!=t&&d.a.get("/user/newest?".concat(t)).then((function(t){t.data.length>0&&(m(t.data),s(e))})).catch(f)}Object(n.useEffect)((function(){p(1)}),[]);var h=u.map((function(e){return r.a.createElement("div",{className:"user-row",key:e.id},r.a.createElement(tt,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"joined"},r.a.createElement($,{minSec:!0,millisec:Date.now()-e.joined,suffix:" ago"})))}));return r.a.createElement("div",{className:"newest-users box-panel"},r.a.createElement("div",{className:"heading"},"Newest Users"),r.a.createElement("div",{className:"users-list"},r.a.createElement(de,{page:o,onNav:p,inverted:!0}),h,r.a.createElement(de,{page:o,onNav:p,inverted:!0})))}function Ca(e){var t=Object(n.useState)(1),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)([]),l=Object(i.a)(c,2),u=l[0],m=l[1],f=I();function p(e){var t=fe(e,o,u,"joined");null!=t&&d.a.get("/user/flagged?".concat(t)).then((function(t){t.data.length>0&&(m(t.data),s(e))})).catch(f)}Object(n.useEffect)((function(){p(1)}),[]);var h=u.map((function(e){return r.a.createElement("div",{className:"user-row",key:e.id},r.a.createElement(tt,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement("div",{className:"joined"},r.a.createElement($,{minSec:!0,millisec:Date.now()-e.joined,suffix:" ago"})))}));return r.a.createElement("div",{className:"flagged-users box-panel"},r.a.createElement("div",{className:"heading"},"Flagged Users"),r.a.createElement("div",{className:"users-list"},r.a.createElement(de,{page:o,onNav:p,inverted:!0}),h,r.a.createElement(de,{page:o,onNav:p,inverted:!0})))}a(467);function xa(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(!1),c=Object(i.a)(s,2),l=c[0],u=c[1],m=Object(n.useContext)(O),f=I();Object(n.useEffect)((function(){document.title="Moderation | BeyondMafia",d.a.get("/mod/groups").then((function(e){o(e.data.sort((function(e,t){return t.rank-e.rank}))),u(!0)})).catch((function(e){u(!0),f(e)}))}),[]);var p=a.map((function(e){var t=e.members.map((function(e){return r.a.createElement("div",{className:"member user-cell",key:e.id},r.a.createElement(tt,{id:e.id,name:e.name,avatar:e.avatar}),r.a.createElement(at,{status:e.status}))}));return r.a.createElement("div",{className:"span-panel group-panel",key:e.name},r.a.createElement("div",{className:"title"},e.badge&&r.a.createElement(rt,{icon:e.badge,color:e.badgeColor||"black",name:e.name}),e.name+"s"),r.a.createElement("div",{className:"members"},t))}));return l?r.a.createElement("div",{className:"moderation"},r.a.createElement("div",{className:"main-section"},m.perms.viewModActions&&r.a.createElement("div",{className:"span-panel action-panel"},r.a.createElement("div",{className:"title"},"Do Action"),r.a.createElement(Ia,null)),p),r.a.createElement("div",{className:"side-column"},r.a.createElement(Ta,null))):r.a.createElement(Ee,null)}function Ia(){var e=Object(n.useState)(),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)({}),c=Object(i.a)(s,2),l=c[0],u=c[1],m=La(l,(function(){o(null),u({})})),d=Object(n.useContext)(O),f=I(),h=[],v=[];for(var y in m)d.perms[m[y].perm]&&!m[y].hidden&&h.push(y);function b(e,t,a){a&&(t=t.split(/ *, */)),u(p()(l,Object(g.a)({},e,{$set:t})))}return a&&(v=m[a].args.map((function(e){var t=e.label;return null!=e.default?t="".concat(t," (").concat(e.default,")"):e.optional&&(t="[".concat(t,"]")),"user_search"==e.type?r.a.createElement(He,{value:l[e.name]||"",setValue:function(t){return b(e.name,t,e.isArray)},placeholder:t,key:e.name}):r.a.createElement("input",{className:"arg",type:e.type,placeholder:t,maxLength:e.maxlength,onChange:function(t){return b(e.name,t.target.value,e.isArray)},key:e.name})}))),r.a.createElement("div",{className:"mod-commands"},r.a.createElement("div",{className:"inputs"},r.a.createElement(We,{options:h,value:a,setValue:o}),v),a&&r.a.createElement("div",{className:"btn btn-theme-sec submit",onClick:function(){var e,t=Object(T.a)(m[a].args);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(null==l[n.name])if(null!=n.default)l[n.name]=n.default;else if(!n.optional)return void f("Missing arguments.")}}catch(r){t.e(r)}finally{t.f()}m[a].run()}},"Run"))}function La(e,t){var a,r=Object(n.useContext)(k),o=I();return a={"Create Group":{perm:"createGroup",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Rank",name:"rank",type:"number",default:0},{label:"Badge",name:"badge",type:"text",optional:!0},{label:"Badge Color",name:"badgeColor",type:"text",optional:!0},{label:"Permissions",name:"permissions",type:"text",optional:!0,isArray:!0}],run:function(){d.a.post("/mod/group",e).then((function(){r.showAlert("Group created.","success"),t()})).catch(o)}},"Delete Group":{perm:"deleteGroup",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.post("/mod/group/delete",e).then((function(){r.showAlert("Group deleted.","success"),t()})).catch(o)}},"Create Forum Category":{perm:"createCategory",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Rank",name:"rank",type:"number",default:0},{label:"Position",name:"position",type:"number",default:0}],run:function(){d.a.post("/forums/category",e).then((function(){r.showAlert("Category created.","success"),t()})).catch(o)}},"Create Forum Board":{perm:"createBoard",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Category",name:"category",type:"text",maxlength:20},{label:"Description",name:"description",type:"text",maxlength:60},{label:"Icon",name:"icon",type:"text",optional:!0},{label:"Rank",name:"rank",type:"number",optional:!0},{label:"Position",name:"position",type:"number",optional:!0}],run:function(){d.a.post("/forums/board",e).then((function(){r.showAlert("Board created.","success"),t()})).catch(o)}},"Update Group Permissions":{perm:"updateGroupPerms",args:[{label:"Group Name",name:"groupName",type:"text",maxlength:20},{label:"Permissions to Add",name:"addPermissions",type:"text",optional:!0,isArray:!0},{label:"Permissions to Remove",name:"removePermissions",type:"text",optional:!0,isArray:!0}],run:function(){d.a.post("/mod/groupPerms",e).then((function(){r.showAlert("Group permissions updated.","success"),t()})).catch(o)}},"Add User to Group":{perm:"giveGroup",args:[{label:"User",name:"userId",type:"user_search"},{label:"Group Name",name:"groupName",type:"text",maxlength:20}],run:function(){d.a.post("/mod/addToGroup",e).then((function(){r.showAlert("User added to group.","success"),t()})).catch(o)}},"Remove User from Group":{perm:"removeFromGroup",args:[{label:"User",name:"userId",type:"user_search"},{label:"Group Name",name:"groupName",type:"text",maxlength:20}],run:function(){d.a.post("/mod/removeFromGroup",e).then((function(){r.showAlert("User removed from group.","success"),t()})).catch(o)}},"Get Group Permissions":{perm:"viewPerms",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.get("/mod/groupPerms?name=".concat(e.name)).then((function(e){alert(e.data.join(", "),"success"),t()})).catch(o)}},"Get User Permissions":{perm:"viewPerms",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/userPerms?userId=".concat(e.userId)).then((function(e){alert(e.data.join(", "),"success"),t()})).catch(o)}},"Delete Forum Board":{perm:"deleteBoard",args:[{label:"Name",name:"name",type:"text",maxlength:20}],run:function(){d.a.post("/forums/board/delete",e).then((function(){r.showAlert("Board deleted.","success"),t()})).catch(o)}},"Move Forum Thread":{perm:"moveThread",args:[{label:"Thread ID",name:"thread",type:"text"},{label:"Board Name",name:"board",type:"text"}],run:function(){d.a.post("/forums/thread/move",e).then((function(){r.showAlert("Thread moved.","success"),t()})).catch(o)}},"Create Chat Room":{perm:"createRoom",args:[{label:"Name",name:"name",type:"text",maxlength:20},{label:"Position",name:"position",type:"number",optional:!0},{label:"Rank",name:"rank",type:"number",optional:!0}],run:function(){d.a.post("/chat/room",e).then((function(){r.showAlert("Room created.","success"),t()})).catch(o)}},"Delete Chat Room":{perm:"deleteRoom",args:[{label:"Room Name",name:"name",type:"text"}],run:function(){d.a.post("/chat/room/delete",e).then((function(){r.showAlert("Room deleted.","success"),t()})).catch(o)}},"Forum Ban":{perm:"forumBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/forumBan",e).then((function(){r.showAlert("User forum banned.","success"),t()})).catch(o)}},"Chat Ban":{perm:"chatBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/chatBan",e).then((function(){r.showAlert("User chat banned.","success"),t()})).catch(o)}},"Game Ban":{perm:"gameBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/gameBan",e).then((function(){r.showAlert("User game banned.","success"),t()})).catch(o)}},"Ranked Ban":{perm:"rankedBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/rankedBan",e).then((function(){r.showAlert("User ranked banned.","success"),t()})).catch(o)}},"Site Ban":{perm:"siteBan",args:[{label:"User",name:"userId",type:"user_search"},{label:"Length",name:"length",type:"text"}],run:function(){d.a.post("/mod/siteBan",e).then((function(){r.showAlert("User site banned.","success"),t()})).catch(o)}},"Force Sign Out":{perm:"forceSignOut",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/logout",e).then((function(){r.showAlert("User logged out.","success"),t()})).catch(o)}},"Forum Unban":{perm:"forumUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/forumUnban",e).then((function(){r.showAlert("User forum unbanned.","success"),t()})).catch(o)}},"Chat Unban":{perm:"chatUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/chatUnban",e).then((function(){r.showAlert("User chat unbanned.","success"),t()})).catch(o)}},"Game Unban":{perm:"gameUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/gameUnban",e).then((function(){r.showAlert("User game unbanned.","success"),t()})).catch(o)}},"Ranked Unban":{perm:"rankedUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/rankedUnban",e).then((function(){r.showAlert("User ranked unbanned.","success"),t()})).catch(o)}},"Site Unban":{perm:"siteUnban",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/siteUnban",e).then((function(){r.showAlert("User site unbanned.","success"),t()})).catch(o)}},"Get Alt Accounts":{perm:"viewAlts",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/alts?userId=".concat(e.userId)).then((function(e){alert(e.data.map((function(e){return"".concat(e.name," (").concat(e.id,")")})).join(", ")),t()})).catch(o)}},"Get Bans":{perm:"viewBans",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/bans?userId=".concat(e.userId)).then((function(e){alert(e.data.map((function(e){return"Type: ".concat(e.type,", mod: ").concat(e.modId,", expires: ").concat(new Date(e.expires).toLocaleString())})).join("\n")),t()})).catch(o)}},"Check Flagged":{perm:"viewFlagged",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.get("/mod/flagged?userId=".concat(e.userId)).then((function(e){e.data?alert("Flagged!"):alert("Not flagged"),t()})).catch(o)}},"Clear Setup Name":{perm:"clearSetupName",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/mod/clearSetupName",e).then((function(){r.showAlert("Setup name cleared.","success"),t()})).catch(o)}},"Clear Bio":{perm:"clearBio",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearBio",e).then((function(){r.showAlert("Bio cleared.","success"),t()})).catch(o)}},"Clear Video":{perm:"clearBio",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearVideo",e).then((function(){r.showAlert("Video cleared.","success"),t()})).catch(o)}},"Clear Account Display":{perm:"clearAccountDisplay",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearAccountDisplay",e).then((function(){r.showAlert("Account display cleared.","success"),t()})).catch(o)}},"Clear Name":{perm:"clearName",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearName",e).then((function(){r.showAlert("Name cleared.","success"),t()})).catch(o)}},"Clear Avatar":{perm:"clearAvi",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearAvi",e).then((function(){r.showAlert("Avatar cleared.","success"),t()})).catch(o)}},"Clear All User Content":{perm:"clearAllUserContent",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/clearAllContent",e).then((function(){r.showAlert("User content cleared.","success"),t()})).catch(o)}},"Change Name":{perm:"changeName",args:[{label:"User",name:"userId",type:"user_search"},{label:"New Name",name:"name",type:"text"}],run:function(){d.a.post("/mod/changeName",e).then((function(){r.showAlert("Name changed.","success"),t()})).catch(o)}},"Give Coins":{perm:"giveCoins",args:[{label:"User",name:"userId",type:"user_search"},{label:"Amount",name:"amount",type:"number"}],run:function(){d.a.post("/mod/giveCoins",e).then((function(){r.showAlert("Coins given.","success"),t()})).catch(o)}},"Break Game":{perm:"breakGame",args:[{label:"Game Id",name:"gameId",type:"text"}],run:function(){d.a.post("/mod/breakGame",e).then((function(){r.showAlert("Game broken.","success"),t()})).catch(o)}},"Toggle Featured Setup":{perm:"featureSetup",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/setup/feature",e).then((function(){r.showAlert("Setup feature toggled.","success"),t()})).catch(o)}},"Clear All IPs":{perm:"clearAllIPs",args:[],run:function(){d.a.post("/mod/clearAllIPs",e).then((function(){r.showAlert("IPs cleared.","success"),t()})).catch(o)}},Whitelist:{perm:"whitelist",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/whitelist",e).then((function(){r.showAlert("User whitelisted.","success"),t()})).catch(o)}},Blacklist:{perm:"whitelist",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/blacklist",e).then((function(){r.showAlert("User blacklisted.","success"),t()})).catch(o)}},"Schedule Restart":{perm:"scheduleRestart",args:[{label:"When",name:"when",type:"text"}],run:function(){d.a.post("/mod/scheduleRestart",e).then((function(){r.showAlert("Restart scheduled.","success"),t()})).catch(o)}},"Kick Player":{perm:"kick",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/kick",e).then((function(){r.showAlert("Kicked player.","success"),t()})).catch(o)}},"Break Port Games":{perm:"breakPortGames",args:[{label:"Port",name:"port",type:"text"}],run:function(){d.a.post("/mod/breakPortGames",e).then((function(){r.showAlert("Games broken.","success"),t()})).catch(o)}},"Make Announcement":{perm:"announce",args:[{label:"Content",name:"content",type:"text"}],run:function(){d.a.post("/mod/announcement",e).then((function(){r.showAlert("Announcement created.","success"),t()})).catch(o)}},"Block Name":{perm:"blockName",args:[{label:"Name",name:"name",type:"text"}],run:function(){d.a.post("/mod/blockName",e).then((function(){r.showAlert("Name blocked.","success"),t()})).catch(o)}},"Toggle Ranked Setup":{perm:"approveRanked",args:[{label:"Setup Id",name:"setupId",type:"text"}],run:function(){d.a.post("/setup/ranked",e).then((function(){r.showAlert("Setup ranked status toggled.","success"),t()})).catch(o)}},"Ranked Approve":{perm:"approveRanked",args:[{label:"User",name:"userId",type:"user_search"}],run:function(){d.a.post("/mod/rankedApprove",e).then((function(){r.showAlert("User approved for ranked play.","success"),t()})).catch(o)}}},Object(g.a)(a,"Delete Forum Board",{hidden:!0,args:[{label:"Name"}]}),Object(g.a)(a,"Update Board Description",{hidden:!0,args:[{label:"Name"}]}),Object(g.a)(a,"Delete Forum Thread",{hidden:!0,args:[{label:"Thread ID"}]}),Object(g.a)(a,"Restore Forum Thread",{hidden:!0,args:[{label:"Thread ID"}]}),Object(g.a)(a,"Toggle Forum Thread Pin",{hidden:!0,args:[{label:"Thread ID"}]}),Object(g.a)(a,"Toggle Forum Thread Lock",{hidden:!0,args:[{label:"Thread ID"}]}),Object(g.a)(a,"Delete Forum Reply",{hidden:!0,args:[{label:"Reply ID"}]}),Object(g.a)(a,"Restore Forum Reply",{hidden:!0,args:[{label:"Reply ID"}]}),Object(g.a)(a,"Delete Comment",{hidden:!0,args:[{label:"Comment ID"}]}),Object(g.a)(a,"Restore Comment",{hidden:!0,args:[{label:"Comment ID"}]}),a}function Ta(e){var t=Object(n.useState)(1),a=Object(i.a)(t,2),o=a[0],s=a[1],l=Object(n.useState)([]),u=Object(i.a)(l,2),m=u[0],f=u[1],p=La({},(function(){})),h=I();function g(e){var t=fe(e,o,m,"date");null!=t&&d.a.get("/mod/actions?".concat(t)).then((function(t){t.data.length>0&&(f(t.data),s(e))})).catch(h)}Object(n.useEffect)((function(){g(1)}),[]);var v=m.map((function(e){var t=p[e.name],a=e.args.map((function(e,a){var n=t.args[a].label;return"User"==n&&(e=r.a.createElement(c.b,{to:"/user/".concat(e)},e)),r.a.createElement("div",{className:"action-arg",key:a},n,": ",e)}));return r.a.createElement("div",{className:"action",key:e.id},r.a.createElement("div",{className:"top-row"},r.a.createElement(tt,{id:e.mod.id,name:e.mod.name,avatar:e.mod.avatar}),r.a.createElement("div",{className:"date"},r.a.createElement($,{minSec:!0,millisec:Date.now()-e.date,suffix:" ago"}))),r.a.createElement("div",{className:"action-name"},e.name),r.a.createElement("div",{className:"action-args"},a))}));return r.a.createElement("div",{className:"box-panel"},r.a.createElement("div",{className:"heading"},"Mod Actions"),r.a.createElement("div",{className:"actions-wrapper"},r.a.createElement(de,{page:o,onNav:g}),v,r.a.createElement(de,{page:o,onNav:g})))}function Aa(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(me,{links:[{text:"Forums",path:"/community/forums"},{text:"Users",path:"/community/users"},{text:"Moderation",path:"/community/moderation"}]}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/community/forums",render:function(){return r.a.createElement(ut,null)}}),r.a.createElement(u.b,{path:"/community/users",render:function(){return r.a.createElement(ja,null)}}),r.a.createElement(u.b,{path:"/community/moderation",render:function(){return r.a.createElement(xa,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/community/forums"})}}))))}var Ma=a(174),Ra=a(24);function Pa(){Pa=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),c=new j(r||[]);return n(s,"_invoke",{value:w(e,a,c)}),s}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(S([])));v&&v!==t&&a.call(v,o)&&(h=v);var y=p.prototype=d.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function s(){return new t((function(r,s){!function n(r,o,s,c){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(m).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(i.arg)}(n,o,r,s)}))}return r=r?r.then(s,s):s()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return C()}for(a.method=r,a.arg=o;;){var s=a.delegate;if(s){var c=O(s,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(E.prototype),i(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var s=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),i(y,c,"Generator"),i(y,o,(function(){return this})),i(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return s.type="throw",s.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(c&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),N(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;N(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function Fa(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(""),u=Object(i.a)(s,2),m=u[0],f=u[1],p=Object(n.useState)(!0),h=Object(i.a)(p,2),g=h[0],v=h[1],y=Object(n.useState)(!1),b=Object(i.a)(y,2),E=b[0],w=b[1],O=Object(n.useState)(!1),N=Object(i.a)(O,2),j=N[0],S=N[1],C=Object(n.useContext)(k),x=I();function L(){return(L=Object(l.a)(Pa().mark((function e(t){var n,r,o;return Pa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!g){e.next=4;break}return e.abrupt("return");case 4:return w(!0),e.next=7,ce("auth");case 7:return n=Object(Ra.b)(),e.next=10,Object(Ra.f)(n,a,m);case 10:return r=e.sent,e.next=13,r.user.getIdToken(!0);case 13:o=e.sent,d.a.post("/auth",{idToken:o}).then((function(){window.location.reload()})).catch((function(e){x(e),w(!1);try{e.response&&403==e.response.status&&Object(Ra.d)(r.user)}catch(e){}})),e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(0),w(!1),e.t0&&e.t0.message){e.next=22;break}return e.abrupt("return");case 22:-1!=e.t0.message.indexOf("(auth/wrong-password)")?x("Incorrect password."):-1!=e.t0.message.indexOf("(auth/invalid-email)")?x("Invalid email."):-1!=e.t0.message.indexOf("(auth/user-not-found)")?x("Account does not exist."):-1!=e.t0.message.indexOf("(auth/too-many-requests)")?x("Too many login attempts on this account. Please try again later."):x(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function T(e){return A.apply(this,arguments)}function A(){return(A=Object(l.a)(Pa().mark((function e(t){var n;return Pa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),S(!1),w(!0),n=Object(Ra.b)(),e.next=7,Object(Ra.e)(n,a);case 7:C.showAlert("Password reset email sent.","success"),w(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),x("Error resetting password."),w(!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}Object(n.useEffect)((function(){document.title="Log In | BeyondMafia"}),[]),Object(n.useEffect)((function(){v(0==a.length||0==m.length)}),[a,m]);var M=r.a.createElement("form",{className:"form",onSubmit:T},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return o(e.target.value)}}))),R=r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"reset btn btn-theme",onClick:T},"Reset"),r.a.createElement("div",{className:"cancel btn btn-theme-third",onClick:function(){return S(!1)}},"Cancel"));return E?r.a.createElement(Ee,null):r.a.createElement("div",{className:"span-panel main login"},r.a.createElement("form",{className:"form",onSubmit:function(e){return L.apply(this,arguments)}},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Password"),r.a.createElement("input",{type:"password",value:m,onChange:function(e){return f(e.target.value)}})),r.a.createElement("a",{className:"forgot-pw",href:"#",onClick:function(){return S(!0)}},"Forgot password?"),r.a.createElement("input",{className:"auth-btn ".concat(g?"disabled":""),type:"submit",value:"Log In"})),r.a.createElement("div",{className:"legal"},"By logging in you agree to follow our ",r.a.createElement(c.b,{to:"/legal/tos"},"Terms of Service "),"and accept our ",r.a.createElement(c.b,{to:"/legal/privacy"},"Privacy Policy"),"."),r.a.createElement(Ye,{className:"reset-pw",show:j,onBgClick:function(){return S(!1)},header:"Reset Password",content:M,footer:R}))}function Da(){Da=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),c=new j(r||[]);return n(s,"_invoke",{value:w(e,a,c)}),s}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(S([])));v&&v!==t&&a.call(v,o)&&(h=v);var y=p.prototype=d.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function s(){return new t((function(r,s){!function n(r,o,s,c){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(m).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(i.arg)}(n,o,r,s)}))}return r=r?r.then(s,s):s()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return C()}for(a.method=r,a.arg=o;;){var s=a.delegate;if(s){var c=O(s,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(E.prototype),i(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var s=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),i(y,c,"Generator"),i(y,o,(function(){return this})),i(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return s.type="throw",s.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(c&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),N(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;N(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function Ba(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(""),m=Object(i.a)(s,2),d=m[0],f=m[1],p=Object(n.useState)(""),h=Object(i.a)(p,2),g=h[0],v=h[1],y=Object(n.useState)(!0),b=Object(i.a)(y,2),E=b[0],w=b[1],O=Object(n.useState)(!1),N=Object(i.a)(O,2),j=N[0],S=N[1],C=Object(n.useState)(!1),x=Object(i.a)(C,2),L=x[0],T=x[1],A=Object(n.useContext)(k),M=I(),R=JSON.parse('["gmail.com", "yahoo.com", "hotmail.com", "aol.com", "msn.com", "yandex.ru", "live.com", "icloud.com", "outlook.com"]');function P(){return(P=Object(l.a)(Da().mark((function e(t){var n,r,o;return Da().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),!E){e.next=4;break}return e.abrupt("return");case 4:if(n=a.split("@")[1]||"",-1!=R.indexOf(n)){e.next=8;break}return M("Email domain must be one of the following: "+R.join(", ")),e.abrupt("return");case 8:return S(!0),e.next=11,ce("auth");case 11:return r=Object(Ra.b)(),e.next=14,Object(Ra.a)(r,a,d);case 14:return o=e.sent,e.next=17,Object(Ra.d)(o.user);case 17:A.showAlert("Account created. Please click the verification link in your email before logging in. Be sure to check your spam folder.","success",!0),T(!0),S(!1),e.next=28;break;case 22:if(e.prev=22,e.t0=e.catch(0),S(!1),e.t0&&e.t0.message){e.next=27;break}return e.abrupt("return");case 27:-1!=e.t0.message.indexOf("(auth/invalid-email)")?M("Invalid email."):-1!=e.t0.message.indexOf("(auth/weak-password)")?M("Password should be at least 6 characters."):-1!=e.t0.message.indexOf("(auth/email-already-in-use)")?M("Email already in use."):M(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,22]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){document.title="Sign Up | BeyondMafia"}),[]),Object(n.useEffect)((function(){w(0==a.length||0==d.length||d!=g)}),[a,d,g]),j?r.a.createElement(Ee,null):L?r.a.createElement(u.a,{to:"/auth/login"}):r.a.createElement("div",{className:"span-panel main login"},r.a.createElement("form",{className:"form",onSubmit:function(e){return P.apply(this,arguments)}},r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Email"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Password"),r.a.createElement("input",{type:"password",value:d,onChange:function(e){return f(e.target.value)}})),r.a.createElement("div",{className:"field-wrapper"},r.a.createElement("div",{className:"label"},"Confirm Password"),r.a.createElement("input",{type:"password",value:g,onChange:function(e){return v(e.target.value)}})),r.a.createElement("input",{className:"auth-btn ".concat(E?"disabled":""),type:"submit",value:"Sign Up"})),r.a.createElement("div",{className:"legal"},"By signing up you agree to follow our ",r.a.createElement(c.b,{to:"/legal/tos"},"Terms of Service "),"and accept our ",r.a.createElement(c.b,{to:"/legal/privacy"},"Privacy Policy"),", and that you are at least 13 years of age."))}a(468);function Va(){var e=Object(n.useContext)(O),t=Object(u.h)();return Object(n.useEffect)((function(){var e=new URLSearchParams(t.search);e.get("ref")&&window.localStorage.setItem("referrer",e.get("ref"));Object(Ma.a)({apiKey:"AIzaSyCcrtFaLCKPxUti-qN0B6qmldXI9RpTurM",authDomain:"beyondmafia-cc1c9.firebaseapp.com",projectId:"beyondmafia-cc1c9",storageBucket:"beyondmafia-cc1c9.appspot.com",messagingSenderId:"115670726001",appId:"1:115670726001:web:b5afaa96f398060172b2d0",measurementId:"G-R5X90DK70Y"}),Object(Ra.b)().setPersistence(Ra.c)}),[]),e.loaded?e.loggedIn?r.a.createElement(u.a,{to:"/play"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(me,{links:[{text:"Log In",path:"/auth/login",exact:!0},{text:"Sign Up",path:"/auth/signup",exact:!0}]}),r.a.createElement("div",{className:"auth inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/auth/login"},r.a.createElement(Fa,null)),r.a.createElement(u.b,{exact:!0,path:"/auth/signup"},r.a.createElement(Ba,null)),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/auth/login"})}})))):r.a.createElement(Ee,null)}function Ua(){return Object(n.useEffect)((function(){document.title="Privacy Policy | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"Privacy Policy of BeyondMafia"),r.a.createElement("p",null,"BeyondMafia operates the BeyondMafia.org website, which provides the SERVICE."),r.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service, the BeyondMafia website."),r.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),"   ",r.a.createElement("p",null,"The terms used in this Privacy Policy have the same meanings as in our Terms and Conditions, which is accessible at BeyondMafia.org, unless otherwise defined in this Privacy Policy. Our Privacy Policy was created with the help of the ",r.a.createElement("a",{href:"https://www.privacypolicytemplate.net"},"Privacy Policy Template")," and the ",r.a.createElement("a",{href:"https://www.disclaimer-template.net"},"Disclaimer Template"),"."),r.a.createElement("h2",null,"Information Collection and Use"),r.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your email address and usernames on other services. You may also voluntarily upload any of your own personal information you wish for your profile, including but not limited to photos and textual data."),r.a.createElement("h2",null,"Log Data"),r.a.createElement("p",null,'We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol ("IP") address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics.'),r.a.createElement("h2",null,"Cookies"),r.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),r.a.createElement("p",null,'Our website uses these "cookies" to collection information and to improve our Service. You have the option to either accept or refuse these cookies by either loggin in or choosing not to log in. If you choose to refuse our cookies, you may not be able to use some portions of our Service, which includes any features that require a user to be signed in.'),r.a.createElement("h2",null,"Service Providers"),r.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),r.a.createElement("ul",null,r.a.createElement("li",null,"To facilitate our Service;"),r.a.createElement("li",null,"To provide the Service on our behalf;"),r.a.createElement("li",null,"To perform Service-related services; or"),r.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),r.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),r.a.createElement("h2",null,"Security"),r.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),r.a.createElement("h2",null,"Links to Other Sites"),r.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),r.a.createElement("p",null,"Children\u2019s Privacy"),r.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),r.a.createElement("h2",null,"Changes to This Privacy Policy"),r.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),r.a.createElement("h2",null,"Contact Us"),r.a.createElement("p",null,"If you have any questions or suggestions about our Privacy Policy, do not hesitate to contact us."))}function Ga(){return Object(n.useEffect)((function(){document.title="Terms of Service | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"BeyondMafia Terms and Conditions of Use"),r.a.createElement("h2",null,"1. Terms"),r.a.createElement("p",null,"By accessing this Website, accessible from BeyondMafia.org, you are agreeing to be bound by these Website Terms and Conditions of Use and agree that you are responsible for the agreement with any applicable local laws. If you disagree with any of these terms, you are prohibited from accessing this site. The materials contained in this Website are protected by copyright and trade mark law. These Terms of Service has been created with the help of the ",r.a.createElement("a",{href:"https://www.termsofservicegenerator.net"},"Terms of Service Generator")," and the ",r.a.createElement("a",{href:"https://www.termsconditionsexample.com"},"Terms & Conditions Example"),"."),r.a.createElement("h2",null,"2. Use License"),r.a.createElement("p",null,"Permission is granted to temporarily download one copy of the materials on BeyondMafia's Website for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:"),r.a.createElement("ul",null,r.a.createElement("li",null,"modify or copy the materials;"),r.a.createElement("li",null,"use the materials for any commercial purpose or for any public display;"),r.a.createElement("li",null,"attempt to reverse engineer any software contained on BeyondMafia's Website;"),r.a.createElement("li",null,"remove any copyright or other proprietary notations from the materials; or"),r.a.createElement("li",null,'transferring the materials to another person or "mirror" the materials on any other server.')),r.a.createElement("p",null,"This will let BeyondMafia to terminate upon violations of any of these restrictions. Upon termination, your viewing right will also be terminated and you should destroy any downloaded materials in your possession whether it is printed or electronic format."),r.a.createElement("h2",null,"3. Disclaimer"),r.a.createElement("p",null,'All the materials on BeyondMafia\u2019s Website are provided "as is". BeyondMafia makes no warranties, may it be expressed or implied, therefore negates all other warranties. Furthermore, BeyondMafia does not make any representations concerning the accuracy or reliability of the use of the materials on its Website or otherwise relating to such materials or any sites linked to this Website.'),r.a.createElement("h2",null,"4. Limitations"),r.a.createElement("p",null,"BeyondMafia or its suppliers will not be hold accountable for any damages that will arise with the use or inability to use the materials on BeyondMafia\u2019s Website, even if BeyondMafia or an authorize representative of this Website has been notified, orally or written, of the possibility of such damage. Some jurisdiction does not allow limitations on implied warranties or limitations of liability for incidental damages, these limitations may not apply to you."),r.a.createElement("h2",null,"5. Revisions and Errata"),r.a.createElement("p",null,"The materials appearing on BeyondMafia\u2019s Website may include technical, typographical, or photographic errors. BeyondMafia will not promise that any of the materials in this Website are accurate, complete, or current. BeyondMafia may change the materials contained on its Website at any time without notice. BeyondMafia does not make any commitment to update the materials."),r.a.createElement("h2",null,"6. Links"),r.a.createElement("p",null,"BeyondMafia has not reviewed all of the sites linked to its Website and is not responsible for the contents of any such linked site. The presence of any link does not imply endorsement by BeyondMafia of the site. The use of any linked website is at the user\u2019s own risk."),r.a.createElement("h2",null,"7. Site Terms of Use Modifications"),r.a.createElement("p",null,"BeyondMafia may revise these Terms of Use for its Website at any time without prior notice. By using this Website, you are agreeing to be bound by the current version of these Terms and Conditions of Use."),r.a.createElement("h2",null,"8. Your Privacy"),r.a.createElement("p",null,"Please read ",r.a.createElement("a",{href:"/legal/privacy"},"our Privacy Policy"),"."),r.a.createElement("h2",null,"9. Governing Law"),r.a.createElement("p",null,"Any claim related to BeyondMafia's Website shall be governed by the laws of us without regards to its conflict of law provisions."))}a(469);function _a(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(me,{links:[{text:"Terms of Service",path:"/legal/tos",exact:!0},{text:"Privacy Policy",path:"/legal/privacy",exact:!0}]}),r.a.createElement("div",{className:"inner-content"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/legal/tos",render:function(){return r.a.createElement(Ga,null)}}),r.a.createElement(u.b,{exact:!0,path:"/legal/privacy",render:function(){return r.a.createElement(Ua,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/legal/tos"})}}))))}a(470);function Wa(){var e=Object(n.useContext)(N),t=Object(n.useRef)(),a=Object(n.useRef)(),o=Object(n.useRef)();return J([{current:e.boundingEl},t],(function(){e.loadingRef.current||(e.setVisible(!1),e.setSideContentVisible(!1),e.setBoundingEl(null))})),Object(n.useLayoutEffect)((function(){if(e.visible){var n=e.boundingEl.getBoundingClientRect(),r=t.current.getBoundingClientRect(),s=n.left+n.width,c=n.top-10+n.height/2+window.scrollY,i=n.left+n.width+10,l=n.top-r.height/2+n.height/2+window.scrollY,u=window.innerWidth-(i+r.width);if(l<window.scrollY&&(l=window.scrollY),u<0?i+u<0&&(u-=i+u):u=0,i+=u,s+=u,a.current.style.left=s+"px",a.current.style.top=c+"px",a.current.style.visibility="visible",t.current.style.top=l+"px",t.current.style.left=i+"px",t.current.style.visibility="visible",e.sideContentVisible){o.current.style.width=r.width+"px";var m=r.x>window.innerWidth-(r.x+r.width)?r.x-r.width:r.x+r.width;o.current.style.top=e.sideContentMouseY+"px",o.current.style.left=m+"px",o.current.style.visibility="visible"}}})),e.visible&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"triangle triangle-left",ref:a}),r.a.createElement("div",{className:"popover-window",ref:t},r.a.createElement("div",{className:"popover-title"},e.title),!e.loading&&r.a.createElement("div",{className:"popover-content"},e.content)),e.sideContentVisible&&r.a.createElement("div",{className:"popover-window",ref:o},r.a.createElement("div",{className:"popover-title"},e.sideContentTitle),!e.sideContentLoading&&r.a.createElement("div",{className:"popover-content"},e.sideContent)))}function Ha(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)(),l=Object(i.a)(c,2),u=l[0],m=l[1],f=Object(n.useState)(""),p=Object(i.a)(f,2),h=p[0],g=p[1],v=Object(n.useState)(""),y=Object(i.a)(v,2),b=y[0],w=y[1],O=Object(n.useState)(!1),k=Object(i.a)(O,2),N=k[0],j=k[1],S=Object(n.useState)(""),C=Object(i.a)(S,2),x=C[0],L=C[1],A=Object(n.useState)(""),M=Object(i.a)(A,2),R=M[0],P=M[1],F=Object(n.useState)(""),D=Object(i.a)(F,2),B=D[0],V=D[1],U=Object(n.useState)(!1),G=Object(i.a)(U,2),_=G[0],W=G[1],H=Object(n.useState)(0),Y=Object(i.a)(H,2),z=Y[0],q=Y[1],K=Object(n.useRef)(),J=I(e);function Q(e,t,a){a?(P(t),W(!0),V(!0)):(m(e),g(t),V(!1),j(!0),s(!0),K.current=!0)}function X(t,a,n,o){switch(a){case"setup":t=function(e,t){var a=[];if(a.push(r.a.createElement($a,{title:"ID",content:e.id,key:"id"})),e.creator){var n=r.a.createElement(tt,{small:!0,id:e.creator.id,name:e.creator.name,avatar:e.creator.avatar});a.push(r.a.createElement($a,{title:"Created By",content:n,key:"createdBy"}))}a.push(r.a.createElement($a,{title:"Players",content:e.total,key:"players"})),a.push(r.a.createElement($a,{title:"Ranked Allowed",content:e.ranked?"Yes":"No",key:"ranked"}));var o=[];o.push(r.a.createElement("div",{key:"whispers"},e.whispers?"Yes":"No")),e.whispers&&o.push(r.a.createElement("div",{key:"whispersLeak"},e.leakPercentage,"% leak rate"));switch(a.push(r.a.createElement($a,{title:"Whispers",content:o,key:"whispers"})),a.push(r.a.createElement($a,{title:"Must Act",content:e.mustAct?"Yes":"No",key:"mustAct"})),e.gameType){case"Mafia":a.push(r.a.createElement($a,{title:"Starting State",content:r.a.createElement(Wt,{state:e.startState}),key:"startState"})),a.push(r.a.createElement($a,{title:"Dawn",content:e.dawn?"Yes":"No",key:"dawn"})),a.push(r.a.createElement($a,{title:"Last Will",content:e.lastWill?"Yes":"No",key:"lastWill"})),a.push(r.a.createElement($a,{title:"No Reveal",content:e.noReveal?"Yes":"No",key:"noReveal"})),a.push(r.a.createElement($a,{title:"Votes Invisible",content:e.votesInvisible?"Yes":"No",key:"votesInvis"}));break;case"Split Decision":a.push(r.a.createElement($a,{title:"Initial Swap Amount",content:e.swapAmt,key:"initSwapAmt"})),a.push(r.a.createElement($a,{title:"Round Amount",content:e.roundAmt,key:"roundAmt"}));break;case"Resistance":a.push(r.a.createElement($a,{title:"First Team Size",content:e.firstTeamSize,key:"firstTeamSize"})),a.push(r.a.createElement($a,{title:"Last Team Size",content:e.lastTeamSize,key:"lastTeamSize"})),a.push(r.a.createElement($a,{title:"Number of Missions",content:e.numMissions,key:"numMissions"})),a.push(r.a.createElement($a,{title:"Team Formation Attempts",content:e.teamFailLimit,key:"teamFailLimit"}));break;case"One Night":a.push(r.a.createElement($a,{title:"Votes Invisible",content:e.votesInvisible?"Yes":"No",key:"votesInvis"})),a.push(r.a.createElement($a,{title:"Excess Roles",content:e.excessRoles,key:"excessRoles"}))}if(e.closed){a.push(r.a.createElement($a,{title:"Unique Roles",content:e.unique?"Yes":"No",key:"uniqueRoles"}));var s=e.roles[0],c={};for(var i in s){var l,u=i.split(":")[0],m=Object(T.a)(t[e.gameType]);try{for(m.s();!(l=m.n()).done;){var d=l.value;if(d.name==u){var f=d.alignment;c[f]||(c[f]={}),c[f][i]=s[i]}}}catch(b){m.e(b)}finally{m.f()}}for(var p in c)a.push(r.a.createElement($a,{title:"".concat(p," roles"),content:r.a.createElement(Gt,{roles:c[p],gameType:e.gameType}),key:p}))}else{var h=[],g=e.roles.length>1?"Role Sets":"Roles";for(var v in e.roles){var y=e.roles[v];h.push(r.a.createElement(Gt,{roles:y,gameType:e.gameType,key:v}))}a.push(r.a.createElement($a,{title:g,content:h,key:"roles"}))}return a}(t,e.roles);break;case"rolePrediction":t=function(e){var t=Object.keys(e.roles);return t.unshift(void 0),r.a.createElement(Gt,{roles:t,makeRolePrediction:e.toggleRolePrediction,gameType:e.gameType})}(t);break;case"role":t=function(e){var t=[];t.push(r.a.createElement($a,{title:"Alignment",content:e.alignment,key:"alignment"}));var a=[];for(var n in e.description)a.push(r.a.createElement("li",{key:n},e.description[n]));return t.push(r.a.createElement($a,{title:"Description",content:r.a.createElement("ul",null,a),key:"desc"})),t}(t);break;case"game":t=function(e){var t=[];e.settings.scheduled&&t.push(r.a.createElement($a,{title:"Scheduled For",content:new Date(e.settings.scheduled).toLocaleString(),key:"scheduledFor"}));for(var a=[],n=0;n<e.players.length;n++)a.push(r.a.createElement(tt,{small:!0,id:e.players[n].id,name:e.players[n].name,avatar:e.players[n].avatar,key:e.players[n].id}));for(;a.length<e.totalPlayers;)a.push(r.a.createElement(tt,{small:!0,name:"[Guest]",key:a.length}));t.push(r.a.createElement($a,{title:"Players",content:a,key:"players"}));var o,s=[],c=Object(T.a)(E[e.type]);try{for(c.s();!(o=c.n()).done;){var i=o.value;s.push(r.a.createElement("div",{key:i},i,": ",r.a.createElement($,{millisec:e.settings.stateLengths[i]})))}}catch(u){c.e(u)}finally{c.f()}switch(t.push(r.a.createElement($a,{title:"State Lengths",content:s,key:"stateLengths"})),t.push(r.a.createElement($a,{title:"Ranked",content:e.settings.ranked?"Yes":"No",key:"ranked"})),t.push(r.a.createElement($a,{title:"Spectating",content:e.settings.spectating?"Yes":"No",key:"spectating"})),t.push(r.a.createElement($a,{title:"Guests Allowed",content:e.settings.guests?"Yes":"No",key:"guests"})),t.push(r.a.createElement($a,{title:"Ready Check",content:e.settings.readyCheck?"Yes":"No",key:"readyCheck"})),e.type){case"Mafia":var l=e.settings.gameTypeOptions.extendLength||3;t.push(r.a.createElement($a,{title:"Extension Length",content:r.a.createElement($,{millisec:60*l*1e3}),key:"extendLength"}))}e.createTime&&t.push(r.a.createElement($a,{title:"Created At",content:new Date(e.createTime).toLocaleString(),key:"createdAt"}));e.startTime&&t.push(r.a.createElement($a,{title:"Started At",content:new Date(e.startTime).toLocaleString(),key:"startedAt"}));e.endTime&&t.push(r.a.createElement($a,{title:"Ended At",content:new Date(e.endTime).toLocaleString(),key:"endedAt"}));return t}(t)}o?(L(t),P(n),W(!1)):(w(t),j(!1))}function Z(e,t,a,n,r,o){Q(a,n,o),d.a.get(e).then((function(e){r&&r(e.data),K.current=!1,X(e.data,t,n,o)})).catch(J)}return{visible:o,setVisible:s,boundingEl:u,setBoundingEl:m,title:h,setTitle:g,content:b,setContent:w,loading:N,setLoading:j,onClick:function(e,t,a,n,r){a==u?(s(!1),V(!1),m(null)):Z(e,t,a,n,r)},onHover:function(e,t,a,n,r,o){_||n===R||(q(o),Z(e,t,a,n,r,!0))},open:Q,ready:X,load:Z,loadingRef:K,sideContent:x,sideContentVisible:B,setSideContentVisible:V,sideContentTitle:R,sideContentLoading:_,sideContentMouseY:z}}function $a(e){return r.a.createElement("div",{className:"info-row"},r.a.createElement("div",{className:"title"},e.title),r.a.createElement("div",{className:"content"},e.content))}a(471);function Ya(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(0),c=Object(i.a)(s,2),l=c[0],u=c[1],m=Object(n.useState)(""),f=Object(i.a)(m,2),v=f[0],y=f[1],b=Object(n.useState)({}),E=Object(i.a)(b,2),w=E[0],k=E[1],N=Object(n.useReducer)((function(e,t){var a=e;switch(t.type){case"set":var n,r=t.chatInfo.notifs,o=0,s={rooms:0,directs:0},c={},i=Object(T.a)(r);try{for(i.s();!(n=i.n()).done;){var l=n.value;c[l.channelId]||(c[l.channelId]=0);var u=32==l.channelId.length?"directs":"rooms";o+=1,s[u]+=1,c[l.channelId]+=1}}catch(w){i.e(w)}finally{i.f()}a=Object(h.a)(Object(h.a)({},t.chatInfo),{},{notifs:e.notifs}),a=p()(a,{notifs:{all:{$set:o},byChannelType:{$set:s},byChannel:{$set:c}}});break;case"directs":a=p()(e,{directs:{$unshift:[t.channel]}});break;case"users":a=p()(e,{users:{$set:t.users}});break;case"remove":var m=e[t.channelType];m=m.filter((function(e){return e.id!=t.channelId})),a=p()(e,Object(g.a)({},t.channelType,{$set:m}));break;case"date":var d=e.directs.map((function(e){return e.id==t.channelId&&(e.lastMessageDate=t.date),e}));a=p()(e,{directs:{$set:d}});break;case"addNotif":var f=32==t.channelId.length?"directs":"rooms",v=e.notifs.all+1,y=e.notifs[f]?e.notifs[f]+1:1,b=e.notifs[t.channelId]?e.notifs[t.channelId]+1:1;a=p()(e,{notifs:{all:{$set:v},byChannelType:Object(g.a)({},f,{$set:y}),byChannel:Object(g.a)({},t.channelId,{$set:b})}});break;case"readNotifs":var E=e.notifs.byChannel[t.channelId]||0;f=32==t.channelId.length?"directs":"rooms",v=e.notifs.all-E,y=e.notifs.byChannelType[f]-E,a=p()(e,{notifs:{all:{$set:v},byChannelType:Object(g.a)({},f,{$set:y}),byChannel:Object(g.a)({},t.channelId,{$set:0})}})}return a}),{rooms:[],directs:[],users:[],notifs:{all:0,byChannelType:{},byChannel:{}}}),j=Object(i.a)(N,2),S=j[0],C=j[1],x=Object(n.useState)("rooms"),L=Object(i.a)(x,2),A=L[0],M=L[1],R=Object(n.useState)(),P=Object(i.a)(R,2),F=P[0],D=P[1],B=Object(n.useReducer)((function(e,t){var a=e;switch(t.type){case"set":a=t.channel;break;case"message":if(t.message.channel!=e.id)break;a=p()(e,{messages:{$push:[t.message]}});break;case"deleteMessage":var n=-1;for(var r in e.messages)if(e.messages[r].id==t.messageId){n=r;break}-1!=n&&(a=p()(e,{messages:{$splice:[[n,1]]}}));break;case"oldMessages":a=p()(e,{messages:{$unshift:t.messages}});break;case"clear":a={messages:[]}}return a}),{messages:[]}),V=Object(i.a)(B,2),U=V[0],G=V[1],_=Object(n.useState)({}),W=Object(i.a)(_,2),H=W[0],$=W[1],z=Object(n.useState)(""),q=Object(i.a)(z,2),K=q[0],J=q[1],Q=Object(n.useState)(!0),X=Object(i.a)(Q,2),Z=X[0],ee=X[1],te=Object(n.useState)(""),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],oe=Object(n.useRef)(),se=Object(n.useRef)(),ce=Object(n.useContext)(O),ie=I();function le(e){M(e),"users"==e&&w.send("getUsers",ne)}Object(n.useLayoutEffect)((function(){return function(){if(oe.current)if(null==se.current)se.current=oe.current.scrollHeight;else if(se.current!=oe.current.scrollHeight){if(0==oe.current.scrollTop){var e=oe.current.scrollHeight*(1-se.current/oe.current.scrollHeight);oe.current.scrollTop=e-5}se.current=oe.current.scrollHeight}Z&&oe.current&&(oe.current.scrollTop=oe.current.scrollHeight)}()})),Object(n.useEffect)((function(){!ce.loggedIn&&v&&y("")}),[ce.loggedIn]),Object(n.useEffect)((function(){if(v){var e;e="".concat("wss","://").concat("beyondmafia.com","/chatSocket");var t=new Jt(e);return t.on("connected",(function(){return u(l+1)})),t.on("disconnected",(function(){return u(l-1)})),k(t),function(){t&&t.clear()}}}),[v]),Object(n.useEffect)((function(){1==w.readyState?(w.send("auth",v),w.on("chatInfo",(function(e){if(C({type:"set",chatInfo:e}),e.rooms&&e.rooms.length>0&&!F){var t=e.rooms[0].id;D(t)}})),w.on("channel",(function(e){G({type:"set",channel:e})})),w.on("message",(function(e){G({type:"message",message:e})})),w.on("oldMessages",(function(e){G({type:"oldMessages",messages:e,messageListRef:oe})})),w.on("users",(function(e){C({type:"users",users:e})})),w.on("newDirectChannel",(function(e){C({type:"directs",channel:e.channel}),e.focus&&(M("directs"),D(e.channel.id),w.send("getChannel",e.channel.id))})),w.on("openDM",(function(e){M("directs"),D(e),w.send("getChannel",e)})),w.on("dateUpdate",(function(e){C({type:"date",channelId:e.channel,date:e.date})})),w.on("newNotif",(function(e){C({type:"addNotif",channelId:e.notif.channelId}),document.hidden&&-1==document.title.indexOf("\ud83d\udd34")&&(document.title=document.title+"\ud83d\udd34")})),w.on("messageDeleted",(function(e){G({type:"deleteMessage",messageId:e})})),w.on("error",(function(e){ie(e)}))):null!=w.readyState&&3!=w.readyState||d.a.get("/chat/connect").then((function(e){y(e.data)})).catch(ie)}),[l]),Object(n.useEffect)((function(){U.id&&(S.notifs.byChannel[U.id]&&w.send("readNotifsInChannel",U.id),C({type:"readNotifs",channelId:U.id}))}),[U]);var ue=S[A];"directs"==A&&(ue=ue.sort(Ka)),ue=ue.reduce((function(e,t){if("users"==A&&t.id==ce.id)return e;var a="channel";return("users"!=A&&t.id==F||"users"==A&&H[t.id])&&(a+=" sel"),e.push(r.a.createElement(Y,{className:a,key:t.id,notifCount:S.notifs.byChannel[t.id],onClick:function(){return e=t.id,void("users"!=A?(w.send("getChannel",e),D(e),ee(!0)):H[e]?$(p()(H,{$unset:[e]})):$(p()(H,Object(g.a)({},e,{$set:!0}))));var e}},r.a.createElement(qa,{short:!0,channelType:A,channel:t,user:ce}))),e}),[]);var me=U.messages.map((function(e){return r.a.createElement(za,{message:e,socket:w,key:e.id})}));return v&&r.a.createElement(Y,{className:"chat-wrapper",notifCount:S.notifs.all},r.a.createElement("div",{className:"top-bar",onClick:function(){o(!a),ee(!0),a?w.send("closedChat"):(F&&w.send("getChannel",F),F&&(S.notifs.byChannel[F]&&w.send("readNotifsInChannel",F),C({type:"readNotifs",channelId:F})))}},r.a.createElement("i",{className:"fas fa-comment"}),r.a.createElement("div",{className:"label"},"Chat")),a&&r.a.createElement("div",{className:"window"},r.a.createElement("div",{className:"left-panel"},r.a.createElement("div",{className:"channel-type-nav"},r.a.createElement(Y,{className:"channel-type ".concat("rooms"==A?"sel":""),notifCount:S.notifs.byChannelType.rooms,onClick:function(){return le("rooms")}},"Rooms"),r.a.createElement(Y,{className:"channel-type ".concat("directs"==A?"sel":""),notifCount:S.notifs.byChannelType.directs,onClick:function(){return le("directs")}},"Directs"),r.a.createElement("div",{className:"channel-type ".concat("users"==A?"sel":""),onClick:function(){return le("users")}},"Users")),"users"==A&&r.a.createElement("input",{className:"user-search",value:ne,placeholder:"Search",onChange:function(e){var t=e.target.value;re(t),w.send("getUsers",t)}}),r.a.createElement("div",{className:"channel-list"},ue),"users"==A&&Object.keys(H).length>0&&r.a.createElement("div",{className:"create-dm-btn btn btn-theme",onClick:function(){var e=Object.keys(H);w.send("newDMChannel",e),$({})}},r.a.createElement("i",{className:"fas fa-plus"}),"Create DM (",Object.keys(H).length,")")),r.a.createElement("div",{className:"right-panel"},U.id&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"channel-top"},r.a.createElement("div",{className:"channel-name"},r.a.createElement(qa,{channelType:U.public?"rooms":"directs",channel:U,user:ce})),!U.public&&r.a.createElement("i",{className:"close-dm fas fa-times",onClick:function(){return e=U.id,w.send("closeDM",e),D(null),G({type:"clear"}),void C({type:"remove",channelType:A,channelId:e});var e}})),r.a.createElement("div",{className:"channel-messages",ref:oe,onScroll:function(){var e=oe.current;Math.round(e.scrollTop+e.clientHeight)>=Math.round(e.scrollHeight)?ee(!0):(ee(!1),0==e.scrollTop&&w.send("getOldMessages",U.messages[0].date))}},me),r.a.createElement("div",{className:"channel-input-wrapper"},r.a.createElement("input",{className:"channel-input",value:K,maxLength:240,onChange:function(e){return J(e.target.value)},onKeyPress:function(e){if("Enter"==e.key&&K.length){var t=e.target.value;w.send("sendMessage",t),J(""),ee(!0)}}}))))))}function za(e){var t=e.message,a=e.socket,o=Object(n.useState)(!1),s=Object(i.a)(o,2),c=s[0],l=s[1],u=Object(n.useState)({}),m=Object(i.a)(u,2),d=m[0],f=m[1],p=Object(n.useRef)(),h=Object(n.useRef)(),g=Object(n.useContext)(O),v=t.sender.id==g.id,y=Date.now()-t.date;return J(p,(function(){return l(!1)})),Object(n.useEffect)((function(){if(h.current){var e=p.current.getBoundingClientRect();h.current.style.top=d.y-e.top+"px",v?h.current.style.right=e.right-d.x+"px":h.current.style.left=d.x-e.left+"px",h.current.style.visibility="visible"}}),[d]),r.a.createElement("div",{className:"message ".concat(v?"self":"")},r.a.createElement("div",{className:"info"},!v&&r.a.createElement(tt,{small:!0,id:t.sender.id,name:t.sender.name,avatar:t.sender.avatar,color:t.sender.settings&&ne(t.sender.settings.nameColor),groups:t.sender.groups}),y>6e4&&r.a.createElement("div",{className:"timestamp"},r.a.createElement($,{millisec:y,suffix:" ago"}))),r.a.createElement("div",{className:"content",style:t.sender.settings&&t.sender.settings.textColor?{color:ne(t.sender.settings.textColor)}:{},onContextMenu:function(e){"contextmenu"==e.type&&(e.preventDefault(),l(!0),f({x:e.clientX,y:e.clientY}))},ref:p},r.a.createElement(z,{text:t.content,settings:g.settings,filterProfanity:!0,linkify:!0,emotify:!0})),c&&(g.id==t.sender.id||g.perms.deleteChatMessage)&&r.a.createElement("div",{className:"context",ref:h},r.a.createElement("div",{className:"item",onClick:function(){a.send("deleteMessage",t.id)}},"Delete")))}function qa(e){var t=e.channelType,a=e.channel,n=e.user,o=e.short;switch(t){case"rooms":return a.name;case"directs":if(o){var s=a.members.filter((function(e){return e.id!=n.id})).map((function(e){return e.name})),c=s.join(", ");return s.length>1&&c.length>20&&(c=c.slice(0,17)+"..."),c}return a.members.filter((function(e){return e.id!=n.id})).map((function(e){return r.a.createElement(tt,{small:!0,id:e.id,name:e.name,avatar:e.avatar,key:e.id})}));case"users":return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt,{small:!0,noLink:!0,id:a.id,name:a.name,avatar:a.avatar}),r.a.createElement(at,{status:a.status}))}}function Ka(e,t){return t.lastMessageDate-e.lastMessageDate}function Ja(){return Object(n.useEffect)((function(){document.title="Emotes | BeyondMafia"}),[]),r.a.createElement("div",{className:"span-panel main legal"},r.a.createElement("h1",null,"List of Emotes ",M(":doge:")),r.a.createElement("div",null,function(){var e=Object.keys(F);return r.a.createElement("ul",{className:"emote-list"},e.map((function(e){return r.a.createElement("li",{key:e},e," ",M(e))})))}()))}a(472);function Qa(){Qa=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,n=Object.defineProperty||function(e,t,a){e[t]=a.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function i(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(x){i=function(e,t,a){return e[t]=a}}function l(e,t,a,r){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),c=new j(r||[]);return n(s,"_invoke",{value:w(e,a,c)}),s}function u(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(x){return{type:"throw",arg:x}}}e.wrap=l;var m={};function d(){}function f(){}function p(){}var h={};i(h,o,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(S([])));v&&v!==t&&a.call(v,o)&&(h=v);var y=p.prototype=d.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;n(this,"_invoke",{value:function(n,o){function s(){return new t((function(r,s){!function n(r,o,s,c){var i=u(e[r],e,o);if("throw"!==i.type){var l=i.arg,m=l.value;return m&&"object"==typeof m&&a.call(m,"__await")?t.resolve(m.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(m).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(i.arg)}(n,o,r,s)}))}return r=r?r.then(s,s):s()}})}function w(e,t,a){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return C()}for(a.method=r,a.arg=o;;){var s=a.delegate;if(s){var c=O(s,a);if(c){if(c===m)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var i=u(e,t,a);if("normal"===i.type){if(n=a.done?"completed":"suspendedYield",i.arg===m)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(n="completed",a.method="throw",a.arg=i.arg)}}}function O(e,t){var a=t.method,n=e.iterator[a];if(void 0===n)return t.delegate=null,"throw"===a&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,n(y,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=i(p,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(E.prototype),i(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,n,r,o){void 0===o&&(o=Promise);var s=new E(l(t,a,n,r),o);return e.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),i(y,c,"Generator"),i(y,o,(function(){return this})),i(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return s.type="throw",s.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),i=a.call(o,"finallyLoc");if(c&&i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),N(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;N(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function Xa(e){var t=Object(n.useContext)(O);return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"nav-wrapper left"},r.a.createElement(ue,null,r.a.createElement(c.c,{to:"/play"},"Lobby"),r.a.createElement(c.c,{to:"/community"},"Community"))),r.a.createElement(c.b,{to:"/",className:"logo-wrapper"},r.a.createElement("div",{className:"logo"})),r.a.createElement("div",{className:"nav-wrapper right"},r.a.createElement(ue,null,r.a.createElement("a",{href:"https://beyondmafia.fandom.com",target:"_blank"},"Wiki"),!t.loggedIn&&r.a.createElement(c.c,{to:"/auth",className:"nav-link"},"Log In"),t.loggedIn&&r.a.createElement("div",{className:"user-wrapper"},r.a.createElement(Za,null),r.a.createElement(c.b,{to:"/user",className:"profile-link"},r.a.createElement(et,{id:t.id,name:t.name,hasImage:t.avatar}))))))}function Za(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useReducer)((function(e,t){var a;switch(t.type){case"add":var n=e.notifs.map((function(e){return e.id})),r=t.notifs.filter((function(e){return-1==n.indexOf(e.id)}));a=p()(e,{notifs:{$set:r.concat(e.notifs)},unread:{$set:e.unread+r.length}});break;case"viewed":a=p()(e,{unread:{$set:0}})}return a||e}),{notifs:[],unread:0}),l=Object(i.a)(s,2),m=l[0],f=l[1],h=Object(n.useState)(),g=Object(i.a)(h,2),v=g[0],y=g[1],b=Object(n.useContext)(k),E=Object(u.g)(),w=Object(n.useRef)(),O=Object(n.useRef)();function N(){d.a.get("/notifs").then((function(e){var t=e.data[0],a=e.data.slice(1);y(t),f({type:"add",notifs:a})})).catch((function(){}))}function j(){d.a.post("/notifs/viewed").then((function(){f({type:"viewed"})})).catch((function(){}))}J([w,O],(function(){return o(!1)})),Object(n.useEffect)((function(){N();var e=setInterval((function(){return N()}),1e4);return function(){return clearInterval(e)}}),[]),Object(n.useEffect)((function(){a&&j()}),[m.notifs]),Object(n.useEffect)((function(){if(v&&v>Date.now()){var e=Math.ceil((v-Date.now())/1e3/60);b.showAlert("The server will be restarting in ".concat(e," minutes."),"basic",!0)}}),[v]),Object(n.useLayoutEffect)((function(){if(a){var e=O.current.getBoundingClientRect(),t=e.left+e.width;t>window.innerWidth&&(O.current.style.left=window.innerWidth-t+"px"),O.current.style.visibility="visible"}}));var S=m.notifs.map((function(e){return r.a.createElement(c.b,{className:"notif",key:e.id,to:e.link,onClick:function(t){return function(e,t){t.link?window.location.pathname==t.link.split("?")[0]&&E.go(0):e.preventDefault()}(t,e)}},e.icon&&r.a.createElement("i",{className:"fas fa-".concat(e.icon)}),r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"time"},r.a.createElement($,{millisec:Date.now()-e.date,suffix:" ago"})),r.a.createElement("div",{className:"content"},e.content)))}));return r.a.createElement("div",{className:"notifs-wrapper"},r.a.createElement(Y,{lOffset:!0,notifCount:m.unread,onClick:function(){o(!a),!a&&m.unread>0&&j()},fwdRef:w},r.a.createElement("i",{className:"fas fa-bell"})),a&&r.a.createElement("div",{className:"notif-list",ref:O},S,0==S.length&&"No unread notifications"))}function en(){var e=(new Date).getYear()+1900;return r.a.createElement("div",{className:"footer"},r.a.createElement("div",{className:"footer-inner"},r.a.createElement("p",null,"\xa9 ",e," BeyondMafia")))}var tn=function(){var e,t,a=window.localStorage.getItem("cacheVal");a||(a=Date.now(),window.localStorage.setItem("cacheVal",a));var o=function(){var e=Object(n.useState)({loggedIn:!1,loaded:!1,perms:{},rank:0,blockedUsers:[],settings:{},itemsOwned:{}}),t=Object(i.a)(e,2),a=t[0],r=t[1];return Object(h.a)(Object(h.a)({},a),{},{state:a,set:r,blockUserToggle:function(e){var t=a.blockedUsers.indexOf(e);r(-1==t?p()(a,{blockedUsers:{$push:[e]}}):p()(a,{blockedUsers:{$splice:[[t,1]]}}))},updateSetting:function(e,t){r(p()(a,{settings:Object(g.a)({},e,{$set:t})}))},clear:function(){r({loggedIn:!1,loaded:!0,perms:{},rank:0,blockedUsers:[]})}})}(),s=S({alerts:[],cacheVal:a}),m=Ha(s),f=I(s);function v(e){d.a.post("/game/leave").then((function(){s.hideAlert(e)})).catch(f)}var y="";if(!1===(null===(e=o.settings)||void 0===e?void 0:e.siteColorScheme))y="light";else if(!0===(null===(t=o.settings)||void 0===t?void 0:t.siteColorScheme))y="dark";else{var b;y=(null===(b=o.settings)||void 0===b?void 0:b.siteColorScheme)||"auto"}return"light"===y?(document.documentElement.classList.contains("dark-mode")&&document.documentElement.classList.remove("dark-mode"),document.documentElement.classList.add("light-mode")):"dark"===y?(document.documentElement.classList.contains("light-mode")&&document.documentElement.classList.remove("light-mode"),document.documentElement.classList.add("dark-mode")):"auto"===y&&(document.documentElement.classList.contains("dark-mode")&&document.documentElement.classList.remove("dark-mode"),document.documentElement.classList.contains("light-mode")&&document.documentElement.classList.remove("light-mode")),Object(n.useEffect)((function(){function e(){return(e=Object(l.a)(Qa().mark((function e(){var t,a;return Qa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get("/user/info");case 3:return(t=e.sent).data.id?(le(!1),d.a.defaults.headers.common["x-csrf"]=t.data.csrf,d.a.post("/user/online"),t.data.loggedIn=!0,t.data.loaded=!0,t.data.rank=Number(t.data.rank),o.set(t.data),(a=window.localStorage.getItem("referrer"))&&(d.a.post("/user/referred",{referrer:a}),window.localStorage.removeItem("referrer"))):(o.clear(),le(!0)),0==t.data.nameChanged&&s.showAlert((function(){return r.a.createElement("div",null,"New account created, you can change your username once in your ",r.a.createElement(c.b,{to:"/user/settings"},"settings"),".")}),"basic",!0),t.data.inGame&&s.showAlert((function(e){return r.a.createElement("div",null,"Return to game ",r.a.createElement(c.b,{to:"/game/".concat(t.data.inGame)},t.data.inGame)," or ",r.a.createElement("a",{onClick:function(){return v(e)}},"leave"),".")}),"basic",!0),e.next=9,d.a.get("/roles/all");case 9:t=e.sent,s.update("roles",t.data),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),f(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}();var t=setInterval((function(){d.a.post("/user/online")}),3e4);return function(){clearInterval(t)}}),[]),r.a.createElement(O.Provider,{value:o},r.a.createElement(k.Provider,{value:s},r.a.createElement(N.Provider,{value:m},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/game"},r.a.createElement(Xt,null)),r.a.createElement(u.b,{path:"/"},r.a.createElement("div",{className:"site-wrapper"},r.a.createElement("div",{className:"main-container"},r.a.createElement(Xa,null),r.a.createElement("div",{className:"inner-container"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/play",render:function(){return r.a.createElement(Ft,null)}}),r.a.createElement(u.b,{path:"/community",render:function(){return r.a.createElement(Aa,null)}}),r.a.createElement(u.b,{path:"/auth",render:function(){return r.a.createElement(Va,null)}}),r.a.createElement(u.b,{path:"/user",render:function(){return r.a.createElement(Ze,null)}}),r.a.createElement(u.b,{path:"/legal",render:function(){return r.a.createElement(_a,null)}}),r.a.createElement(u.b,{path:"/emotes",render:function(){return r.a.createElement(Ja,null)}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/play"})}}))),r.a.createElement(en,null),r.a.createElement(C,null),r.a.createElement(Ya,null))))),r.a.createElement(Wa,null))))};s.a.render(r.a.createElement(c.a,null,r.a.createElement(tn,null)),document.getElementById("root"))},57:function(e,t,a){},73:function(e,t,a){}},[[177,1,2]]]);
//# sourceMappingURL=main.267218a4.chunk.js.map